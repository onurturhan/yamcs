"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[129],{2129:(ye,w,s)=>{s.r(w),s.d(w,{LinksModule:()=>ve});var B=s(7573),g=s(1083),F=s(7309),I=s(4375),H=s(9326),l=s(3075),r=s(8279),k=s(381),h=s(2134),t=s(5e3),q=s(4454),L=s(2313),C=s(8928),v=s(9140),N=s(3251);const R=function(){return{exact:!0}},D=function(n){return{c:n}};let P=(()=>{class n{constructor(e){this.yamcs=e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(k.C))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-links-page-tabs"]],decls:7,vars:10,consts:[["mat-tab-nav-bar",""],["mat-tab-link","","routerLink","/links","routerLinkActive","",3,"routerLinkActiveOptions","active","queryParams"],["rla","routerLinkActive"],["mat-tab-link","","routerLink","/links/log","routerLinkActive","",3,"active","queryParams"],["rlb","routerLinkActive"]],template:function(e,i){if(1&e&&(t.TgZ(0,"nav",0),t.TgZ(1,"a",1,2),t._uU(3," LINKS "),t.qZA(),t.TgZ(4,"a",3,4),t._uU(6," ACTION LOG "),t.qZA(),t.qZA()),2&e){const o=t.MAs(2),c=t.MAs(5);t.xp6(1),t.Q6J("routerLinkActiveOptions",t.DdM(5,R))("active",o.isActive)("queryParams",t.VKq(6,D,i.yamcs.context)),t.xp6(3),t.Q6J("active",c.isActive)("queryParams",t.VKq(8,D,i.yamcs.context))}},directives:[N.BU,g.yS,N.Nj,g.Od],styles:[".mat-tab-link[_ngcontent-%COMP%]{height:36px;min-width:0;font-size:13px}"],changeDetection:0}),n})();var $=s(141),_=s(9808),V=s(4071),J=s(119),j=s(5869);const W=["intervalSelect"];function K(n,a){if(1&n){const e=t.EpF();t.ynx(0),t._UZ(1,"app-date-time-input",16),t._UZ(2,"app-date-time-input",17),t.TgZ(3,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().applyCustomDates()}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.filterForm.invalid)}}function z(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().jumpToNow()}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function G(n,a){1&n&&(t.TgZ(0,"th",20),t._uU(1,"Time"),t.qZA())}function X(n,a){if(1&n&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.time))}}function tt(n,a){1&n&&(t.TgZ(0,"th",20),t._uU(1,"User"),t.qZA())}function et(n,a){if(1&n&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Oqu(e.user||"-")}}function nt(n,a){1&n&&(t.TgZ(0,"th",20),t._uU(1,"Action"),t.qZA())}function it(n,a){if(1&n&&(t.TgZ(0,"td",21),t._UZ(1,"span",22),t.ALo(2,"actionLogFormat"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,e.summary)||"-",t.oJD)}}function at(n,a){1&n&&t._UZ(0,"th",23)}function ot(n,a){1&n&&t._UZ(0,"td",21)}function st(n,a){1&n&&t._UZ(0,"tr",24)}function ct(n,a){1&n&&t._UZ(0,"tr",25)}let O=(()=>{class n{constructor(e,i,o,c,m){this.yamcs=e,this.messageService=i,this.router=o,this.route=c,this.filterForm=new l.cw({filter:new l.NI,interval:new l.NI("NO_LIMIT"),customStart:new l.NI(null),customStop:new l.NI(null)}),this.displayedColumns=["time","user","summary","actions"],this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.dataSource=new r.by,m.setTitle("Links"),this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(p=>{if("CUSTOM"===p){const u=new Date,d=this.validStart||u,A=this.validStop||u;this.filterForm.get("customStart").setValue(h.Y6(d)),this.filterForm.get("customStop").setValue(h.Y6(A))}else"NO_LIMIT"===p?(this.validStart=null,this.validStop=null,this.appliedInterval=p,this.loadData()):(this.validStop=new Date,this.validStart=(0,h.rV)(this.validStop,p),this.appliedInterval=p,this.loadData())})}initializeOptions(){const e=this.route.snapshot.queryParamMap;if(e.has("filter")&&(this.filter=e.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),e.has("interval"))if(this.appliedInterval=e.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const i=e.get("customStart");this.filterForm.get("customStart").setValue(i),this.validStart=h.ZU(i);const o=e.get("customStop");this.filterForm.get("customStop").setValue(o),this.validStop=h.ZU(o)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=(0,h.rV)(this.validStop,this.appliedInterval));else this.appliedInterval="NO_LIMIT",this.validStop=null,this.validStart=null}jumpToNow(){this.filterForm.get("interval").setValue("NO_LIMIT")}applyCustomDates(){this.validStart=h.ZU(this.filterForm.value.customStart),this.validStop=h.ZU(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const e={service:"LinksApi"};this.validStart&&(e.start=this.validStart.toISOString()),this.validStop&&(e.stop=this.validStop.toISOString()),this.filter&&(e.q=this.filter),this.yamcs.yamcsClient.getAuditRecords(this.yamcs.instance,e).then(i=>this.dataSource.data=i.records||[]).catch(i=>this.messageService.showError(i))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filter||null,interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(k.C),t.Y36(q.e),t.Y36(g.F0),t.Y36(g.gz),t.Y36(L.Dx))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(e,i){if(1&e&&t.Gf(W,5),2&e){let o;t.iGM(o=t.CRH())&&(i.intervalSelect=o.first)}},decls:26,vars:7,consts:[[1,"panel-content"],[2,"margin-top","16px",3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],[4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","summary"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],["mat-header-cell",""],["mat-cell",""],[3,"innerHTML"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,i){1&e&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar"),t._uU(2," Links "),t.qZA(),t.TgZ(3,"div",0),t._UZ(4,"app-links-page-tabs"),t.TgZ(5,"form",1),t.TgZ(6,"div",2),t._UZ(7,"app-select",3,4),t.YNc(9,K,5,1,"ng-container",5),t.YNc(10,z,3,0,"ng-container",5),t.qZA(),t.qZA(),t.TgZ(11,"table",6),t.ynx(12,7),t.YNc(13,G,2,0,"th",8),t.YNc(14,X,3,3,"td",9),t.BQk(),t.ynx(15,10),t.YNc(16,tt,2,0,"th",8),t.YNc(17,et,2,1,"td",9),t.BQk(),t.ynx(18,11),t.YNc(19,nt,2,0,"th",8),t.YNc(20,it,3,3,"td",9),t.BQk(),t.ynx(21,12),t.YNc(22,at,1,0,"th",13),t.YNc(23,ot,1,0,"td",9),t.BQk(),t.YNc(24,st,1,0,"tr",14),t.YNc(25,ct,1,0,"tr",15),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(5),t.Q6J("formGroup",i.filterForm),t.xp6(2),t.Q6J("options",i.intervalOptions),t.xp6(2),t.Q6J("ngIf","CUSTOM"===i.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==i.filterForm.value.interval),t.xp6(1),t.Q6J("dataSource",i.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns))},directives:[C.a,v.k,P,l._Y,l.JL,l.sg,$.P,l.JJ,l.u,_.O5,V.Y,r.BZ,r.w1,r.fO,r.ge,r.Dz,r.ev,r.as,r.XQ,r.nj,r.Gk],pipes:[J.i,j.N],encapsulation:2,changeDetection:0}),n})();var Z=s(1135),y=s(1731),f=s(8966),T=s(4834),Q=s(97);function lt(n,a){1&n&&(t.TgZ(0,"label"),t._uU(1," CLCW check timeout (milliseconds) "),t.TgZ(2,"app-help",13),t.TgZ(3,"p"),t._uU(4," Timeout associated to acknowledgment CLCWs. If a command frame is not acknowledged within this time, it will be retransmitted. "),t.qZA(),t.TgZ(5,"p"),t._uU(6," Other names: "),t.TgZ(7,"code"),t._uU(8,"T1_Initial"),t.qZA(),t._uU(9," \xa0\u2022\xa0 "),t.TgZ(10,"code"),t._uU(11,"Timer_Initial_Value"),t.qZA(),t._uU(12,". "),t.qZA(),t.qZA(),t._UZ(13,"input",14),t.qZA())}function rt(n,a){1&n&&(t.TgZ(0,"label"),t._uU(1," V(R) "),t.TgZ(2,"app-help",15),t.TgZ(3,"p"),t._uU(4," The N(S) frame sequence number expected to be seen by FARM-1 in the next Type-AD transfer frame. "),t.qZA(),t.TgZ(5,"p"),t._uU(6," Other name: "),t.TgZ(7,"code"),t._uU(8,"Receiver_Frame_Sequence_Number"),t.qZA(),t._uU(9,". "),t.qZA(),t.qZA(),t._UZ(10,"input",16),t.qZA())}function pt(n,a){if(1&n&&(t.ynx(0),t._UZ(1,"mat-divider",12),t.YNc(2,lt,14,0,"label",8),t.YNc(3,rt,11,0,"label",8),t.BQk()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf","WITH_CLCW_CHECK"==e.form.controls.type.value),t.xp6(1),t.Q6J("ngIf","SET_VR"==e.form.controls.type.value)}}const ut=n=>{const a=n.get("type").value,e=n.get("clcwCheckTimeout").value,i=n.get("vr").value;return"WITH_CLCW_CHECK"!=a||null!==e&&""!==e?"SET_VR"!=a||null!==i&&""!=i?null:{combined:"V(R) must be specified"}:{combined:"CLCW Check Timeout must be specified"}};let _t=(()=>{class n{constructor(e,i,o){this.dialogRef=e,this.data=o,this.form=i.group({type:["WITH_CLCW_CHECK",l.kI.required],clcwCheckTimeout:"3000",vr:null},{validators:[ut]})}sendRequest(){const e=this.form.value,i={type:e.type};"WITH_CLCW_CHECK"===i.type?i.clcwCheckInitializeTimeout=Number(e.clcwCheckTimeout):"SET_VR"===i.type&&(i.vR=Number(e.vr)),this.dialogRef.close(i)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f.so),t.Y36(l.qu),t.Y36(f.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-initiate-cop1-dialog"]],decls:26,vars:3,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","radio","formControlName","type","value","WITHOUT_CLCW_CHECK"],[2,"font-weight","normal"],["type","radio","formControlName","type","value","WITH_CLCW_CHECK"],["type","radio","formControlName","type","value","UNLOCK"],["type","radio","formControlName","type","value","SET_VR"],[4,"ngIf"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"],[2,"margin-top","1em","margin-bottom","1em"],["dialogTitle","CLCW Check Timeout"],["type","text","formControlName","clcwCheckTimeout"],["dialogTitle","V(R)"],["type","text","formControlName","vr"]],template:function(e,i){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Initiate COP-1 AD Service"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.TgZ(3,"form",2),t.TgZ(4,"label"),t._UZ(5,"input",3),t.TgZ(6,"span",4),t._uU(7,"Without CLCW check"),t.qZA(),t.qZA(),t.TgZ(8,"label"),t._UZ(9,"input",5),t.TgZ(10,"span",4),t._uU(11,"With CLCW check"),t.qZA(),t.qZA(),t.TgZ(12,"label"),t._UZ(13,"input",6),t.TgZ(14,"span",4),t._uU(15,"With Unlock"),t.qZA(),t.qZA(),t.TgZ(16,"label"),t._UZ(17,"input",7),t.TgZ(18,"span",4),t._uU(19,"With Set V(R)"),t.qZA(),t.qZA(),t.YNc(20,pt,4,2,"ng-container",8),t.qZA(),t.qZA(),t.TgZ(21,"mat-dialog-actions",9),t.TgZ(22,"button",10),t._uU(23,"CANCEL"),t.qZA(),t.TgZ(24,"button",11),t.NdJ("click",function(){return i.sendRequest()}),t._uU(25,"INITIATE"),t.qZA(),t.qZA()),2&e&&(t.xp6(3),t.Q6J("formGroup",i.form),t.xp6(17),t.Q6J("ngIf","WITH_CLCW_CHECK"==i.form.controls.type.value||"SET_VR"==i.form.controls.type.value),t.xp6(4),t.Q6J("disabled",!i.form.valid))},directives:[f.uh,f.xY,l._Y,l.JL,l.sg,l._,l.Fj,l.JJ,l.u,_.O5,T.d,Q.W,f.H8,f.ZT],encapsulation:2}),n})();var b=s(7423),Y=s(3874),mt=s(4004),x=s(2230),dt=s(5328),gt=s(7238);function ht(n,a){if(1&n&&(t._UZ(0,"app-led",4),t.ALo(1,"async")),2&n){const e=t.oxw();t.Q6J("matTooltip",e.link.status)("color",t.lcZ(1,3,e.okColor$))("fade",e.parentLink&&"OK"!==e.parentLink.status)}}function ft(n,a){if(1&n&&t._UZ(0,"app-led",5),2&n){const e=t.oxw();t.Q6J("matTooltip",e.link.status)("fade",e.parentLink&&"OK"!==e.parentLink.status)}}function kt(n,a){if(1&n&&t._UZ(0,"app-led",5),2&n){const e=t.oxw();t.Q6J("matTooltip",e.link.status)("fade",e.parentLink&&"OK"!==e.parentLink.status)}}function Zt(n,a){if(1&n&&t._UZ(0,"app-led",6),2&n){const e=t.oxw();t.Q6J("matTooltip",e.link.status)("fade",e.parentLink&&"OK"!==e.parentLink.status)}}let S=(()=>{class n{constructor(e){this.prevInCount=-1,this.prevOutCount=-1,this.active$=new Z.X(!1),this.okColor$=this.active$.pipe((0,mt.U)(i=>i?x.U3:x.fk)),this.activeExpiration=-1,this.syncSubscription=e.syncFast(()=>{(new Date).getTime()>=this.activeExpiration&&(this.active$.next(!1),this.activeExpiration=-1)})}ngOnChanges(){if("OK"===this.link.status){const i=-1!==this.prevOutCount&&this.prevOutCount<this.link.dataOutCount;(-1!==this.prevInCount&&this.prevInCount<this.link.dataInCount||i)&&(this.active$.next(!0),this.activeExpiration=(new Date).getTime()+2e3)}else this.active$.next(!1),this.activeExpiration=-1;this.prevInCount=this.link.dataInCount,this.prevOutCount=this.link.dataOutCount}ngOnDestroy(){this.syncSubscription&&this.syncSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(dt.j))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-link-status"]],inputs:{link:"link",parentLink:"parentLink"},features:[t.TTD],decls:5,vars:5,consts:[[3,"ngSwitch"],[3,"matTooltip","color","fade",4,"ngSwitchCase"],["color","red",3,"matTooltip","fade",4,"ngSwitchCase"],["color","#aaa",3,"matTooltip","fade",4,"ngSwitchCase"],[3,"matTooltip","color","fade"],["color","red",3,"matTooltip","fade"],["color","#aaa",3,"matTooltip","fade"]],template:function(e,i){1&e&&(t.ynx(0,0),t.YNc(1,ht,2,5,"app-led",1),t.YNc(2,ft,1,2,"app-led",2),t.YNc(3,kt,1,2,"app-led",2),t.YNc(4,Zt,1,2,"app-led",3),t.BQk()),2&e&&(t.Q6J("ngSwitch",i.link.status),t.xp6(1),t.Q6J("ngSwitchCase","OK"),t.xp6(1),t.Q6J("ngSwitchCase","UNAVAIL"),t.xp6(1),t.Q6J("ngSwitchCase","FAILED"),t.xp6(1),t.Q6J("ngSwitchCase","DISABLED"))},directives:[_.RF,_.n9,x.on,gt.gM],pipes:[_.Ov],styles:["[_nghost-%COMP%]{line-height:0;font-size:0}"],changeDetection:0}),n})();var xt=s(1711),At=s(1204);function Lt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().ngIf;return t.oxw().enableLink(o.name)}),t.TgZ(1,"mat-icon"),t._uU(2,"link"),t.qZA(),t._uU(3," ENABLE "),t.qZA()}if(2&n){const e=t.oxw().ngIf;t.Q6J("disabled",!e.disabled)}}function Ct(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().ngIf;return t.oxw().disableLink(o.name)}),t.TgZ(1,"mat-icon"),t._uU(2,"link_off"),t.qZA(),t._uU(3," DISABLE "),t.qZA()}if(2&n){const e=t.oxw().ngIf;t.Q6J("disabled",e.disabled)}}function vt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"app-text-action",17),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(4).ngIf;return t.oxw().openInitiateCop1Dialog(o.name)}),t._uU(1," INITIATE AD "),t.qZA()}}function yt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"app-text-action",18),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(4).ngIf;return t.oxw().resumeCop1(o.name)}),t._uU(1," RESUME AD "),t.qZA()}}function bt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"app-text-action",19),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(4).ngIf;return t.oxw().disableCop1(o.name)}),t._uU(1," TERMINATE AD "),t.qZA()}}function St(n,a){if(1&n&&(t.TgZ(0,"div",13),t.YNc(1,vt,2,0,"app-text-action",14),t.YNc(2,yt,2,0,"app-text-action",15),t.YNc(3,bt,2,0,"app-text-action",16),t.qZA()),2&n){const e=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",!e.cop1Active),t.xp6(1),t.Q6J("ngIf","SUSPENDED"===e.state),t.xp6(1),t.Q6J("ngIf",e.cop1Active)}}function Ut(n,a){1&n&&(t.ynx(0),t._uU(1,"AD (Sequence-controlled service)"),t.BQk())}function wt(n,a){1&n&&(t.ynx(0),t._uU(1,"BD (Expedited service)"),t.BQk())}function It(n,a){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw(2).ngIf;t.xp6(1),t.hij("of ",e.txLimit,"")}}function qt(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"div",8),t._UZ(2,"mat-divider"),t.qZA(),t.TgZ(3,"h4"),t._uU(4," COP-1 "),t.YNc(5,St,4,3,"div",9),t.qZA(),t.TgZ(6,"dl",10),t.TgZ(7,"dt"),t._uU(8," Service "),t.TgZ(9,"app-help"),t.TgZ(10,"p"),t._uU(11," COP-1 provides two service modes that determine how reliably frames are transmitted: "),t.qZA(),t.TgZ(12,"table",11),t.TgZ(13,"tr"),t.TgZ(14,"td",12),t._uU(15," AD (Sequence-controlled) "),t.qZA(),t.TgZ(16,"td"),t._uU(17,"Sends Type-AD and Type-BC Transfer Frames."),t.qZA(),t.qZA(),t.TgZ(18,"tr"),t.TgZ(19,"td",12),t._uU(20," BD (Expedited) "),t.qZA(),t.TgZ(21,"td"),t._uU(22,"Sends Type-BD Transfer Frames. There are no retransmissions."),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"dd"),t.YNc(24,Ut,2,0,"ng-container",0),t.YNc(25,wt,2,0,"ng-container",0),t.qZA(),t.qZA(),t.TgZ(26,"dl",10),t.TgZ(27,"dt"),t._uU(28,"Wait queue"),t.qZA(),t.TgZ(29,"dd"),t._uU(30),t.qZA(),t.TgZ(31,"dt"),t._uU(32,"Enqueue TCs with bypass"),t.qZA(),t.TgZ(33,"dd"),t._uU(34),t.ALo(35,"nvl"),t.qZA(),t.qZA(),t.TgZ(36,"dl",10),t.TgZ(37,"dt"),t._uU(38,"TX state"),t.qZA(),t.TgZ(39,"dd"),t._uU(40),t.qZA(),t.TgZ(41,"dt"),t._uU(42,"V(S)"),t.qZA(),t.TgZ(43,"dd"),t._uU(44),t.ALo(45,"nvl"),t.qZA(),t.TgZ(46,"dt"),t._uU(47,"Sent queue"),t.qZA(),t.TgZ(48,"dd"),t._uU(49),t.qZA(),t.TgZ(50,"dt"),t._uU(51,"Out queue"),t.qZA(),t.TgZ(52,"dd"),t._uU(53),t.qZA(),t.TgZ(54,"dt"),t._uU(55,"Last frame TX attempts"),t.qZA(),t.TgZ(56,"dd"),t._uU(57),t.ALo(58,"nvl"),t.YNc(59,It,2,1,"ng-container",0),t.qZA(),t.qZA(),t.TgZ(60,"dl",10),t.TgZ(61,"dt"),t._uU(62,"On TX timeout"),t.qZA(),t.TgZ(63,"dd"),t._uU(64),t.qZA(),t.TgZ(65,"dt"),t._uU(66,"Retransmission delay"),t.qZA(),t.TgZ(67,"dd"),t._uU(68),t.qZA(),t.qZA(),t.TgZ(69,"h4"),t._uU(70,"CLCW"),t.qZA(),t.TgZ(71,"dl",4),t.TgZ(72,"dt"),t._uU(73,"Received"),t.qZA(),t.TgZ(74,"dd"),t._uU(75),t.ALo(76,"datetime"),t.qZA(),t.TgZ(77,"dt"),t._uU(78,"Lockout"),t.qZA(),t.TgZ(79,"dd"),t._uU(80),t.ALo(81,"nvl"),t.qZA(),t.TgZ(82,"dt"),t._uU(83,"Wait"),t.qZA(),t.TgZ(84,"dd"),t._uU(85),t.ALo(86,"nvl"),t.qZA(),t.TgZ(87,"dt"),t._uU(88,"Retransmit"),t.qZA(),t.TgZ(89,"dd"),t._uU(90),t.ALo(91,"nvl"),t.qZA(),t.TgZ(92,"dt"),t._uU(93,"N(R)"),t.qZA(),t.TgZ(94,"dd"),t._uU(95),t.ALo(96,"nvl"),t.qZA(),t.qZA(),t.TgZ(97,"dl",10),t.TgZ(98,"dt"),t._uU(99,"NN(R)"),t.qZA(),t.TgZ(100,"dd"),t._uU(101),t.ALo(102,"nvl"),t.qZA(),t.qZA(),t.BQk()),2&n){const e=a.ngIf,i=t.oxw().ngIf,o=t.oxw(2);t.xp6(5),t.Q6J("ngIf",o.mayControlLinks()),t.xp6(19),t.Q6J("ngIf",e.cop1Active),t.xp6(1),t.Q6J("ngIf",!e.cop1Active),t.xp6(5),t.hij("",e.waitQueueNumTC||0," TCs"),t.xp6(4),t.hij(" ",t.xi3(35,20,!i.bdAbsolutePriority,"-")," "),t.xp6(6),t.Oqu(e.state||"-"),t.xp6(4),t.Oqu(t.xi3(45,23,e.vS,"-")),t.xp6(5),t.AsE("",e.sentQueueNumTC||0," frames (limit: ",i.windowWidth,")"),t.xp6(4),t.Oqu(e.outQueueNumTC||0),t.xp6(4),t.hij(" ",t.xi3(58,26,e.txCount,"-")," "),t.xp6(2),t.Q6J("ngIf",e.txCount),t.xp6(5),t.Oqu(i.timeoutType||"-"),t.xp6(4),t.hij("",i.t1," ms"),t.xp6(7),t.Oqu(t.lcZ(76,29,null==e.clcw?null:e.clcw.receptionTime)||"-"),t.xp6(5),t.hij(" ",t.xi3(81,31,null==e.clcw?null:e.clcw.lockout,"-")," "),t.xp6(5),t.hij(" ",t.xi3(86,34,null==e.clcw?null:e.clcw.wait,"-")," "),t.xp6(5),t.hij(" ",t.xi3(91,37,null==e.clcw?null:e.clcw.retransmit,"-")," "),t.xp6(5),t.Oqu(t.xi3(96,40,null==e.clcw?null:e.clcw.nR,"-")),t.xp6(6),t.Oqu(t.xi3(102,43,e.nnR,"-"))}}function Nt(n,a){if(1&n&&(t.ynx(0),t.YNc(1,qt,103,46,"ng-container",0),t.ALo(2,"async"),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,e.cop1Status$))}}const Dt=function(n){return{c:n}};function Pt(n,a){if(1&n&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar"),t.TgZ(2,"a",1),t.TgZ(3,"mat-icon"),t._uU(4,"arrow_back"),t.qZA(),t.qZA(),t._uU(5),t.YNc(6,Lt,4,1,"button",2),t.YNc(7,Ct,4,1,"button",2),t.qZA(),t.TgZ(8,"div",3),t.TgZ(9,"dl",4),t.TgZ(10,"dt"),t._uU(11,"Type"),t.qZA(),t.TgZ(12,"dd"),t._uU(13),t.qZA(),t.TgZ(14,"dt"),t._uU(15,"Status"),t.qZA(),t.TgZ(16,"dd",5),t._UZ(17,"app-link-status",6),t._uU(18),t.qZA(),t.TgZ(19,"dt"),t._uU(20,"In counter"),t.qZA(),t.TgZ(21,"dd"),t._uU(22),t.ALo(23,"number"),t.qZA(),t.TgZ(24,"dt"),t._uU(25,"Out counter"),t.qZA(),t.TgZ(26,"dd"),t._uU(27),t.ALo(28,"number"),t.qZA(),t.qZA(),t.YNc(29,Nt,3,3,"ng-container",0),t.ALo(30,"async"),t.qZA(),t.qZA()),2&n){const e=a.ngIf,i=t.oxw();t.xp6(2),t.Q6J("queryParams",t.VKq(16,Dt,i.yamcs.context)),t.xp6(3),t.hij(" Links / ",e.name," \xa0\xa0\xa0 "),t.xp6(1),t.Q6J("ngIf",i.mayControlLinks()),t.xp6(1),t.Q6J("ngIf",i.mayControlLinks()),t.xp6(6),t.Oqu(e.type),t.xp6(4),t.Q6J("link",e),t.xp6(1),t.hij("\xa0 ",e.status," "),t.xp6(4),t.Oqu(t.lcZ(23,10,e.dataInCount)),t.xp6(5),t.Oqu(t.lcZ(28,12,e.dataOutCount)),t.xp6(2),t.Q6J("ngIf",t.lcZ(30,14,i.cop1Config$))}}let E=(()=>{class n{constructor(e,i,o,c,m,p){this.title=e,this.yamcs=o,this.authService=c,this.messageService=m,this.dialog=p,this.link$=new Z.X(null),this.cop1Config$=new Z.X(null),this.cop1Status$=new Z.X(null),i.paramMap.subscribe(u=>{const d=u.get("link");this.changeLink(d)}),this.linkSubscription=this.yamcs.yamcsClient.createLinkSubscription({instance:this.yamcs.instance},u=>{const d=this.link$.value;d&&d.name===u.linkInfo.name&&this.link$.next(u.linkInfo)})}changeLink(e){this.cop1Subscription&&this.cop1Subscription.cancel(),this.cop1Status$.next(null),this.cop1Config$.next(null),this.yamcs.yamcsClient.getLink(this.yamcs.instance,e).then(i=>{this.link$.next(i),this.title.setTitle(e),-1!==i.type.indexOf("Cop1Tc")&&(this.yamcs.yamcsClient.getCop1Config(this.yamcs.instance,e).then(o=>{this.cop1Config$.next(o)}),this.cop1Subscription=this.yamcs.yamcsClient.createCop1Subscription({instance:i.instance,link:e},o=>{this.cop1Status$.next(o)}))})}openInitiateCop1Dialog(e){this.dialog.open(_t,{width:"400px"}).afterClosed().subscribe(o=>{o&&this.initiateCop1(e,o)})}initiateCop1(e,i){this.yamcs.yamcsClient.initiateCop1(this.yamcs.instance,e,i).catch(o=>{this.messageService.showError(o)})}disableCop1(e){this.yamcs.yamcsClient.disableCop1(this.yamcs.instance,e).catch(i=>{this.messageService.showError(i)})}resumeCop1(e){this.yamcs.yamcsClient.resumeCop1(this.yamcs.instance,e).catch(i=>{this.messageService.showError(i)})}mayControlLinks(){return this.authService.getUser().hasSystemPrivilege("ControlLinks")}enableLink(e){this.yamcs.yamcsClient.enableLink(this.yamcs.instance,e).catch(i=>{this.messageService.showError(i)})}disableLink(e){this.yamcs.yamcsClient.disableLink(this.yamcs.instance,e).catch(i=>{this.messageService.showError(i)})}resetCounters(e){this.yamcs.yamcsClient.resetLinkCounters(this.yamcs.instance,e).catch(i=>{this.messageService.showError(i)})}ngOnDestroy(){this.linkSubscription&&this.linkSubscription.cancel(),this.cop1Subscription&&this.cop1Subscription.cancel()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(L.Dx),t.Y36(g.gz),t.Y36(k.C),t.Y36(y.e),t.Y36(q.e),t.Y36(f.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-icon-button","","routerLink","..","color","primary",3,"queryParams"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],[1,"form-content"],[1,"dl-horizontal",2,"margin-top","0"],[2,"display","flex","align-items","center"],[3,"link"],["mat-button","","color","primary",3,"disabled","click"],[1,"section-divider"],["style","float: right",4,"ngIf"],[1,"dl-horizontal"],[1,"ya-data-table"],["width","1",2,"white-space","nowrap"],[2,"float","right"],["icon","adjust",3,"click",4,"ngIf"],["icon","redo",3,"click",4,"ngIf"],["icon","not_interested",3,"click",4,"ngIf"],["icon","adjust",3,"click"],["icon","redo",3,"click"],["icon","not_interested",3,"click"]],template:function(e,i){1&e&&(t.YNc(0,Pt,31,18,"app-instance-page",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,i.link$))},directives:[_.O5,C.a,v.k,b.zs,g.yS,Y.Hw,b.lW,S,T.d,xt.l,Q.W],pipes:[_.Ov,_.JJ,At.m,J.i],encapsulation:2,changeDetection:0}),n})();var Jt=s(449),Ot=s(3284),Qt=s(3156);function Yt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).enableLink()}),t._uU(1," ENABLE LINK "),t.qZA()}}function Et(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).disableLink()}),t._uU(1," DISABLE LINK "),t.qZA()}}function Mt(n,a){if(1&n&&(t.TgZ(0,"div",4),t.YNc(1,Yt,2,0,"button",5),t.YNc(2,Et,2,0,"button",5),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf","DISABLED"===e.link.status),t.xp6(1),t.Q6J("ngIf","DISABLED"!==e.link.status)}}let Bt=(()=>{class n{constructor(e,i){this.authService=e,this.yamcs=i}mayControlLinks(){return this.authService.getUser().hasSystemPrivilege("ControlLinks")}enableLink(){this.yamcs.yamcsClient.enableLink(this.link.instance,this.link.name)}disableLink(){this.yamcs.yamcsClient.disableLink(this.link.instance,this.link.name)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(y.e),t.Y36(k.C))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-link-detail"]],inputs:{link:"link"},decls:26,vars:11,consts:[[1,"block-title"],[1,"block"],[3,"link"],["class","action-bar",4,"ngIf"],[1,"action-bar"],["class","ya-button",3,"click",4,"ngIf"],[1,"ya-button",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t._uU(1,"Name"),t.qZA(),t.TgZ(2,"div",1),t._uU(3),t.qZA(),t.TgZ(4,"div",0),t._uU(5,"Class"),t.qZA(),t.TgZ(6,"div",1),t._uU(7),t.qZA(),t._UZ(8,"br"),t._UZ(9,"mat-divider"),t.TgZ(10,"div",0),t._uU(11,"Status"),t.qZA(),t.TgZ(12,"div",1),t._UZ(13,"app-link-status",2),t._uU(14),t.qZA(),t.TgZ(15,"div",0),t._uU(16,"In Count"),t.qZA(),t.TgZ(17,"div",1),t._uU(18),t.ALo(19,"number"),t.qZA(),t.TgZ(20,"div",0),t._uU(21,"Out Count"),t.qZA(),t.TgZ(22,"div",1),t._uU(23),t.ALo(24,"number"),t.qZA(),t.YNc(25,Mt,3,2,"div",3)),2&e&&(t.xp6(3),t.hij(" ",i.link.name,"\n"),t.xp6(4),t.hij(" ",i.link.type,"\n"),t.xp6(6),t.Q6J("link",i.link),t.xp6(1),t.hij(" ",i.link.status,"\n"),t.xp6(4),t.hij(" ",t.lcZ(19,7,i.link.dataInCount),"\n"),t.xp6(5),t.hij(" ",t.lcZ(24,9,i.link.dataOutCount),"\n"),t.xp6(2),t.Q6J("ngIf",i.mayControlLinks()))},directives:[T.d,S,_.O5],pipes:[_.JJ],encapsulation:2,changeDetection:0}),n})();var Ft=s(9971),Ht=s(4574),U=s(7587),Rt=s(8726),$t=s(8493),Vt=s(2181);function jt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",36),t.NdJ("click",function(){return t.CHM(e),t.oxw().enableSelectedLinks()}),t.TgZ(1,"mat-icon"),t._uU(2,"link"),t.qZA(),t._uU(3," ENABLE "),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("disabled",!e.allowGroupEnable())}}function Wt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",36),t.NdJ("click",function(){return t.CHM(e),t.oxw().disableSelectedLinks()}),t.TgZ(1,"mat-icon"),t._uU(2,"link_off"),t.qZA(),t._uU(3," DISABLE "),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("disabled",!e.allowGroupDisable())}}function Kt(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"app-detail-toolbar"),t._uU(2," Link Detail "),t.qZA(),t.TgZ(3,"div",37),t._UZ(4,"app-link-detail",38),t.qZA(),t.BQk()),2&n){const e=a.ngIf;t.xp6(4),t.Q6J("link",e.link)}}function zt(n,a){if(1&n&&(t.TgZ(0,"div",37),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.selection.selected.length," links selected ")}}function Gt(n,a){if(1&n&&(t.TgZ(0,"app-detail-toolbar"),t._uU(1," Select a link "),t.qZA(),t.YNc(2,zt,2,1,"div",39)),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.selection.hasValue())}}function Xt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"th",40),t.TgZ(1,"input",41),t.NdJ("change",function(o){t.CHM(e);const c=t.oxw();return o?c.masterToggle():null}),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())}}function te(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"td",42),t.TgZ(1,"input",43),t.NdJ("click",function(o){return o.stopPropagation()})("change",function(o){const m=t.CHM(e).$implicit,p=t.oxw();return o?p.selection.toggle(m):null}),t.qZA(),t.qZA()}if(2&n){const e=a.$implicit,i=t.oxw();t.xp6(1),t.Q6J("checked",i.selection.isSelected(e))}}function ee(n,a){1&n&&(t.TgZ(0,"th",44),t._uU(1,"Name"),t.qZA())}function ne(n,a){if(1&n&&(t.TgZ(0,"div",50),t._UZ(1,"app-link-status",51),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("link",e.link)("parentLink",e.parentLink)}}function ie(n,a){1&n&&(t.TgZ(0,"mat-icon"),t._uU(1,"expand_less"),t.qZA())}function ae(n,a){1&n&&(t.TgZ(0,"mat-icon"),t._uU(1,"expand_more"),t.qZA())}function oe(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",52),t.NdJ("click",function(o){t.CHM(e);const c=t.oxw().$implicit;return t.oxw().expandItem(o,c)}),t.YNc(1,ie,2,0,"mat-icon",53),t.YNc(2,ae,2,0,"mat-icon",53),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.expanded),t.xp6(1),t.Q6J("ngIf",!e.expanded)}}const se=function(n){return["/links",n]},ce=function(n){return{c:n}};function le(n,a){if(1&n&&(t.TgZ(0,"td",45),t.YNc(1,ne,2,2,"div",46),t.TgZ(2,"a",47),t._UZ(3,"app-highlight",48),t.qZA(),t.YNc(4,oe,3,2,"button",49),t.qZA()),2&n){const e=a.$implicit,i=t.oxw();t.xp6(1),t.Q6J("ngIf",e.link.parentName),t.xp6(1),t.Q6J("routerLink",t.VKq(6,se,e.link.name))("queryParams",t.VKq(8,ce,i.yamcs.context)),t.xp6(1),t.Q6J("text",e.link.name)("term",i.filterControl.value),t.xp6(1),t.Q6J("ngIf",e.hasChildren)}}function re(n,a){1&n&&(t.TgZ(0,"th",44),t._uU(1,"Class"),t.qZA())}function pe(n,a){if(1&n&&(t.TgZ(0,"td",54),t._UZ(1,"app-highlight",48),t.qZA()),2&n){const e=a.$implicit,i=t.oxw();t.xp6(1),t.Q6J("text",e.link.type)("term",i.filterControl.value)}}function ue(n,a){1&n&&t._UZ(0,"th",55)}function _e(n,a){if(1&n&&t._UZ(0,"app-link-status",38),2&n){const e=t.oxw().$implicit;t.Q6J("link",e.link)}}function me(n,a){if(1&n&&(t.TgZ(0,"td",56),t.YNc(1,_e,1,1,"app-link-status",57),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Q6J("ngIf",!e.link.parentName)}}function de(n,a){1&n&&(t.TgZ(0,"th",58),t._uU(1,"In"),t.qZA())}function ge(n,a){if(1&n&&(t.TgZ(0,"td",59),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.link.dataInCount)," ")}}function he(n,a){1&n&&(t.TgZ(0,"th",58),t._uU(1,"Out"),t.qZA())}function fe(n,a){if(1&n&&(t.TgZ(0,"td",59),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.link.dataOutCount)," ")}}function ke(n,a){1&n&&t._UZ(0,"th",60)}function Ze(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"app-more"),t.TgZ(1,"button",61),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw().enableLink(o.link.name)}),t._uU(2," Enable link "),t.qZA(),t.TgZ(3,"button",61),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw().disableLink(o.link.name)}),t._uU(4," Disable link "),t.qZA(),t._UZ(5,"mat-divider"),t.TgZ(6,"button",62),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw().resetCounters(o.link.name)}),t._uU(7," Reset counters "),t.qZA(),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("disabled","DISABLED"!==e.link.status),t.xp6(2),t.Q6J("disabled","DISABLED"===e.link.status)}}function Te(n,a){if(1&n&&(t.TgZ(0,"td",54),t.YNc(1,Ze,8,2,"app-more",53),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.mayControlLinks())}}function xe(n,a){1&n&&t._UZ(0,"tr",63)}function Ae(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr",64),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().toggleOne(c)}),t.qZA()}if(2&n){const e=a.$implicit,i=t.oxw();t.ekj("selected",i.selection.isSelected(e))("disabled","DISABLED"===e.link.status)}}const Le=[{path:"",canActivate:[I.a,F.z],canActivateChild:[I.a],runGuardsAndResolvers:"always",component:H.K,children:[{path:"",pathMatch:"full",component:(()=>{class n{constructor(e,i,o,c,m,p){this.yamcs=e,this.authService=i,this.changeDetection=c,this.route=m,this.router=p,this.filterControl=new l.NI,this.detailLink$=new Z.X(null),this.columns=[{id:"select",label:"",alwaysVisible:!0},{id:"status",label:"",alwaysVisible:!0},{id:"name",label:"Name",alwaysVisible:!0},{id:"className",label:"Class Name"},{id:"in",label:"In Count",visible:!0},{id:"out",label:"Out Count",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],this.dataSource=new r.by,this.selection=new Jt.Ov(!0,[]),this.itemsByName={},this.tableTrackerFn=(u,d)=>d.link.name,o.setTitle("Links"),this.dataSource.filterPredicate=(u,d)=>u.link.name.toLowerCase().indexOf(d)>=0||u.link.type.toLowerCase().indexOf(d)>=0,this.selectionSubscription=this.selection.changed.subscribe(()=>{const u=this.selection.selected;this.detailLink$.next(1===u.length?u[0]:null)})}ngAfterViewInit(){const e=this.route.snapshot.queryParamMap;e.has("filter")&&(this.filterControl.setValue(e.get("filter")),this.dataSource.filter=e.get("filter").toLowerCase()),this.filterControl.valueChanges.subscribe(()=>{this.updateURL(),this.dataSource.filter=(this.filterControl.value||"").toLowerCase();for(const o of this.selection.selected)-1===this.dataSource.filteredData.indexOf(o)&&this.selection.deselect(o)}),this.yamcs.yamcsClient.getLinks(this.yamcs.instance).then(i=>{for(const o of i)this.itemsByName[o.name]={link:o,hasChildren:!1,expanded:!1};for(const o of i)if(o.parentName){const c=this.itemsByName[o.parentName];c.hasChildren=!0,this.itemsByName[o.name].parentLink=c.link}this.updateDataSource(),this.linkSubscription=this.yamcs.yamcsClient.createLinkSubscription({instance:this.yamcs.instance},o=>{this.processLinkEvent(o)})})}expandItem(e,i){if(i.expanded=!i.expanded,!i.expanded)for(const o of this.selection.selected)o.parentLink&&o.parentLink.name===i.link.name&&this.selection.deselect(o);this.updateDataSource(),e.stopPropagation()}enableLink(e){this.yamcs.yamcsClient.enableLink(this.yamcs.instance,e)}disableLink(e){this.yamcs.yamcsClient.disableLink(this.yamcs.instance,e)}resetCounters(e){this.yamcs.yamcsClient.resetLinkCounters(this.yamcs.instance,e)}mayControlLinks(){return this.authService.getUser().hasSystemPrivilege("ControlLinks")}processLinkEvent(e){const i=this.detailLink$.value;if(i&&i.link.name===e.linkInfo.name){i.link=e.linkInfo;for(const o of Object.values(this.itemsByName))o.link.parentName===e.linkInfo.name&&(o.parentLink=e.linkInfo);this.detailLink$.next(Object.assign({},i))}switch(e.type){case"REGISTERED":case"UPDATED":this.itemsByName[e.linkInfo.name].link=e.linkInfo;for(const c of Object.values(this.itemsByName))c.parentLink&&c.parentLink.name===e.linkInfo.name&&(c.parentLink=e.linkInfo);this.updateDataSource();break;case"UNREGISTERED":this.selection.deselect(this.itemsByName[e.linkInfo.name]),delete this.itemsByName[e.linkInfo.name],this.updateDataSource();break;default:console.error("Unexpected link update of type "+e.type)}this.changeDetection.detectChanges()}updateDataSource(){const e=Object.values(this.itemsByName).filter(i=>{const o=i.link.parentName;return!o||this.itemsByName[o].expanded});e.sort((i,o)=>{const c=i.link.name.split("."),m=o.link.name.split(".");for(let p=0;p<Math.max(c.length,m.length);p++){const A=(p<c.length?c[p]:"").localeCompare(p<m.length?m[p]:"");if(0!==A)return A}return 0}),this.dataSource.data=e}allowGroupEnable(){for(const e of this.selection.selected)if(e.link.disabled)return!0;return!1}allowGroupDisable(){for(const e of this.selection.selected)if(!e.link.disabled)return!0;return!1}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(e=>this.selection.select(e))}toggleOne(e){(!this.selection.isSelected(e)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(e)}enableSelectedLinks(){for(const e of this.selection.selected)this.enableLink(e.link.name)}disableSelectedLinks(){for(const e of this.selection.selected)this.disableLink(e.link.name)}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filterControl.value||null},queryParamsHandling:"merge"})}selectNext(){const e=this.dataSource.filteredData;let i=0;if(this.selection.hasValue()){const o=this.selection.selected[this.selection.selected.length-1];-1!==e.indexOf(o)&&(i=Math.min(e.indexOf(o)+1,e.length-1))}this.selection.clear(),this.selection.select(e[i])}selectPrevious(){const e=this.dataSource.filteredData;let i=0;if(this.selection.hasValue()){const o=this.selection.selected[0];-1!==e.indexOf(o)&&(i=Math.max(e.indexOf(o)-1,0))}this.selection.clear(),this.selection.select(e[i])}applySelection(){this.selection.hasValue()&&1===this.selection.selected.length&&this.router.navigate(["/links",this.selection.selected[0].link.name],{queryParams:{c:this.yamcs.context}})}ngOnDestroy(){this.selectionSubscription&&this.selectionSubscription.unsubscribe(),this.linkSubscription&&this.linkSubscription.cancel()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(k.C),t.Y36(y.e),t.Y36(L.Dx),t.Y36(t.sBO),t.Y36(g.gz),t.Y36(g.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],decls:56,vars:21,consts:[[3,"hasDetailPane"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],[4,"ngIf","ngIfElse"],["noSelection",""],[1,"table-wrapper"],[1,"panel-content"],[1,"filter-bar",2,"margin-top","16px"],["placeholder","Filter links",3,"formControl","onArrowDown","onArrowUp","onEnter"],["preferenceKey","links",3,"columns"],["columnChooser",""],["mat-table","",1,"ya-data-table","expand",3,"dataSource","trackBy"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","style","white-space: nowrap",4,"matCellDef"],["matColumnDef","className"],["mat-cell","",4,"matCellDef"],["matColumnDef","status"],["mat-header-cell","","class","status",4,"matHeaderCellDef"],["mat-cell","","class","status","style","line-height: 0",4,"matCellDef"],["matColumnDef","in"],["mat-header-cell","","style","text-align: center",4,"matHeaderCellDef"],["mat-cell","","style","text-align: center",4,"matCellDef"],["matColumnDef","out"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","disabled","click",4,"matRowDef","matRowDefColumns"],[1,"legend"],[1,"legend-item"],["color","rgba(0, 100, 0)",3,"fade"],["color","rgba(0, 255, 0)",3,"fade"],["color","red",3,"fade"],["color","#aaa",3,"fade"],["mat-button","","color","primary",3,"disabled","click"],[2,"padding","0 16px"],[3,"link"],["style","padding: 0 16px;",4,"ngIf"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked","change"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"checked","click","change"],["mat-header-cell",""],["mat-cell","",2,"white-space","nowrap"],["style","display: inline-block; margin-right: 10px;",4,"ngIf"],[3,"routerLink","queryParams"],[3,"text","term"],["mat-stroked-button","","class","expandable",3,"click",4,"ngIf"],[2,"display","inline-block","margin-right","10px"],[3,"link","parentLink"],["mat-stroked-button","",1,"expandable",3,"click"],[4,"ngIf"],["mat-cell",""],["mat-header-cell","",1,"status"],["mat-cell","",1,"status",2,"line-height","0"],[3,"link",4,"ngIf"],["mat-header-cell","",2,"text-align","center"],["mat-cell","",2,"text-align","center"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"disabled","click"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,i){if(1&e&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar",0),t._uU(2," Links \xa0\xa0\xa0 "),t.YNc(3,jt,4,1,"button",1),t.YNc(4,Wt,4,1,"button",1),t.qZA(),t.TgZ(5,"app-detail-pane"),t.YNc(6,Kt,5,1,"ng-container",2),t.ALo(7,"async"),t.YNc(8,Gt,3,1,"ng-template",null,3,t.W1O),t.qZA(),t.TgZ(10,"div",4),t.TgZ(11,"div",5),t._UZ(12,"app-links-page-tabs"),t.TgZ(13,"div",6),t.TgZ(14,"app-search-filter",7),t.NdJ("onArrowDown",function(){return i.selectNext()})("onArrowUp",function(){return i.selectPrevious()})("onEnter",function(){return i.applySelection()}),t.qZA(),t._UZ(15,"app-column-chooser",8,9),t.qZA(),t.TgZ(17,"table",10),t.ynx(18,11),t.YNc(19,Xt,2,1,"th",12),t.YNc(20,te,2,1,"td",13),t.BQk(),t.ynx(21,14),t.YNc(22,ee,2,0,"th",15),t.YNc(23,le,5,10,"td",16),t.BQk(),t.ynx(24,17),t.YNc(25,re,2,0,"th",15),t.YNc(26,pe,2,2,"td",18),t.BQk(),t.ynx(27,19),t.YNc(28,ue,1,0,"th",20),t.YNc(29,me,2,1,"td",21),t.BQk(),t.ynx(30,22),t.YNc(31,de,2,0,"th",23),t.YNc(32,ge,3,3,"td",24),t.BQk(),t.ynx(33,25),t.YNc(34,he,2,0,"th",23),t.YNc(35,fe,3,3,"td",24),t.BQk(),t.ynx(36,26),t.YNc(37,ke,1,0,"th",27),t.YNc(38,Te,2,1,"td",18),t.BQk(),t.YNc(39,xe,1,0,"tr",28),t.ALo(40,"async"),t.YNc(41,Ae,1,4,"tr",29),t.ALo(42,"async"),t.qZA(),t.TgZ(43,"div",30),t.TgZ(44,"div",31),t._UZ(45,"app-led",32),t._uU(46," OK "),t.qZA(),t.TgZ(47,"div",31),t._UZ(48,"app-led",33),t._uU(49," OK, activity "),t.qZA(),t.TgZ(50,"div",31),t._UZ(51,"app-led",34),t._uU(52," Error "),t.qZA(),t.TgZ(53,"div",31),t._UZ(54,"app-led",35),t._uU(55," Disabled "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e){const o=t.MAs(9),c=t.MAs(16);t.xp6(1),t.Q6J("hasDetailPane",!0),t.xp6(2),t.Q6J("ngIf",i.mayControlLinks()),t.xp6(1),t.Q6J("ngIf",i.mayControlLinks()),t.xp6(2),t.Q6J("ngIf",t.lcZ(7,15,i.detailLink$))("ngIfElse",o),t.xp6(8),t.Q6J("formControl",i.filterControl),t.xp6(1),t.Q6J("columns",i.columns),t.xp6(2),t.Q6J("dataSource",i.dataSource)("trackBy",i.tableTrackerFn),t.xp6(22),t.Q6J("matHeaderRowDef",t.lcZ(40,17,c.displayedColumns$)),t.xp6(2),t.Q6J("matRowDefColumns",t.lcZ(42,19,c.displayedColumns$)),t.xp6(4),t.Q6J("fade",!1),t.xp6(3),t.Q6J("fade",!1),t.xp6(3),t.Q6J("fade",!1),t.xp6(3),t.Q6J("fade",!1)}},directives:[C.a,v.k,_.O5,b.lW,Y.Hw,Ot.Z,Qt.j,Bt,P,Ft.a,l.JJ,l.oH,Ht.k,r.BZ,U.fo,U.D5,r.ge,U.O_,r.ev,r.w1,r.fO,r.Dz,S,g.yS,Rt.y,$t.T,Vt.OP,T.d,r.as,r.XQ,r.nj,r.Gk,x.on],pipes:[_.Ov,_.JJ],styles:[".detail[_ngcontent-%COMP%]{background-color:#fafafa;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}tr.disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], tr.disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-style:italic;color:#aaa}.legend[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:12px;margin-top:12px;margin-left:10px}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:10px}.legend-item[_ngcontent-%COMP%]   app-led[_ngcontent-%COMP%]{margin-right:4px}"],changeDetection:0}),n})()},{path:"log",component:O},{path:":link",component:E}]}];let Ce=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[g.Bz.forChild(Le)],g.Bz]}),n})(),ve=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[B.m,Ce]]}),n})()}}]);