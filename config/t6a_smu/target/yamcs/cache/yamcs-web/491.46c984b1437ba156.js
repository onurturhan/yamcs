"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[491],{5491:(ne,x,l)=>{l.r(x),l.d(x,{GapsModule:()=>ee});var Q=l(7573),f=l(1083),O=l(7309),y=l(4375),I=l(9326),r=l(8279),_=l(1135),Z=l(381),g=l(2134),t=l(5e3),A=l(4454),S=l(2313),P=l(8928),k=l(9140),C=l(7423),U=l(3874),N=l(3251);const J=function(){return{matrixParams:"exact",paths:"exact",queryParams:"ignored"}},G=function(e){return{c:e}};let b=(()=>{class e{constructor(a){this.yamcs=a}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(Z.C))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-gaps-page-tabs"]],decls:7,vars:10,consts:[["mat-tab-nav-bar",""],["mat-tab-link","","routerLink","/gaps","routerLinkActive","",3,"routerLinkActiveOptions","active","queryParams"],["rla","routerLinkActive"],["mat-tab-link","","routerLink","/gaps/requests","routerLinkActive","",3,"active","queryParams"],["rlb","routerLinkActive"]],template:function(a,n){if(1&a&&(t.TgZ(0,"nav",0),t.TgZ(1,"a",1,2),t._uU(3," GAPS "),t.qZA(),t.TgZ(4,"a",3,4),t._uU(6," REQUESTS "),t.qZA(),t.qZA()),2&a){const s=t.MAs(2),c=t.MAs(5);t.xp6(1),t.Q6J("routerLinkActiveOptions",t.DdM(5,J))("active",s.isActive)("queryParams",t.VKq(6,G,n.yamcs.context)),t.xp6(3),t.Q6J("active",c.isActive)("queryParams",t.VKq(8,G,n.yamcs.context))}},directives:[N.BU,f.yS,N.Nj,f.Od],styles:[".mat-tab-link[_ngcontent-%COMP%]{height:36px;min-width:0;font-size:13px}"],changeDetection:0}),e})();var h=l(9808),M=l(4953),$=l(6147),R=l(119);function L(e,i){if(1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"duration"),t.BQk()),2&e){const a=i.ngIf;t.xp6(1),t.hij("Each ",t.lcZ(2,1,a),"")}}function B(e,i){1&e&&t.GkF(0)}function F(e,i){1&e&&(t.TgZ(0,"th",21),t._uU(1,"Request time"),t.qZA())}function H(e,i){if(1&e&&(t.TgZ(0,"td",22),t._uU(1),t.ALo(2,"ago"),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,a.requestTime))}}function E(e,i){1&e&&(t.TgZ(0,"th",21),t._uU(1,"Range start"),t.qZA())}function j(e,i){if(1&e&&(t.TgZ(0,"td",22),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,a.start))}}function V(e,i){1&e&&(t.TgZ(0,"th",21),t._uU(1,"Range stop"),t.qZA())}function X(e,i){if(1&e&&(t.TgZ(0,"td",22),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,a.stop))}}function z(e,i){1&e&&(t.TgZ(0,"th",21),t._uU(1,"APID"),t.qZA())}function W(e,i){if(1&e&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.Oqu(a.apid||"-")}}function K(e,i){1&e&&(t.TgZ(0,"th",21),t._uU(1,"Vehicle"),t.qZA())}function tt(e,i){1&e&&(t.ynx(0),t._uU(1,"ISS/USOS"),t.BQk())}function et(e,i){1&e&&(t.ynx(0),t._uU(1,"ISS/RS"),t.BQk())}function at(e,i){1&e&&(t.ynx(0),t._uU(1,"ISS/Columbus"),t.BQk())}function it(e,i){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const a=t.oxw().$implicit;t.xp6(1),t.Oqu(a.vehicle||"-")}}function nt(e,i){if(1&e&&(t.TgZ(0,"td",22),t.ynx(1,23),t.YNc(2,tt,2,0,"ng-container",24),t.YNc(3,et,2,0,"ng-container",24),t.YNc(4,at,2,0,"ng-container",24),t.YNc(5,it,2,1,"ng-container",25),t.BQk(),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.Q6J("ngSwitch",a.vehicle),t.xp6(1),t.Q6J("ngSwitchCase",0),t.xp6(1),t.Q6J("ngSwitchCase",1),t.xp6(1),t.Q6J("ngSwitchCase",2)}}function st(e,i){1&e&&(t.TgZ(0,"th",21),t._uU(1,"Packet type"),t.qZA())}function ot(e,i){1&e&&(t.ynx(0),t._uU(1,"Core"),t.BQk())}function lt(e,i){1&e&&(t.ynx(0),t._uU(1,"Payload"),t.BQk())}function ct(e,i){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const a=t.oxw().$implicit;t.xp6(1),t.Oqu(a.packetType||"-")}}function rt(e,i){if(1&e&&(t.TgZ(0,"td",22),t.ynx(1,23),t.YNc(2,ot,2,0,"ng-container",24),t.YNc(3,lt,2,0,"ng-container",24),t.YNc(4,ct,2,1,"ng-container",25),t.BQk(),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.Q6J("ngSwitch",a.packetType),t.xp6(1),t.Q6J("ngSwitchCase",0),t.xp6(1),t.Q6J("ngSwitchCase",1)}}function pt(e,i){1&e&&(t.TgZ(0,"th",21),t._uU(1,"User"),t.qZA())}function ut(e,i){if(1&e&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.Oqu(a.user||"-")}}function mt(e,i){1&e&&(t.TgZ(0,"th",21),t._uU(1,"Status"),t.qZA())}function dt(e,i){if(1&e&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.Oqu(a.status||"-")}}function gt(e,i){1&e&&(t.TgZ(0,"th",21),t._uU(1,"Received"),t.qZA())}function ht(e,i){if(1&e&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.Oqu(a.tmCount)}}function ft(e,i){1&e&&(t.TgZ(0,"th",21),t._uU(1,"PHS"),t.qZA())}function _t(e,i){if(1&e&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.Oqu(a.privateHeaderSource||"-")}}function Zt(e,i){1&e&&t._UZ(0,"th",26)}function Tt(e,i){1&e&&t._UZ(0,"td",22)}function vt(e,i){1&e&&t._UZ(0,"tr",27)}function qt(e,i){1&e&&t._UZ(0,"tr",28)}let D=(()=>{class e{constructor(a,n,s){this.yamcs=a,this.messageService=n,this.displayedColumns=["requestTime","user","vehicle","packetType","apid","privateHeaderSource","start","stop","status","tmCount","actions"],this.interval$=new _.X(null),this.period$=new _.X(null),this.dataSource=new r.by,s.setTitle("Playback requests"),this.loadData()}loadData(){this.yamcs.yamcsClient.getLinks(this.yamcs.instance).then(a=>{let n=null;for(const s of a)if(-1!==s.type.indexOf("DassPlaybackPacketProvider")){n=s.name;break}n&&this.yamcs.yamcsClient.getPlaybackInfo(this.yamcs.instance,n).then(s=>{this.interval$.next(s.interval?g.bT(s.interval):null),this.period$.next(s.period?g.bT(s.period):null),this.dataSource.data=s.requests||[]}).catch(s=>this.messageService.showError(s))}).catch(a=>this.messageService.showError(a))}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(Z.C),t.Y36(A.e),t.Y36(S.Dx))},e.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],decls:58,vars:14,consts:[["mat-icon-button","","color","primary",3,"click"],[1,"panel-content"],[1,"dl-horizontal"],[4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","requestTime"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","start"],["matColumnDef","stop"],["matColumnDef","apid"],["matColumnDef","vehicle"],["matColumnDef","packetType"],["matColumnDef","user"],["matColumnDef","status"],["matColumnDef","tmCount"],["matColumnDef","privateHeaderSource"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(a,n){1&a&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar"),t._uU(2," Playback requests \xa0\xa0\xa0 "),t.TgZ(3,"button",0),t.NdJ("click",function(){return n.loadData()}),t.TgZ(4,"mat-icon"),t._uU(5,"refresh"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"div",1),t._UZ(7,"app-gaps-page-tabs"),t.TgZ(8,"dl",2),t.TgZ(9,"dt"),t._uU(10,"Automated playback:"),t.qZA(),t.TgZ(11,"dd"),t.YNc(12,L,3,3,"ng-container",3),t.ALo(13,"async"),t.YNc(14,B,1,0,"ng-container",3),t.ALo(15,"async"),t.qZA(),t.TgZ(16,"dt"),t._uU(17,"Lookback period:"),t.qZA(),t.TgZ(18,"dd"),t._uU(19),t.ALo(20,"duration"),t.ALo(21,"async"),t.qZA(),t.qZA(),t.TgZ(22,"table",4),t.ynx(23,5),t.YNc(24,F,2,0,"th",6),t.YNc(25,H,3,3,"td",7),t.BQk(),t.ynx(26,8),t.YNc(27,E,2,0,"th",6),t.YNc(28,j,3,3,"td",7),t.BQk(),t.ynx(29,9),t.YNc(30,V,2,0,"th",6),t.YNc(31,X,3,3,"td",7),t.BQk(),t.ynx(32,10),t.YNc(33,z,2,0,"th",6),t.YNc(34,W,2,1,"td",7),t.BQk(),t.ynx(35,11),t.YNc(36,K,2,0,"th",6),t.YNc(37,nt,6,4,"td",7),t.BQk(),t.ynx(38,12),t.YNc(39,st,2,0,"th",6),t.YNc(40,rt,5,3,"td",7),t.BQk(),t.ynx(41,13),t.YNc(42,pt,2,0,"th",6),t.YNc(43,ut,2,1,"td",7),t.BQk(),t.ynx(44,14),t.YNc(45,mt,2,0,"th",6),t.YNc(46,dt,2,1,"td",7),t.BQk(),t.ynx(47,15),t.YNc(48,gt,2,0,"th",6),t.YNc(49,ht,2,1,"td",7),t.BQk(),t.ynx(50,16),t.YNc(51,ft,2,0,"th",6),t.YNc(52,_t,2,1,"td",7),t.BQk(),t.ynx(53,17),t.YNc(54,Zt,1,0,"th",18),t.YNc(55,Tt,1,0,"td",7),t.BQk(),t.YNc(56,vt,1,0,"tr",19),t.YNc(57,qt,1,0,"tr",20),t.qZA(),t.qZA(),t.qZA()),2&a&&(t.xp6(12),t.Q6J("ngIf",t.lcZ(13,6,n.interval$)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(15,8,n.interval$)),t.xp6(5),t.hij(" ",t.lcZ(20,10,t.lcZ(21,12,n.period$))||"-"," "),t.xp6(3),t.Q6J("dataSource",n.dataSource),t.xp6(34),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns))},directives:[P.a,k.k,C.lW,U.Hw,b,h.O5,r.BZ,r.w1,r.fO,r.ge,r.Dz,r.ev,h.RF,h.n9,h.ED,r.as,r.XQ,r.nj,r.Gk],pipes:[h.Ov,M.u,$.n,R.i],encapsulation:2,changeDetection:0}),e})();var xt=l(449),o=l(3075),d=l(8966),v=l(141);let yt=(()=>{class e{constructor(a,n,s){this.dialogRef=a,this.yamcs=n,this.data=s,this.linkOptions$=new _.X([]),this.form=new o.cw({mergeTolerance:new o.NI(30),link:new o.NI("",o.kI.required)}),this.gaps=this.data.gaps,this.yamcs.yamcsClient.getLinks(n.instance).then(c=>{const p=[];for(const u of c)-1!==u.type.indexOf("DassPlaybackPacketProvider")&&p.push({id:u.name,label:u.name});this.linkOptions$.next(p),p.length&&this.form.get("link").setValue(p[0].id)})}sendRequest(){const a=[],n=new Map,s=60*this.form.value.mergeTolerance*1e3;this.gaps.sort((c,p)=>c.start.localeCompare(p.start));for(const c of this.gaps){const p=n.get(c.apid);if(p&&this.toMillis(c.start)-this.toMillis(p.stop)<s)p.stop=c.stop;else{const u={apid:c.apid,start:c.start,stop:c.stop};a.push(u),n.set(c.apid,u)}}this.dialogRef.close({link:this.form.value.link,ranges:a})}toMillis(a){return g.ZU(a).getTime()}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(d.so),t.Y36(Z.C),t.Y36(d.WI))},e.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],decls:21,vars:6,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","number","formControlName","mergeTolerance"],[1,"hint"],["formControlName","link",3,"options"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(a,n){1&a&&(t.TgZ(0,"h2",0),t._uU(1),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.TgZ(3,"form",2),t.TgZ(4,"label"),t._uU(5," Merge tolerance (minutes) "),t._UZ(6,"input",3),t.TgZ(7,"span",4),t._uU(8,"Gaps that are at least this close to each other, are merged into a single request."),t.qZA(),t.qZA(),t._UZ(9,"br"),t.TgZ(10,"label"),t._uU(11," DaSS link "),t._UZ(12,"app-select",5),t.ALo(13,"async"),t.TgZ(14,"span",4),t._uU(15,"This link will send out the request, and handle data reception."),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"mat-dialog-actions",6),t.TgZ(17,"button",7),t._uU(18,"CANCEL"),t.qZA(),t.TgZ(19,"button",8),t.NdJ("click",function(){return n.sendRequest()}),t._uU(20,"SEND REQUEST"),t.qZA(),t.qZA()),2&a&&(t.xp6(1),t.hij("Request playback of ",n.gaps.length," selected gaps"),t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(9),t.Q6J("options",t.lcZ(13,4,n.linkOptions$)),t.xp6(7),t.Q6J("disabled",!n.form.valid))},directives:[d.uh,d.xY,o._Y,o.JL,o.sg,o.wV,o.Fj,o.JJ,o.u,v.P,d.H8,d.ZT],pipes:[h.Ov],encapsulation:2}),e})();var Y=l(4071);let At=(()=>{class e{constructor(a,n,s){this.dialogRef=a,this.yamcs=n,this.data=s,this.linkOptions$=new _.X([]),this.form=new o.cw({apid:new o.NI("",o.kI.required),start:new o.NI("",o.kI.required),stop:new o.NI("",o.kI.required),link:new o.NI("",o.kI.required)});const c=this.data.gap;c&&this.form.setValue({apid:c.apid,start:c.start,stop:c.stop,link:""}),this.yamcs.yamcsClient.getLinks(n.instance).then(p=>{const u=[];for(const m of p)-1!==m.type.indexOf("DassPlaybackPacketProvider")&&u.push({id:m.name,label:m.name});this.linkOptions$.next(u),u.length&&this.form.get("link").setValue(u[0].id)})}sendRequest(){const a={apid:Number(this.form.value.apid),start:this.form.value.start,stop:this.form.value.stop};this.dialogRef.close({link:this.form.value.link,ranges:[a]})}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(d.so),t.Y36(Z.C),t.Y36(d.WI))},e.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],decls:27,vars:5,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","number","formControlName","apid"],["formControlName","start"],["formControlName","stop"],["formControlName","link",3,"options"],[1,"hint"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(a,n){1&a&&(t.TgZ(0,"h2",0),t._uU(1,"Request playback"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.TgZ(3,"form",2),t.TgZ(4,"label"),t._uU(5," APID "),t._UZ(6,"input",3),t.qZA(),t._UZ(7,"br"),t.TgZ(8,"label"),t._uU(9," Start time "),t._UZ(10,"app-date-time-input",4),t.qZA(),t._UZ(11,"br"),t.TgZ(12,"label"),t._uU(13," Stop time "),t._UZ(14,"app-date-time-input",5),t.qZA(),t._UZ(15,"br"),t.TgZ(16,"label"),t._uU(17," DaSS link "),t._UZ(18,"app-select",6),t.ALo(19,"async"),t.TgZ(20,"span",7),t._uU(21,"This link will send out the request, and handle data reception."),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(22,"mat-dialog-actions",8),t.TgZ(23,"button",9),t._uU(24,"CANCEL"),t.qZA(),t.TgZ(25,"button",10),t.NdJ("click",function(){return n.sendRequest()}),t._uU(26,"SEND REQUEST"),t.qZA(),t.qZA()),2&a&&(t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(15),t.Q6J("options",t.lcZ(19,3,n.linkOptions$)),t.xp6(7),t.Q6J("disabled",!n.form.valid))},directives:[d.uh,d.xY,o._Y,o.JL,o.sg,o.wV,o.Fj,o.JJ,o.u,Y.Y,v.P,d.H8,d.ZT],pipes:[h.Ov],encapsulation:2}),e})();var St=l(7238),q=l(7587),Pt=l(8493),kt=l(2181),Ct=l(2768);const Ut=["intervalSelect"];function Nt(e,i){if(1&e){const a=t.EpF();t.ynx(0),t._UZ(1,"app-date-time-input",28),t._UZ(2,"app-date-time-input",29),t.TgZ(3,"button",30),t.NdJ("click",function(){return t.CHM(a),t.oxw().applyCustomDates()}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&e){const a=t.oxw();t.xp6(3),t.Q6J("disabled",a.filterForm.invalid)}}function Gt(e,i){if(1&e){const a=t.EpF();t.ynx(0),t.TgZ(1,"button",31),t.NdJ("click",function(){return t.CHM(a),t.oxw().jumpToNow()}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function bt(e,i){if(1&e){const a=t.EpF();t.TgZ(0,"th",32),t.TgZ(1,"input",33),t.NdJ("change",function(s){t.CHM(a);const c=t.oxw();return s?c.masterToggle():null}),t.qZA(),t.qZA()}if(2&e){const a=t.oxw();t.xp6(1),t.Q6J("checked",a.selection.hasValue()&&a.isAllSelected())}}function Rt(e,i){if(1&e){const a=t.EpF();t.TgZ(0,"td",34),t.TgZ(1,"input",35),t.NdJ("click",function(s){return s.stopPropagation()})("change",function(s){const p=t.CHM(a).$implicit,u=t.oxw();return s?u.selection.toggle(p):null}),t.qZA(),t.qZA()}if(2&e){const a=i.$implicit,n=t.oxw();t.xp6(1),t.Q6J("checked",n.selection.isSelected(a))("disabled",!a.start||!a.stop)}}function Dt(e,i){1&e&&(t.TgZ(0,"th",36),t._uU(1,"APID"),t.qZA())}function Yt(e,i){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.hij(" ",a.apid," ")}}function wt(e,i){1&e&&(t.TgZ(0,"th",36),t._uU(1,"Start"),t.qZA())}function Qt(e,i){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,a.start)||"-"," ")}}function Ot(e,i){1&e&&(t.TgZ(0,"th",36),t._uU(1,"Stop"),t.qZA())}function It(e,i){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,a.stop)||"-"," ")}}function Jt(e,i){1&e&&(t.TgZ(0,"th",36),t._uU(1,"Start sequence"),t.qZA())}function Mt(e,i){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.hij(" ",a.startSequenceCount||"-"," ")}}function $t(e,i){1&e&&(t.TgZ(0,"th",36),t._uU(1,"Stop sequence"),t.qZA())}function Lt(e,i){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.hij(" ",a.stopSequenceCount||"-"," ")}}function Bt(e,i){1&e&&(t.TgZ(0,"th",38),t._uU(1,"Duration"),t.qZA())}function Ft(e,i){if(1&e&&(t.TgZ(0,"td",39),t._uU(1),t.ALo(2,"deltaWith"),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.hij(" ",t.Dn7(2,1,a.stop,a.start,!1)||"-"," ")}}function Ht(e,i){1&e&&(t.TgZ(0,"th",36),t._uU(1,"Missing packets"),t.qZA())}function Et(e,i){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.hij(" ",a.missingPacketCount||"-"," ")}}function jt(e,i){1&e&&t._UZ(0,"th",40)}function Vt(e,i){if(1&e){const a=t.EpF();t.TgZ(0,"app-more"),t.TgZ(1,"button",41),t.NdJ("click",function(){t.CHM(a);const s=t.oxw().$implicit;return t.oxw().openPlaybackDialog(s)}),t._uU(2," Request playback "),t.qZA(),t.qZA()}}function Xt(e,i){if(1&e&&(t.TgZ(0,"td",37),t.YNc(1,Vt,3,0,"app-more",8),t.qZA()),2&e){const a=i.$implicit;t.xp6(1),t.Q6J("ngIf",a.start&&a.stop)}}function zt(e,i){1&e&&t._UZ(0,"tr",42)}function Wt(e,i){if(1&e){const a=t.EpF();t.TgZ(0,"tr",43),t.NdJ("click",function(){const c=t.CHM(a).$implicit;return t.oxw().toggleOne(c)}),t.qZA()}if(2&e){const a=i.$implicit,n=t.oxw();t.ekj("selected",n.selection.isSelected(a))}}const Kt=[{path:"",canActivate:[y.a,O.z],canActivateChild:[y.a],runGuardsAndResolvers:"always",component:I.K,children:[{path:"",pathMatch:"full",component:(()=>{class e{constructor(a,n,s,c,p,u){this.yamcs=a,this.dialog=s,this.messageService=c,this.router=p,this.route=u,this.filterForm=new o.cw({apid:new o.NI("ANY"),interval:new o.NI("NO_LIMIT"),customStart:new o.NI(null),customStop:new o.NI(null)}),this.displayedColumns=["select","apid","start","stop","duration","startSequence","stopSequence","packetCount","actions"],this.apidOptions$=new _.X([{id:"ANY",label:"Any APID"}]),this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.dataSource=new r.by,this.selection=new xt.Ov(!0,[]),n.setTitle("Gaps"),a.yamcsClient.getApids(a.instance).then(m=>{for(const T of m)this.apidOptions$.next([...this.apidOptions$.value,{id:String(T),label:`APID ${T}`}])}),this.initializeOptions(),this.loadData(),this.filterForm.get("apid").valueChanges.forEach(m=>{this.apid="ANY"!==m?m:null,this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(m=>{if("CUSTOM"===m){const T=new Date,ae=this.validStart||T,ie=this.validStop||T;this.filterForm.get("customStart").setValue(g.Y6(ae)),this.filterForm.get("customStop").setValue(g.Y6(ie))}else"NO_LIMIT"===m?(this.validStart=null,this.validStop=null,this.appliedInterval=m,this.loadData()):(this.validStop=new Date,this.validStart=(0,g.rV)(this.validStop,m),this.appliedInterval=m,this.loadData())})}initializeOptions(){const a=this.route.snapshot.queryParamMap;if(a.has("apid")&&(this.apid=a.get("apid"),this.filterForm.get("apid").setValue(this.apid)),a.has("interval"))if(this.appliedInterval=a.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const n=a.get("customStart");this.filterForm.get("customStart").setValue(n),this.validStart=g.ZU(n);const s=a.get("customStop");this.filterForm.get("customStop").setValue(s),this.validStop=g.ZU(s)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=(0,g.rV)(this.validStop,this.appliedInterval));else this.appliedInterval="NO_LIMIT",this.validStop=null,this.validStart=null}jumpToNow(){this.filterForm.get("interval").setValue("NO_LIMIT")}applyCustomDates(){this.validStart=g.ZU(this.filterForm.value.customStart),this.validStop=g.ZU(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.selection.clear(),this.updateURL();const a={};this.validStart&&(a.start=this.validStart.toISOString()),this.validStop&&(a.stop=this.validStop.toISOString()),null!=this.apid&&(a.apid=Number(this.apid)),this.yamcs.yamcsClient.getGaps(this.yamcs.instance,a).then(n=>this.dataSource.data=(n.gaps||[]).reverse()).catch(n=>this.messageService.showError(n))}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}updateURL(){var a;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{apid:null!==(a=this.apid)&&void 0!==a?a:null,interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(a=>{a.start&&a.stop&&this.selection.select(a)})}toggleOne(a){!a.start||!a.stop||((!this.selection.isSelected(a)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(a))}openPlaybackDialog(a){const n=a?[a]:this.selection.selected;let s;s=n.length<=1?this.dialog.open(At,{data:{gap:n[0]},width:"500px"}):this.dialog.open(yt,{data:{gaps:n},width:"500px"}),s.afterClosed().subscribe(c=>{c&&this.yamcs.yamcsClient.requestPlayback(this.yamcs.instance,c.link,{ranges:c.ranges}).then(()=>this.messageService.showInfo("Playback requested")).catch(p=>this.messageService.showError(p))})}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(Z.C),t.Y36(S.Dx),t.Y36(d.uw),t.Y36(A.e),t.Y36(f.F0),t.Y36(f.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],viewQuery:function(a,n){if(1&a&&t.Gf(Ut,5),2&a){let s;t.iGM(s=t.CRH())&&(n.intervalSelect=s.first)}},decls:50,vars:10,consts:[["mat-button","","color","primary",3,"click"],["mat-icon-button","","matTooltip","Jump to now","color","primary",3,"click"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar",2,"margin-top","16px"],["formControlName","apid",3,"options"],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],[4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["matColumnDef","apid"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","start"],["matColumnDef","stop"],["matColumnDef","startSequence"],["matColumnDef","stopSequence"],["matColumnDef","duration"],["mat-header-cell","","class","vdiv",4,"matHeaderCellDef"],["mat-cell","","class","vdiv",4,"matCellDef"],["matColumnDef","packetCount"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked","change"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"checked","disabled","click","change"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"vdiv"],["mat-cell","",1,"vdiv"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(a,n){1&a&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar"),t._uU(2," Gaps \xa0\xa0\xa0 "),t.TgZ(3,"button",0),t.NdJ("click",function(){return n.openPlaybackDialog()}),t.TgZ(4,"mat-icon"),t._uU(5,"redo"),t.qZA(),t._uU(6," REQUEST PLAYBACK "),t.qZA(),t.TgZ(7,"button",1),t.NdJ("click",function(){return n.jumpToNow()}),t.TgZ(8,"mat-icon"),t._uU(9,"refresh"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div",2),t._UZ(11,"app-gaps-page-tabs"),t.TgZ(12,"form",3),t.TgZ(13,"div",4),t._UZ(14,"app-select",5),t.ALo(15,"async"),t._UZ(16,"app-select",6,7),t.YNc(18,Nt,5,1,"ng-container",8),t.YNc(19,Gt,3,0,"ng-container",8),t.qZA(),t.qZA(),t.TgZ(20,"table",9),t.ynx(21,10),t.YNc(22,bt,2,1,"th",11),t.YNc(23,Rt,2,2,"td",12),t.BQk(),t.ynx(24,13),t.YNc(25,Dt,2,0,"th",14),t.YNc(26,Yt,2,1,"td",15),t.BQk(),t.ynx(27,16),t.YNc(28,wt,2,0,"th",14),t.YNc(29,Qt,3,3,"td",15),t.BQk(),t.ynx(30,17),t.YNc(31,Ot,2,0,"th",14),t.YNc(32,It,3,3,"td",15),t.BQk(),t.ynx(33,18),t.YNc(34,Jt,2,0,"th",14),t.YNc(35,Mt,2,1,"td",15),t.BQk(),t.ynx(36,19),t.YNc(37,$t,2,0,"th",14),t.YNc(38,Lt,2,1,"td",15),t.BQk(),t.ynx(39,20),t.YNc(40,Bt,2,0,"th",21),t.YNc(41,Ft,3,5,"td",22),t.BQk(),t.ynx(42,23),t.YNc(43,Ht,2,0,"th",14),t.YNc(44,Et,2,1,"td",15),t.BQk(),t.ynx(45,24),t.YNc(46,jt,1,0,"th",25),t.YNc(47,Xt,2,1,"td",15),t.BQk(),t.YNc(48,zt,1,0,"tr",26),t.YNc(49,Wt,1,2,"tr",27),t.qZA(),t.qZA(),t.qZA()),2&a&&(t.xp6(12),t.Q6J("formGroup",n.filterForm),t.xp6(2),t.Q6J("options",t.lcZ(15,8,n.apidOptions$)),t.xp6(2),t.Q6J("options",n.intervalOptions),t.xp6(2),t.Q6J("ngIf","CUSTOM"===n.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==n.filterForm.value.interval),t.xp6(1),t.Q6J("dataSource",n.dataSource),t.xp6(28),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns))},directives:[P.a,k.k,C.lW,U.Hw,St.gM,b,o._Y,o.JL,o.sg,v.P,o.JJ,o.u,h.O5,Y.Y,r.BZ,q.fo,q.D5,r.ge,q.O_,r.ev,r.w1,r.fO,r.Dz,Pt.T,kt.OP,r.as,r.XQ,r.nj,r.Gk],pipes:[h.Ov,R.i,Ct.m],encapsulation:2,changeDetection:0}),e})()},{path:"requests",component:D}]}];let te=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[f.Bz.forChild(Kt)],f.Bz]}),e})(),ee=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[Q.m,te]]}),e})()}}]);