"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[657],{1657:(yl,_t,p)=>{p.r(_t),p.d(_t,{TelemetryModule:()=>bl});var ne=p(7573),Z=p(381),t=p(5e3),_=p(9808);function re(a,n){if(1&a&&t._UZ(0,"img",7),2&a){const e=t.oxw();t.Q6J("src",e.url,t.LSH)}}let gt=(()=>{class a{constructor(e){this.storageClient=e.createStorageClient()}init(e){return this.url=this.storageClient.getObjectURL("_global","displays",e),Promise.resolve()}hasPendingChanges(){return!1}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.C))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-image-viewer"]],decls:7,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","version","1.1",1,"checkerboard"],["id","pattern","x","0","y","0","width","24","height","24","patternUnits","userSpaceOnUse"],["fill","rgba(204, 204, 204, 0.4)","x","0","width","12","height","12","y","0"],["fill","rgba(204, 204, 204, 0.4)","x","12","width","12","height","12","y","12"],["fill","url(#pattern)","x","0","y","0","width","100%","height","100%"],[1,"wrapper"],[3,"src",4,"ngIf"],[3,"src"]],template:function(e,i){1&e&&(t.O4$(),t.TgZ(0,"svg",0),t.TgZ(1,"pattern",1),t._UZ(2,"rect",2),t._UZ(3,"rect",3),t.qZA(),t._UZ(4,"rect",4),t.qZA(),t.kcU(),t.TgZ(5,"div",5),t.YNc(6,re,1,1,"img",6),t.qZA()),2&e&&(t.xp6(6),t.Q6J("ngIf",i.url))},directives:[_.O5],styles:[".checkerboard[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.wrapper[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"],changeDetection:0}),a})();var N=p(598),h=p(2134);class se extends N.LN{constructor(n,e){super(e),this.storageClient=n}resolve(n){if(n.startsWith("ys://")){const e=n.match(/ys:\/\/([^\\\/]+)\/(.+)/);if(e)return this.storageClient.getObjectURL("_global",e[1],e[2])}return super.resolve(n)}}class oe{constructor(n,e){this.yamcs=n,this.messageService=e}issueCommand(n,e){this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,n,{args:e}).catch(i=>this.messageService.showError(i))}}var y=p(1083),q=p(5328),et=p(4454);const le=["displayContainer"],$="MDB:OPS Name",E="ops://";let dt=(()=>{class a{constructor(e,i,r,s,o){this.yamcs=e,this.router=i,this.synchronizer=r,this.messageService=s,this.baseHref=o,this.idMapping={},this.pvsByName=new Map,this.subscriptionDirty=!1,this.storageClient=e.createStorageClient()}setViewerContainerEl(e){this.viewerContainerEl=e}updateSubscription(){if(this.subscriptionDirty){this.subscriptionDirty=!1,this.parameterSubscription&&this.parameterSubscription.cancel();const e=[];for(const i of this.pvsByName.keys())i.startsWith(E)?e.push({namespace:$,name:i.substr(6)}):e.push({name:i});e.length&&(this.parameterSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:e,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},i=>{var r;i.mapping&&(this.idMapping=i.mapping);for(const s of i.invalid||[]){let o=s.name;s.namespace===$&&(o=E+o);const c=this.display.getPV(o);c&&(c.disconnected=!0)}if(null===(r=i.values)||void 0===r?void 0:r.length){const s=new Map;for(const o of i.values){o.id=this.idMapping[o.numericId];let c=o.id.name;o.id.namespace===$&&(c=E+c),s.set(c,this.toSample(o))}this.display.setValues(s)}}))}}toSample(e){const s={time:h.ZU(e.generationTime),severity:this.toAlarmSeverity(e),value:void 0};return e.engValue&&(s.value=h.Ai(e.engValue),"ENUMERATED"===e.engValue.type&&(s.valueIndex=Number(e.engValue.sint64Value))),s}toAlarmSeverity(e){if("EXPIRED"===e.acquisitionStatus||"NOT_RECEIVED"==e.acquisitionStatus||"INVALID"===e.acquisitionStatus)return N.Xm.INVALID;if(!e.monitoringResult)return N.Xm.NONE;switch(e.monitoringResult){case"DISABLED":case"IN_LIMITS":return N.Xm.NONE;case"WATCH":case"WARNING":case"DISTRESS":return N.Xm.MINOR;case"CRITICAL":case"SEVERE":return N.Xm.MAJOR}}init(e){this.display=new N.sS(this.displayContainer.nativeElement),this.display.imagesPrefix=`${this.baseHref}static/`,this.display.setImageResolver(new se(this.storageClient,this.display));let r="";-1!==e.lastIndexOf("/")&&(r=e.substring(0,e.lastIndexOf("/")+1)),this.display.addScriptLibrary("Yamcs",new oe(this.yamcs,this.messageService)),this.display.addEventListener("opendisplay",m=>{m.path.startsWith("/")?this.router.navigateByUrl(`/telemetry/displays/files${m.path}?c=${this.yamcs.context}`):this.router.navigateByUrl(`/telemetry/displays/files/${r}${m.path}?c=${this.yamcs.context}`)}),this.display.addEventListener("closedisplay",m=>{this.router.navigateByUrl(`/telemetry/displays/browse?c=${this.yamcs.context}`)}),this.display.addEventListener("openpv",m=>{if(m.pvName.startsWith("/")){const x=encodeURIComponent(m.pvName);this.router.navigateByUrl(`/telemetry/parameters/${x}/summary?c=${this.yamcs.context}`)}else m.pvName.startsWith(E)?this.yamcs.yamcsClient.getParameterById(this.yamcs.instance,{namespace:$,name:m.pvName.substr(6)}).then(x=>{const d=encodeURIComponent(x.qualifiedName);this.router.navigateByUrl(`/telemetry/parameters/${d}/summary?c=${this.yamcs.context}`)}):alert(`Can't navigate to PV ${m.pvName}`)}),this.display.addProvider(this);const s=this.storageClient.getObjectURL("_global","displays",e),o=s.lastIndexOf("/")+1;this.display.baseUrl=s.substring(0,o);const c=this.display.setSource(s.substring(o));return c.then(()=>{this.syncSubscription=this.synchronizer.sync(()=>this.updateSubscription())}),c}canProvide(e){return!0}startProviding(e){for(const i of e)this.pvsByName.set(i.name,i);this.subscriptionDirty=!0}stopProviding(e){for(const i of e)this.pvsByName.delete(i.name);this.subscriptionDirty=!0}isNavigable(){return!0}shutdown(){}hasPendingChanges(){return!1}zoomIn(){this.display.scale+=.1}zoomOut(){this.display.scale-=.1}resetZoom(){this.display.scale=1}fitZoom(){const e=this.display.instance;if(e&&this.viewerContainerEl){const i=this.viewerContainerEl.clientWidth,r=this.viewerContainerEl.clientHeight,{width:s,height:o}=e.unscaledBounds;console.log("fit",s,o,"within",i,r);const c=i/s,m=r/o;console.log("scales",c,m),this.display.scale=Math.min(c,m)}}ngOnDestroy(){var e,i;null===(e=this.syncSubscription)||void 0===e||e.unsubscribe(),null===(i=this.parameterSubscription)||void 0===i||i.cancel()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.C),t.Y36(y.F0),t.Y36(q.j),t.Y36(et.e),t.Y36(_.mr))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-opi-display-viewer"]],viewQuery:function(e,i){if(1&e&&t.Gf(le,7),2&e){let r;t.iGM(r=t.CRH())&&(i.displayContainer=r.first)}},decls:4,vars:0,consts:[[1,"display-frame"],[1,"display-frame-inner"],[2,"display","inline-block"],["displayContainer",""]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t._UZ(2,"div",2,3),t.qZA(),t.qZA())},styles:[".display-frame[_ngcontent-%COMP%]{width:100%;height:100%;display:table}.display-frame-inner[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;overflow:auto;text-align:center}"],changeDetection:0}),a})();var T=p(1135),C=p(7423),S=p(3874);function ce(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",1),t.NdJ("click",function(){return t.CHM(e),t.oxw().fitZoom()}),t.TgZ(2,"mat-icon"),t._uU(3,"fit_screen"),t.qZA(),t._uU(4," ZOOM FIT "),t.qZA(),t.TgZ(5,"button",1),t.NdJ("click",function(){return t.CHM(e),t.oxw().zoomIn()}),t.TgZ(6,"mat-icon"),t._uU(7,"add_circle_outline"),t.qZA(),t._uU(8," ZOOM IN "),t.qZA(),t.TgZ(9,"button",1),t.NdJ("click",function(){return t.CHM(e),t.oxw().zoomOut()}),t.TgZ(10,"mat-icon"),t._uU(11,"remove_circle_outline"),t.qZA(),t._uU(12," ZOOM OUT "),t.qZA(),t.TgZ(13,"button",1),t.NdJ("click",function(){return t.CHM(e),t.oxw().resetZoom()}),t.TgZ(14,"mat-icon"),t._uU(15,"aspect_ratio"),t.qZA(),t._uU(16," ACTUAL SIZE "),t.qZA(),t.BQk()}}let ht=(()=>{class a{constructor(){this.initialized$=new T.X(!1)}init(e){this.viewer=e,this.initialized$.next(!0)}fitZoom(){this.viewer.fitZoom()}zoomIn(){this.viewer.zoomIn()}zoomOut(){this.viewer.zoomOut()}resetZoom(){this.viewer.resetZoom()}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-opi-display-viewer-controls"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-button","","color","primary",3,"click"]],template:function(e,i){1&e&&(t.YNc(0,ce,17,0,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,i.initialized$))},directives:[_.O5,C.lW,S.Hw],pipes:[_.Ov],encapsulation:2}),a})();var k=p(449),J=p(480),ft=p(735);class pe{constructor(n=10){this.pointer=0,this.latestValues=new Map,this.buf=Array(n).fill(void 0)}push(n,e){const i={};for(const r of n)i[e[r.numericId].name]=r;this.buf[this.pointer]=i,this.pointer=(this.pointer+1)%this.buf.length;for(const r of n)this.latestValues.set(e[r.numericId].name,r)}getLatestValue(n){return this.latestValues.get(n)}setSize(n){this.buf=Array(n).fill(void 0),this.pointer=0}snapshot(){return 0===this.pointer?[...this.buf]:[...this.buf.slice(this.pointer),...this.buf.slice(0,this.pointer)].reverse()}}var g=p(8966),u=p(8279),A=p(7587),H=p(7932),B=p(3847),me=p(8145),I=p(496),P=p(119);function ue(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"th",19),t.TgZ(1,"input",20),t.NdJ("change",function(r){t.CHM(e);const s=t.oxw(2);return r?s.masterToggle():null}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())}}function _e(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"td",21),t.TgZ(1,"input",22),t.NdJ("click",function(r){return r.stopPropagation()})("change",function(r){const o=t.CHM(e).$implicit,c=t.oxw(2);return r?c.selection.toggle(o.name):null}),t.qZA(),t.qZA()}if(2&a){const e=n.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("checked",i.selection.isSelected(e.name))}}function ge(a,n){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Name"),t.qZA())}const de=function(a){return["/telemetry/parameters",a]},he=function(a){return{c:a}};function fe(a,n){if(1&a&&(t.TgZ(0,"td",24),t.TgZ(1,"a",25),t._uU(2),t.qZA(),t.qZA()),2&a){const e=n.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("routerLink",t.VKq(3,de,e.name))("queryParams",t.VKq(5,he,i.yamcs.context)),t.xp6(1),t.hij(" ",e.name," ")}}function xe(a,n){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Severity"),t.qZA())}function Te(a,n){if(1&a&&t._UZ(0,"app-alarm-level",28),2&a){const e=t.oxw().$implicit;t.Q6J("level",null==e.pval?null:e.pval.monitoringResult)}}function be(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function ye(a,n){if(1&a&&(t.TgZ(0,"td",21),t.YNc(1,Te,1,1,"app-alarm-level",26),t.YNc(2,be,2,0,"span",27),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",null==e.pval?null:e.pval.monitoringResult),t.xp6(1),t.Q6J("ngIf",!(null!=e.pval&&e.pval.monitoringResult))}}function ve(a,n){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Raw"),t.qZA())}function Ze(a,n){if(1&a&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"value"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,null==e.pval?null:e.pval.rawValue)||"-")}}function Ae(a,n){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Eng"),t.qZA())}function we(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function Pe(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function Se(a,n){if(1&a&&(t.TgZ(0,"app-expirable",31),t._uU(1),t.ALo(2,"value"),t.YNc(3,we,2,0,"span",27),t.YNc(4,Pe,2,0,"span",27),t.qZA()),2&a){const e=t.oxw().$implicit;t.Q6J("pval",e.pval),t.xp6(1),t.hij(" ",t.lcZ(2,4,null==e.pval?null:e.pval.engValue)||"-"," "),t.xp6(2),t.Q6J("ngIf","LOW"===(null==e.pval?null:e.pval.rangeCondition)),t.xp6(1),t.Q6J("ngIf","HIGH"===(null==e.pval?null:e.pval.rangeCondition))}}function Ce(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function De(a,n){if(1&a&&(t.TgZ(0,"td",29),t.YNc(1,Se,5,6,"app-expirable",30),t.YNc(2,Ce,2,0,"span",27),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.pval),t.xp6(1),t.Q6J("ngIf",!e.pval)}}function Ue(a,n){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Reception time"),t.qZA())}function Ne(a,n){if(1&a&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e.pval?null:e.pval.acquisitionTime)||"-","")}}function qe(a,n){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Generation time"),t.qZA())}function ke(a,n){if(1&a&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij("",t.lcZ(2,1,null==e.pval?null:e.pval.generationTime)||"-"," ")}}function Ie(a,n){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Acquisition status"),t.qZA())}function Ye(a,n){if(1&a&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu((null==e.pval?null:e.pval.acquisitionStatus)||"-")}}function Me(a,n){1&a&&t._UZ(0,"th",32)}function Qe(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"td",21),t.TgZ(1,"app-icon-action",33),t.NdJ("click",function(r){const o=t.CHM(e).index;return t.oxw(2).moveDown.emit(o),r.stopPropagation()}),t.qZA(),t.TgZ(2,"app-icon-action",34),t.NdJ("click",function(r){const o=t.CHM(e).index;return t.oxw(2).moveUp.emit(o),r.stopPropagation()}),t.qZA(),t.qZA()}}function Je(a,n){1&a&&t._UZ(0,"tr",35)}function Oe(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"tr",36),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).toggleOne(s.name)}),t.qZA()}if(2&a){const e=n.$implicit,i=t.oxw(2);t.ekj("selected",i.selection.isSelected(e.name))}}function Le(a,n){if(1&a&&(t.TgZ(0,"table",1),t.ynx(1,2),t.YNc(2,ue,2,1,"th",3),t.YNc(3,_e,2,1,"td",4),t.BQk(),t.ynx(4,5),t.YNc(5,ge,2,0,"th",6),t.YNc(6,fe,3,7,"td",7),t.BQk(),t.ynx(7,8),t.YNc(8,xe,2,0,"th",6),t.YNc(9,ye,3,2,"td",4),t.BQk(),t.ynx(10,9),t.YNc(11,ve,2,0,"th",6),t.YNc(12,Ze,3,3,"td",10),t.BQk(),t.ynx(13,11),t.YNc(14,Ae,2,0,"th",6),t.YNc(15,De,3,2,"td",10),t.BQk(),t.ynx(16,12),t.YNc(17,Ue,2,0,"th",6),t.YNc(18,Ne,3,3,"td",4),t.BQk(),t.ynx(19,13),t.YNc(20,qe,2,0,"th",6),t.YNc(21,ke,3,3,"td",4),t.BQk(),t.ynx(22,14),t.YNc(23,Ie,2,0,"th",6),t.YNc(24,Ye,2,1,"td",4),t.BQk(),t.ynx(25,15),t.YNc(26,Me,1,0,"th",16),t.YNc(27,Qe,3,0,"td",4),t.BQk(),t.YNc(28,Je,1,0,"tr",17),t.YNc(29,Oe,1,2,"tr",18),t.qZA()),2&a){const e=t.oxw();t.ekj("paused",e.paused),t.Q6J("dataSource",e.dataSource),t.xp6(28),t.Q6J("cdkHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("cdkRowDefColumns",e.displayedColumns)}}let Re=(()=>{class a{constructor(e,i,r){this.yamcs=e,this.changeDetector=i,this.model={scroll:!1,columns:[],parameters:[]},this.moveUp=new t.vpe,this.moveDown=new t.vpe,this.dataSource=new u.by([]),this.defaultColumns=["severity","name","generationTime","rawValue","engValue","acquisitionStatus"],this.syncSubscription=r.syncFast(()=>{this.paused||this.refreshTable()})}ngOnInit(){this.refreshTable()}refreshTable(){const e=this.model.parameters.map(i=>({name:i}));for(const i of e)i.pval=this.buffer.getLatestValue(i.name);this.dataSource.data=e,this.changeDetector.detectChanges()}ngOnChanges(){this.displayedColumns=this.showActions?["select",...this.defaultColumns,"actions"]:this.defaultColumns}isAllSelected(){const i=this.dataSource.data.length;return this.selection.selected.length===i&&i>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(e=>this.selection.select(e.name))}toggleOne(e){(!this.selection.isSelected(e)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(e)}ngOnDestroy(){this.syncSubscription&&this.syncSubscription.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.C),t.Y36(t.sBO),t.Y36(q.j))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-multiple-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused",selection:"selection"},outputs:{moveUp:"moveUp",moveDown:"moveDown"},features:[t.TTD],decls:1,vars:1,consts:[["mat-table","","class","ya-data-table expand",3,"dataSource","paused",4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","style","text-align: left",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","","style","white-space: nowrap",4,"cdkCellDef"],["cdkColumnDef","severity"],["cdkColumnDef","rawValue"],["mat-cell","","class","wrap200",4,"cdkCellDef"],["cdkColumnDef","engValue"],["cdkColumnDef","receptionTime"],["cdkColumnDef","generationTime"],["cdkColumnDef","acquisitionStatus"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",2,"text-align","left"],["type","checkbox",3,"checked","change"],["mat-cell",""],["type","checkbox",3,"checked","click","change"],["mat-header-cell",""],["mat-cell","",2,"white-space","nowrap"],[3,"routerLink","queryParams"],[3,"level",4,"ngIf"],[4,"ngIf"],[3,"level"],["mat-cell","",1,"wrap200"],[3,"pval",4,"ngIf"],[3,"pval"],["mat-header-cell","",1,"expand"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,i){1&e&&t.YNc(0,Le,30,5,"table",0),2&e&&t.Q6J("ngIf",i.dataSource.data.length)},directives:[_.O5,u.BZ,A.fo,A.D5,u.ge,A.O_,u.ev,y.yS,H.i,B.Y,me.Q,A.s$,u.XQ,A.Sq,u.Gk],pipes:[I.V,P.i],styles:[".paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"]}),a})();var l=p(3075),at=p(8493),D=p(2181),j=p(4834);function Ve(a,n){1&a&&(t.TgZ(0,"th",11),t._uU(1,"Generation time"),t.qZA())}function Fe(a,n){if(1&a&&(t.TgZ(0,"td",12),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.generationTime)||"-")}}function $e(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"app-more"),t.TgZ(1,"button",15),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2).index;return t.oxw(2).moveLeft.emit(r)}),t._uU(2,"Move left"),t.qZA(),t.TgZ(3,"button",15),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2).index;return t.oxw(2).moveRight.emit(r)}),t._uU(4,"Move right"),t.qZA(),t._UZ(5,"mat-divider"),t.TgZ(6,"button",15),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2).$implicit;return t.oxw(2).removeColumn.emit(r)}),t._uU(7,"Remove column"),t.qZA(),t.qZA()}}const Ee=function(a){return["/telemetry/parameters",a]},He=function(a){return{c:a}};function Be(a,n){if(1&a&&(t.TgZ(0,"th",11),t.TgZ(1,"a",14),t._uU(2),t.qZA(),t.YNc(3,$e,8,0,"app-more",1),t.qZA()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("routerLink",t.VKq(4,Ee,e))("queryParams",t.VKq(6,He,i.yamcs.context)),t.xp6(1),t.hij(" ",e," "),t.xp6(1),t.Q6J("ngIf",i.showActions)}}function je(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function ze(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function Ge(a,n){if(1&a&&(t.TgZ(0,"app-expirable",17),t._uU(1),t.ALo(2,"value"),t.YNc(3,je,2,0,"span",1),t.YNc(4,ze,2,0,"span",1),t.qZA()),2&a){const e=t.oxw().ngIf;t.Q6J("pval",e),t.xp6(1),t.hij(" ",t.lcZ(2,4,e.engValue)||"-"," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.rangeCondition)}}function We(a,n){if(1&a&&(t.ynx(0),t.YNc(1,Ge,5,6,"app-expirable",16),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.Q6J("ngIf",e)}}function Xe(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function Ke(a,n){if(1&a&&(t.TgZ(0,"td",12),t.YNc(1,We,2,1,"ng-container",1),t.YNc(2,Xe,2,0,"span",1),t.qZA()),2&a){const e=n.$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.pvals[i]),t.xp6(1),t.Q6J("ngIf",!e.pvals[i])}}function ta(a,n){1&a&&(t.ynx(0,13),t.YNc(1,Be,4,8,"th",4),t.YNc(2,Ke,3,2,"td",5),t.BQk()),2&a&&t.Q6J("cdkColumnDef",n.$implicit)}function ea(a,n){1&a&&t._UZ(0,"th",18)}function aa(a,n){1&a&&t._UZ(0,"td",12)}function ia(a,n){1&a&&t._UZ(0,"tr",19)}function na(a,n){1&a&&t._UZ(0,"tr",20)}function ra(a,n){if(1&a&&(t.TgZ(0,"table",2),t.ynx(1,3),t.YNc(2,Ve,2,0,"th",4),t.YNc(3,Fe,3,3,"td",5),t.BQk(),t.YNc(4,ta,3,1,"ng-container",6),t.ynx(5,7),t.YNc(6,ea,1,0,"th",8),t.YNc(7,aa,1,0,"td",5),t.BQk(),t.YNc(8,ia,1,0,"tr",9),t.YNc(9,na,1,0,"tr",10),t.qZA()),2&a){const e=t.oxw();t.ekj("paused",e.paused),t.Q6J("dataSource",e.dataSource),t.xp6(4),t.Q6J("ngForOf",e.model.parameters),t.xp6(4),t.Q6J("cdkHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("cdkRowDefColumns",e.displayedColumns)}}function sa(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2,"\xa0"),t.qZA(),t._uU(3," Buffer size: "),t.TgZ(4,"select",21),t.TgZ(5,"option",22),t._uU(6,"10"),t.qZA(),t.TgZ(7,"option",23),t._uU(8,"25"),t.qZA(),t.TgZ(9,"option",24),t._uU(10,"50"),t.qZA(),t.TgZ(11,"option",25),t._uU(12,"75"),t.qZA(),t.TgZ(13,"option",26),t._uU(14,"100"),t.qZA(),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("formControl",e.bufferSizeControl)}}let oa=(()=>{class a{constructor(e,i,r){this.yamcs=e,this.changeDetector=i,this.model={scroll:!0,columns:[],parameters:[]},this.removeColumn=new t.vpe,this.moveLeft=new t.vpe,this.moveRight=new t.vpe,this.bufferSize=new t.vpe,this.dataSource=new u.by([]),this.bufferSizeControl=new l.NI("10"),this.displayedColumns=["generationTime","actions"],this.syncSubscription=r.syncFast(()=>{this.paused||this.refreshTable()}),this.bufferSizeControl.valueChanges.subscribe(()=>{const s=this.bufferSizeControl.value;s!==String(this.model.bufferSize)&&this.bufferSize.emit(parseInt(s,10))})}ngOnInit(){this.model.bufferSize&&(this.buffer.setSize(this.model.bufferSize),this.bufferSizeControl.setValue(String(this.model.bufferSize))),this.refreshTable()}refreshTable(){const e=[],i=this.buffer.snapshot();for(const r of i){const s=this.findAnyMatchingParameterValue(r);s&&e.push({generationTime:s.generationTime,pvals:r})}this.dataSource.data=e,this.changeDetector.detectChanges()}findAnyMatchingParameterValue(e){for(const i in e)if(e.hasOwnProperty(i)&&-1!==this.model.parameters.indexOf(i))return e[i]}ngOnChanges(){this.displayedColumns=["generationTime",...this.model.parameters,"actions"]}ngOnDestroy(){this.syncSubscription&&this.syncSubscription.unsubscribe(),this.bufferSizeControlSubscription&&this.bufferSizeControlSubscription.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.C),t.Y36(t.sBO),t.Y36(q.j))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-scrolling-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused"},outputs:{removeColumn:"removeColumn",moveLeft:"moveLeft",moveRight:"moveRight",bufferSize:"bufferSize"},features:[t.TTD],decls:2,vars:2,consts:[["mat-table","","class","ya-data-table expand",3,"dataSource","paused",4,"ngIf"],[4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","generationTime"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],[3,"cdkColumnDef",4,"ngFor","ngForOf"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"cdkColumnDef"],[3,"routerLink","queryParams"],["mat-menu-item","",3,"click"],[3,"pval",4,"ngIf"],[3,"pval"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""],[3,"formControl"],["value","10"],["value","25"],["value","50"],["value","75"],["value","100"]],template:function(e,i){1&e&&(t.YNc(0,ra,10,6,"table",0),t.YNc(1,sa,15,1,"ng-container",1)),2&e&&(t.Q6J("ngIf",i.dataSource.data.length),t.xp6(1),t.Q6J("ngIf",i.showActions))},directives:[_.O5,u.BZ,A.fo,A.D5,u.ge,A.O_,u.ev,_.sg,y.yS,at.T,D.OP,j.d,B.Y,A.s$,u.XQ,A.Sq,u.Gk,l.EJ,l.JJ,l.oH,l.YN,l.Kr],pipes:[P.i,I.V],styles:[".paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"]}),a})();var z=p(5632);function la(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"app-multiple-parameter-table",6),t.NdJ("moveUp",function(r){return t.CHM(e),t.oxw(3).moveUp(r)})("moveDown",function(r){return t.CHM(e),t.oxw(3).moveDown(r)}),t.ALo(1,"async"),t.ALo(2,"async"),t.qZA()}if(2&a){const e=t.oxw(2).ngIf,i=t.oxw();t.Q6J("model",e)("buffer",i.buffer)("paused",t.lcZ(1,5,i.paused$))("showActions",t.lcZ(2,7,i.showActions$))("selection",i.selection)}}function ca(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"app-scrolling-parameter-table",7),t.NdJ("moveLeft",function(r){return t.CHM(e),t.oxw(3).moveUp(r)})("moveRight",function(r){return t.CHM(e),t.oxw(3).moveDown(r)})("removeColumn",function(r){return t.CHM(e),t.oxw(3).removeParameter(r)})("bufferSize",function(r){return t.CHM(e),t.oxw(3).setBufferSize(r)}),t.ALo(1,"async"),t.ALo(2,"async"),t.qZA()}if(2&a){const e=t.oxw(2).ngIf,i=t.oxw();t.Q6J("model",e)("buffer",i.buffer)("paused",t.lcZ(1,4,i.paused$))("showActions",t.lcZ(2,6,i.showActions$))}}function pa(a,n){if(1&a&&(t.ynx(0),t.YNc(1,la,3,9,"app-multiple-parameter-table",4),t.YNc(2,ca,3,8,"app-scrolling-parameter-table",5),t.BQk()),2&a){const e=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",!e.scroll),t.xp6(1),t.Q6J("ngIf",e.scroll)}}function ma(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"app-empty-message"),t.TgZ(1,"div",8),t.TgZ(2,"p"),t._uU(3," This file is empty. "),t._UZ(4,"br"),t._uU(5,"Start by "),t.TgZ(6,"a",9),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).showAddParameterDialog()}),t._uU(7,"adding a parameter"),t.qZA(),t._uU(8,". "),t.qZA(),t.qZA(),t.qZA()}}function ua(a,n){if(1&a&&(t.TgZ(0,"div",1),t.YNc(1,pa,3,2,"ng-container",2),t.YNc(2,ma,9,0,"ng-template",null,3,t.W1O),t.qZA()),2&a){const e=n.ngIf,i=t.MAs(3);t.xp6(1),t.Q6J("ngIf",e.parameters.length)("ngIfElse",i)}}let xt=(()=>{class a{constructor(e,i,r,s){this.yamcs=e,this.changeDetector=i,this.dialog=r,this.configService=s,this.selection=new k.Ov(!0,[]),this.model$=new T.X(null),this.buffer=new pe,this.paused$=new T.X(!1),this.hasUnsavedChanges$=new T.X(!1),this.showActions$=new T.X(!1),this.storageClient=e.createStorageClient()}init(e){return this.objectName=e,this.storageClient.getObject("_global","displays",e).then(i=>{i.text().then(r=>{const s=JSON.parse(r);this.model$.next(s),this.createOrModifySubscription()})}),Promise.resolve()}setEnableActions(){this.showActions$.next(!0)}hasPendingChanges(){return this.hasUnsavedChanges$.value}createOrModifySubscription(){const e=this.model$.value.parameters.map(i=>({name:i}));e.length&&(this.dataSubscription?this.dataSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:e,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"}):this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:e,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},i=>{i.mapping&&(this.idMapping=i.mapping),this.buffer.push(i.values||[],this.idMapping)}))}addParameter(e){const i=this.model$.value;i.parameters.push(e),this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0),this.createOrModifySubscription()}emitModelUpdate(e){this.model$.next({scroll:e.scroll,bufferSize:e.bufferSize||10,columns:e.columns,parameters:e.parameters})}getModel(){return this.model$.value}pause(){this.paused$.next(!0)}unpause(){this.paused$.next(!1)}delete(){if(!this.selection.isEmpty()){const e=this.model$.value;e.parameters=e.parameters.filter(i=>!this.selection.isSelected(i)),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}this.selection.clear()}enableScrollView(){this.selection.clear();const e=this.model$.value;e.scroll=!0,this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}enableStandardView(){this.selection.clear();const e=this.model$.value;e.scroll=!1,this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}removeParameter(e){const i=this.model$.value;i.parameters=i.parameters.filter(r=>r!==e),this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}moveUp(e){const i=this.model$.value,r=i.parameters[e];0===e?(i.parameters[e]=i.parameters[i.parameters.length-1],i.parameters[i.parameters.length-1]=r):(i.parameters[e]=i.parameters[e-1],i.parameters[e-1]=r),this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}moveDown(e){const i=this.model$.value,r=i.parameters[e];e===i.parameters.length-1?(i.parameters[e]=i.parameters[0],i.parameters[0]=r):(i.parameters[e]=i.parameters[e+1],i.parameters[e+1]=r),this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}setBufferSize(e){this.buffer.setSize(e);const i=this.model$.value;i.bufferSize=e,this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}save(){const i=new Blob([JSON.stringify(this.model$.value,void 0,2)]);return this.storageClient.uploadObject("_global","displays",this.objectName,i).then(()=>{this.hasUnsavedChanges$.next(!1)})}showAddParameterDialog(){this.dialog.open(ft.M,{width:"500px",data:{okLabel:"ADD",exclude:this.getModel().parameters}}).afterClosed().subscribe(i=>{i&&this.addParameter(i)})}ngOnDestroy(){this.dataSubscription&&this.dataSubscription.cancel()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.C),t.Y36(t.sBO),t.Y36(g.uw),t.Y36(J.E))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-parameter-table-viewer"]],decls:2,vars:3,consts:[["class","panel-content",4,"ngIf"],[1,"panel-content"],[4,"ngIf","ngIfElse"],["empty",""],[3,"model","buffer","paused","showActions","selection","moveUp","moveDown",4,"ngIf"],[3,"model","buffer","paused","showActions","moveLeft","moveRight","removeColumn","bufferSize",4,"ngIf"],[3,"model","buffer","paused","showActions","selection","moveUp","moveDown"],[3,"model","buffer","paused","showActions","moveLeft","moveRight","removeColumn","bufferSize"],[2,"text-align","left"],[1,"ya-link",2,"cursor","pointer",3,"click"]],template:function(e,i){1&e&&(t.YNc(0,ua,4,2,"div",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,i.model$))},directives:[_.O5,Re,oa,z.M],pipes:[_.Ov],styles:[".panel-content[_ngcontent-%COMP%]{position:relative;overflow:auto}"],changeDetection:0}),a})();var G=p(1731),Y=p(4071),M=p(141),Tt=p(43);let _a=(()=>{class a{constructor(e,i,r){this.dialogRef=e,this.yamcs=i,this.data=r,this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}],this.downloadURL$=new T.X(null),this.form=new l.cw({start:new l.NI(null),stop:new l.NI(null),delimiter:new l.NI(null,l.kI.required)});let s=r.start,o=r.stop;(!s||!o)&&(o=i.getMissionTime(),s=(0,h.rV)(o,"PT1H")),this.form.setValue({start:h.Y6(s),stop:h.Y6(o),delimiter:"TAB"}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){const e={parameters:this.data.parameterIds,delimiter:this.form.value.delimiter};this.form.value.start&&(e.start=h.Y6(this.form.value.start)),this.form.value.stop&&(e.stop=h.Y6(this.form.value.stop));const i=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,e);this.downloadURL$.next(i)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription&&this.formChangeSubscription.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(g.so),t.Y36(Z.C),t.Y36(g.WI))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-export-archive-data-dialog"]],decls:22,vars:7,consts:[["mat-dialog-title",""],[1,"mat-typography","ya-form"],[3,"formGroup"],["formControlName","start"],["formControlName","stop"],["formControlName","delimiter",3,"options"],["align","end"],["mat-dialog-close","",1,"ya-button"],[3,"link","primary","disabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Export archive data"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.TgZ(3,"form",2),t.TgZ(4,"label"),t._uU(5," Start "),t._UZ(6,"app-date-time-input",3),t.qZA(),t._UZ(7,"br"),t.TgZ(8,"label"),t._uU(9," Stop "),t._UZ(10,"app-date-time-input",4),t.qZA(),t._UZ(11,"br"),t.TgZ(12,"label"),t._uU(13," CSV column delimiter"),t._UZ(14,"br"),t._UZ(15,"app-select",5),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"mat-dialog-actions",6),t.TgZ(17,"button",7),t._uU(18,"CANCEL"),t.qZA(),t.TgZ(19,"app-download-button",8),t.NdJ("click",function(){return i.closeDialog()}),t.ALo(20,"async"),t._uU(21," DOWNLOAD "),t.qZA(),t.qZA()),2&e&&(t.xp6(3),t.Q6J("formGroup",i.form),t.xp6(12),t.Q6J("options",i.delimiterOptions),t.xp6(4),t.Q6J("link",t.lcZ(20,5,i.downloadURL$))("primary",!0)("disabled",!i.form.valid))},directives:[g.uh,g.xY,l._Y,l.JL,l.sg,Y.Y,l.JJ,l.u,M.P,g.H8,g.ZT,Tt.o],pipes:[_.Ov],encapsulation:2}),a})();var ga=p(7261),it=p(7238);function da(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).save()}),t.ALo(1,"async"),t.TgZ(2,"mat-icon"),t._uU(3,"save"),t.qZA(),t._uU(4," SAVE "),t.qZA()}if(2&a){const e=t.oxw(3);t.Q6J("disabled",!t.lcZ(1,1,e.viewer.hasUnsavedChanges$))}}function ha(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).viewer.pause()}),t.TgZ(1,"mat-icon"),t._uU(2,"pause"),t.qZA(),t._uU(3," PAUSE "),t.qZA()}}function fa(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).viewer.unpause()}),t.TgZ(1,"mat-icon"),t._uU(2,"play_arrow"),t.qZA(),t._uU(3," UNPAUSE "),t.qZA()}}function xa(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).viewer.delete()}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA(),t._uU(3," DELETE "),t.qZA()}if(2&a){const e=t.oxw(3);t.Q6J("disabled",e.viewer.selection.isEmpty())}}function Ta(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).viewer.enableScrollView()}),t.TgZ(1,"mat-icon",13),t._uU(2,"view_headline"),t.qZA(),t._uU(3," SCROLL VIEW "),t.qZA()}}function ba(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).viewer.enableStandardView()}),t.TgZ(1,"mat-icon"),t._uU(2,"view_headline"),t.qZA(),t._uU(3," STANDARD VIEW "),t.qZA()}}function ya(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.YNc(1,da,5,3,"button",1),t.YNc(2,ha,4,0,"button",2),t.ALo(3,"async"),t.YNc(4,fa,4,0,"button",3),t.ALo(5,"async"),t.TgZ(6,"button",4),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).addParameter()}),t.TgZ(7,"mat-icon"),t._uU(8,"playlist_add"),t.qZA(),t._uU(9," ADD "),t.qZA(),t.YNc(10,xa,4,1,"button",1),t.YNc(11,Ta,4,0,"button",5),t.YNc(12,ba,4,0,"button",5),t.TgZ(13,"mat-menu",6,7),t.TgZ(15,"button",8),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).exportArchiveData()}),t._uU(16," Export archive data... "),t.qZA(),t.qZA(),t.TgZ(17,"button",9),t.NdJ("click",function(r){return r.stopPropagation()}),t.TgZ(18,"mat-icon"),t._uU(19,"more_vert"),t.qZA(),t.qZA(),t.BQk()}if(2&a){const e=n.ngIf,i=t.MAs(14),r=t.oxw(2);t.xp6(1),t.Q6J("ngIf",r.mayManageDisplays()),t.xp6(1),t.Q6J("ngIf",!t.lcZ(3,8,r.viewer.paused$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(5,10,r.viewer.paused$)),t.xp6(6),t.Q6J("ngIf",!e.scroll),t.xp6(1),t.Q6J("ngIf",!e.scroll),t.xp6(1),t.Q6J("ngIf",e.scroll),t.xp6(3),t.Q6J("disabled",!e.parameters.length),t.xp6(2),t.Q6J("matMenuTriggerFor",i)}}function va(a,n){if(1&a&&(t.ynx(0),t.YNc(1,ya,20,12,"ng-container",0),t.ALo(2,"async"),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,e.viewer.model$))}}let bt=(()=>{class a{constructor(e,i,r){this.dialog=e,this.snackbar=i,this.authService=r,this.initialized$=new T.X(!1)}init(e){this.viewer=e,this.initialized$.next(!0)}addParameter(){this.dialog.open(ft.M,{width:"500px",data:{okLabel:"ADD",exclude:this.viewer.getModel().parameters}}).afterClosed().subscribe(i=>{i&&this.viewer.addParameter(i)})}mayManageDisplays(){const e=this.authService.getUser();return e.hasObjectPrivilege("ManageBucket","displays")||e.hasSystemPrivilege("ManageAnyBucket")}save(){this.viewer.save().then(()=>{this.snackbar.open("Changes saved",void 0,{duration:1e3})}).catch(e=>{this.snackbar.open("Failed to save changes: "+e)})}exportArchiveData(){let e=this.viewer.selection.selected;e.length||(e=this.viewer.getModel().parameters),this.dialog.open(_a,{width:"400px",data:{parameterIds:e}})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(g.uw),t.Y36(ga.ux),t.Y36(G.e))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-parameter-table-viewer-controls"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-button","","color","primary","matTooltip","Pause value updates",3,"click",4,"ngIf"],["mat-button","","color","primary","matTooltip","Unpause value updates",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"click"],["mat-button","","color","primary",3,"click",4,"ngIf"],["overlapTrigger","false"],["moreMenu","matMenu"],["mat-menu-item","",3,"disabled","click"],["mat-button","",3,"matMenuTriggerFor","click"],["mat-button","","color","primary",3,"disabled","click"],["mat-button","","color","primary","matTooltip","Pause value updates",3,"click"],["mat-button","","color","primary","matTooltip","Unpause value updates",3,"click"],[2,"transform","rotate(90deg)"]],template:function(e,i){1&e&&(t.YNc(0,va,3,3,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,i.initialized$))},directives:[_.O5,C.lW,S.Hw,it.gM,D.VK,D.OP,D.p6],pipes:[_.Ov],encapsulation:2}),a})();var yt=p(8875);p(4495),p(3189),p(2830);const Za=["scriptContainer"];let vt=(()=>{class a{constructor(e,i){this.changeDetector=i,this.storageClient=e.createStorageClient()}init(e){return this.storageClient.getObject("_global","displays",e).then(i=>{i.text().then(r=>{this.scriptContainer.nativeElement.innerHTML=r,this.editor=yt.edit(this.scriptContainer.nativeElement),this.editor.setReadOnly(!0),this.editor.getSession().setMode("ace/mode/javascript"),this.changeDetector.detectChanges()})}),this.editor.setTheme("ace/theme/eclipse"),Promise.resolve()}hasPendingChanges(){return!1}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.C),t.Y36(t.sBO))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-script-viewer"]],viewQuery:function(e,i){if(1&e&&t.Gf(Za,7),2&e){let r;t.iGM(r=t.CRH())&&(i.scriptContainer=r.first)}},decls:2,vars:0,consts:[[1,"script-container"],["scriptContainer",""]],template:function(e,i){1&e&&t._UZ(0,"div",0,1)},styles:[".script-container[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),a})();function Aa(a,n){if(1&a&&(t.TgZ(0,"pre"),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Oqu(e.text)}}let Zt=(()=>{class a{constructor(e,i){this.changeDetector=i,this.storageClient=e.createStorageClient()}init(e){return this.storageClient.getObject("_global","displays",e).then(i=>{i.text().then(r=>{this.text=r,this.changeDetector.detectChanges()})}),Promise.resolve()}hasPendingChanges(){return!1}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.C),t.Y36(t.sBO))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-text-viewer"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(e,i){1&e&&t.YNc(0,Aa,2,1,"pre",0),2&e&&t.Q6J("ngIf",i.text)},directives:[_.O5],styles:["pre[_ngcontent-%COMP%]{margin:1em}"],changeDetection:0}),a})(),nt=(()=>{class a{constructor(e){this.viewContainerRef=e}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(t.s_b))},a.\u0275dir=t.lG2({type:a,selectors:[["","app-viewer-controls-host",""]]}),a})(),rt=(()=>{class a{constructor(e){this.viewContainerRef=e}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(t.s_b))},a.\u0275dir=t.lG2({type:a,selectors:[["","app-viewer-host",""]]}),a})(),At=(()=>{class a{transform(e){if(!e)return null;const i=e.toLowerCase();return i.endsWith(".opi")?"Operator Interface":i.endsWith(".par")?"Parameter Table":i.endsWith(".js")?"Script File":-1!==i.indexOf(".")?i.substr(i.lastIndexOf(".")+1).toUpperCase()+" File":null}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275pipe=t.Yjl({name:"displayType",type:a,pure:!0}),a})(),wt=(()=>{class a{constructor(e){this.yamcs=e}transform(e){return e?this.yamcs.yamcsClient.getPacketDownloadURL(this.yamcs.instance,e.generationTime,e.sequenceNumber):null}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.C,16))},a.\u0275pipe=t.Yjl({name:"packetDownloadLink",type:a,pure:!0}),a})();var wa=p(7309),Pt=p(4375),Pa=p(9326),St=p(9300),O=p(2313),L=p(8928),R=p(9140);const Sa=["viewerContainer"];function Ca(a,n){}function Da(a,n){}const Ua=function(a){return{c:a}};let Ct=(()=>{class a{constructor(e,i,r,s,o){this.yamcs=e,this.route=i,this.title=s,this.folderPerInstance=o.getConfig().displayFolderPerInstance;const c=this.getObjectNameFromUrl();this.loadFile(c),this.routerSubscription=r.events.pipe((0,St.h)(m=>m instanceof y.m2)).subscribe(()=>{const m=this.getObjectNameFromUrl();m!==this.objectName&&this.loadFile(m,!0)})}getObjectNameFromUrl(){const e=this.route.snapshot.url;let i="";this.folderPerInstance&&(i+=this.yamcs.instance);for(const r of e)i&&(i+="/"),i+=r.path;return i}getNameWithoutInstance(e){return this.folderPerInstance?e.substr(this.yamcs.instance.length):e}loadFile(e,i=!1){this.objectName=e;const r=this.objectName.lastIndexOf("/");if(-1===r)this.folderLink="/telemetry/displays/browse/",this.filename=this.objectName;else{const s=this.getNameWithoutInstance(this.objectName.substring(0,r));this.folderLink="/telemetry/displays/browse/"+s,this.filename=this.objectName.substring(r+1)}this.title.setTitle(this.filename),i&&this.ngAfterViewInit()}ngAfterViewInit(){if(this.filename.toLowerCase().endsWith(".opi")){const e=this.createViewer(dt);e.setViewerContainerEl(this.viewerContainer.nativeElement),this.createViewerControls(ht).init(e),this.viewer=e}else if(this.filename.toLowerCase().endsWith(".par")){const e=this.createViewer(xt);this.createViewerControls(bt).init(e),e.setEnableActions(),this.viewer=e}else this.viewer=this.isImage()?this.createViewer(gt):this.filename.toLocaleLowerCase().endsWith(".js")?this.createViewer(vt):this.createViewer(Zt);this.viewer.init(this.objectName)}createViewer(e){const i=this.viewerHost.viewContainerRef;return i.clear(),i.createComponent(e).instance}createViewerControls(e){const i=this.controlsHost.viewContainerRef;return i.clear(),i.createComponent(e).instance}isImage(){const e=this.filename.toLowerCase();return e.endsWith(".png")||e.endsWith(".gif")||e.endsWith(".jpg")||e.endsWith("jpeg")||e.endsWith("bmp")}hasPendingChanges(){return this.viewer.hasPendingChanges()}ngOnDestroy(){this.routerSubscription&&this.routerSubscription.unsubscribe(),this.syncSubscription&&this.syncSubscription.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.C),t.Y36(y.gz),t.Y36(y.F0),t.Y36(O.Dx),t.Y36(J.E))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(e,i){if(1&e&&(t.Gf(nt,5),t.Gf(Sa,5),t.Gf(rt,5)),2&e){let r;t.iGM(r=t.CRH())&&(i.controlsHost=r.first),t.iGM(r=t.CRH())&&(i.viewerContainer=r.first),t.iGM(r=t.CRH())&&(i.viewerHost=r.first)}},decls:10,vars:5,consts:[["mat-icon-button","","color","primary",3,"routerLink","queryParams"],["app-viewer-controls-host",""],[2,"height","100%","width","100%"],["viewerContainer",""],["app-viewer-host",""]],template:function(e,i){1&e&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar"),t.TgZ(2,"a",0),t.TgZ(3,"mat-icon"),t._uU(4,"arrow_back"),t.qZA(),t.qZA(),t._uU(5),t.YNc(6,Ca,0,0,"ng-template",1),t.qZA(),t.TgZ(7,"div",2,3),t.YNc(9,Da,0,0,"ng-template",4),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("routerLink",i.folderLink)("queryParams",t.VKq(3,Ua,i.yamcs.context)),t.xp6(3),t.hij(" ",i.filename," \xa0\xa0\xa0 "))},directives:[L.a,R.k,C.zs,y.yS,S.Hw,nt,rt],encapsulation:2,changeDetection:0}),a})();var Dt=p(8306),Na=p(9646);let qa=(()=>{class a{constructor(e){this.dialogRef=e}confirmDiscard(){this.dialogRef.close(!0)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(g.so))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-display-file-page-dirty-dialog"]],decls:8,vars:0,consts:[[1,"mat-typography"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"mat-dialog-content",0),t.TgZ(1,"p"),t._uU(2,"You have unsaved changes on the current page. Do you want to discard them?"),t.qZA(),t.qZA(),t.TgZ(3,"mat-dialog-actions",1),t.TgZ(4,"button",2),t._uU(5,"CANCEL"),t.qZA(),t.TgZ(6,"button",3),t.NdJ("click",function(){return i.confirmDiscard()}),t._uU(7," DISCARD "),t.qZA(),t.qZA())},directives:[g.xY,g.H8,g.ZT],encapsulation:2}),a})(),Ut=(()=>{class a{constructor(e,i){this.dialog=e,this.authService=i,this.dialogOpen$=new T.X(!1)}canDeactivate(e){return this.dialogOpen$.value?Dt.y.create(i=>{this.dialogRef.afterClosed().subscribe(r=>{i.next(r),i.complete()},r=>{i.next(!1),i.complete()})}):e.hasPendingChanges()&&this.mayManageDisplays()?Dt.y.create(i=>{this.dialogOpen$.next(!0),this.dialogRef=this.dialog.open(qa,{width:"400px"}),this.dialogRef.afterClosed().subscribe(r=>{this.dialogOpen$.next(!1),i.next(r),i.complete()},r=>{this.dialogOpen$.next(!1),i.next(!1),i.complete()})}):(0,Na.of)(!0)}mayManageDisplays(){const e=this.authService.getUser();return e.hasObjectPrivilege("ManageBucket","displays")||e.hasSystemPrivilege("ManageAnyBucket")}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(g.uw),t.LFG(G.e))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac}),a})();var ka=p(3043);const Ia=["filename"];function Ya(a,n){if(1&a&&(t.TgZ(0,"form",7),t.TgZ(1,"label"),t._uU(2," Type "),t.TgZ(3,"select",8),t.TgZ(4,"option",9),t._uU(5,"Parameter Table"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&a){const e=t.oxw();t.Q6J("formGroup",e.typeForm)}}function Ma(a,n){1&a&&(t.TgZ(0,"span",14),t._uU(1,"File name must end with "),t.TgZ(2,"code"),t._uU(3,".par"),t.qZA(),t.qZA())}function Qa(a,n){if(1&a&&(t.TgZ(0,"form",7),t.TgZ(1,"label"),t._uU(2," Name "),t._UZ(3,"input",10,11),t.YNc(5,Ma,4,0,"span",12),t.qZA(),t._UZ(6,"br"),t.TgZ(7,"label"),t._uU(8," Path "),t._UZ(9,"input",13),t.qZA(),t.qZA()),2&a){const e=t.oxw();let i,r;t.Q6J("formGroup",e.filenameForm),t.xp6(1),t.ekj("invalid",null==(i=e.filenameForm.get("name"))?null:i.invalid),t.xp6(4),t.Q6J("ngIf",null==(r=e.filenameForm.get("name"))?null:r.invalid)}}function Ja(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){return t.CHM(e),t.oxw().selectType()}),t._uU(1,"NEXT \xbb"),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("disabled",!e.typeForm.valid)}}function Oa(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){return t.CHM(e),t.oxw().save()}),t._uU(1,"SAVE"),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("disabled",!e.filenameForm.valid)}}let La=(()=>{class a{constructor(e,i,r,s,o){this.dialogRef=e,this.data=s,this.changeDetector=o,this.page=1,this.storageClient=r.createStorageClient(),this.typeForm=i.group({type:["par",l.kI.required]}),this.filenameForm=i.group({path:[s.path,l.kI.required],name:["",[l.kI.required,l.kI.pattern(/.*\.par/i)]]})}selectType(){const e=this.typeForm.value.type;this.filenameForm.get("name").setValue(`NewFile.${e}`),this.page=2,this.changeDetector.detectChanges(),this.filenameInput.nativeElement.select()}save(){let e=this.filenameForm.get("path").value.trim();const i=this.filenameForm.get("name").value.trim();e.startsWith("/")&&(e=e.substring(1)),e.endsWith("/")&&(e=e.substring(0,e.length-1));const r=e?e+"/"+i:i,o=new Blob([JSON.stringify({scroll:!1,parameters:[]},void 0,2)],{type:"application/json"});this.storageClient.uploadObject("_global","displays",this.data.prefix+r,o).then(()=>{this.dialogRef.close(r)})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(g.so),t.Y36(l.qu),t.Y36(Z.C),t.Y36(g.WI),t.Y36(t.sBO))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-create-display-dialog"]],viewQuery:function(e,i){if(1&e&&t.Gf(Ia,5),2&e){let r;t.iGM(r=t.CRH())&&(i.filenameInput=r.first)}},decls:10,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],["class","ya-form",3,"formGroup",4,"ngIf"],["align","end"],["mat-dialog-close","",1,"ya-button"],["class","ya-button",3,"disabled","click",4,"ngIf"],["class","ya-button primary",3,"disabled","click",4,"ngIf"],[1,"ya-form",3,"formGroup"],["formControlName","type"],["value","par"],["type","text","formControlName","name"],["filename",""],["class","error-message",4,"ngIf"],["type","text","formControlName","path"],[1,"error-message"],[1,"ya-button",3,"disabled","click"],[1,"ya-button","primary",3,"disabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Create display"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.YNc(3,Ya,6,1,"form",2),t.YNc(4,Qa,10,4,"form",2),t.qZA(),t.TgZ(5,"mat-dialog-actions",3),t.TgZ(6,"button",4),t._uU(7,"CANCEL"),t.qZA(),t.YNc(8,Ja,2,1,"button",5),t.YNc(9,Oa,2,1,"button",6),t.qZA()),2&e&&(t.xp6(3),t.Q6J("ngIf",1===i.page),t.xp6(1),t.Q6J("ngIf",2===i.page),t.xp6(4),t.Q6J("ngIf",1===i.page),t.xp6(1),t.Q6J("ngIf",2===i.page))},directives:[g.uh,g.xY,_.O5,l._Y,l.JL,l.sg,l.EJ,l.JJ,l.u,l.YN,l.Kr,l.Fj,g.H8,g.ZT],encapsulation:2}),a})(),Ra=(()=>{class a{constructor(e,i,r,s){this.dialogRef=e,this.data=s,this.storageClient=r.createStorageClient(),this.form=i.group({name:["",l.kI.required]})}save(){let{path:e,bucketInstance:i,bucket:r}=this.data;e.startsWith("/")&&(e=e.substring(1));const s=this.form.value.name;this.storageClient.uploadObject(i,r,e?`${e}/${s}/`:`${s}/`,new Blob).then(()=>this.dialogRef.close(!0))}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(g.so),t.Y36(l.qu),t.Y36(Z.C),t.Y36(g.WI))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:12,vars:2,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name","pattern","\\w[\\w\\s\\.\\-\\(\\)\\[\\]]*"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Create folder"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.TgZ(3,"form",2),t.TgZ(4,"label"),t._uU(5," Folder name "),t._UZ(6,"input",3),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"mat-dialog-actions",4),t.TgZ(8,"button",5),t._uU(9,"CANCEL"),t.qZA(),t.TgZ(10,"button",6),t.NdJ("click",function(){return i.save()}),t._uU(11,"CREATE"),t.qZA(),t.qZA()),2&e&&(t.xp6(3),t.Q6J("formGroup",i.form),t.xp6(7),t.Q6J("disabled",!i.form.valid))},directives:[g.uh,g.xY,l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,l.c5,g.H8,g.ZT],encapsulation:2,changeDetection:0}),a})();var st=p(7365);let Fa=(()=>{class a{constructor(e,i,r,s,o,c){this.dialogRef=e,this.data=c,this.storageClient=r.createStorageClient();const m=o.transform(this.data.name);this.filenameForm=i.group({name:[m,[l.kI.required]]})}rename(){return function(a,n,e,i){return new(e||(e=Promise))(function(s,o){function c(d){try{x(i.next(d))}catch(b){o(b)}}function m(d){try{x(i.throw(d))}catch(b){o(b)}}function x(d){d.done?s(d.value):function r(s){return s instanceof e?s:new e(function(o){o(s)})}(d.value).then(c,m)}x((i=i.apply(a,n||[])).next())})}(this,void 0,void 0,function*(){let e;const i=this.data.name.lastIndexOf("/");-1!==i&&(e=this.data.name.substring(0,i+1));const s=yield(yield this.storageClient.getObject("_global","displays",this.data.name)).blob(),o=(e||"")+this.filenameForm.get("name").value;yield this.storageClient.uploadObject("_global","displays",o,s),yield this.storageClient.deleteObject("_global","displays",this.data.name),this.dialogRef.close(o)})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(g.so),t.Y36(l.qu),t.Y36(Z.C),t.Y36(J.E),t.Y36(st.X),t.Y36(g.WI))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-rename-display-dialog"]],decls:13,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name"],["filename",""],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(e,i){if(1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Rename file"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.TgZ(3,"form",2),t.TgZ(4,"label"),t._uU(5," Name "),t._UZ(6,"input",3,4),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"mat-dialog-actions",5),t.TgZ(9,"button",6),t._uU(10,"CANCEL"),t.qZA(),t.TgZ(11,"button",7),t.NdJ("click",function(){return i.rename()}),t._uU(12,"RENAME"),t.qZA(),t.qZA()),2&e){let r;t.xp6(3),t.Q6J("formGroup",i.filenameForm),t.xp6(1),t.ekj("invalid",null==(r=i.filenameForm.get("name"))?null:r.invalid),t.xp6(7),t.Q6J("disabled",!i.filenameForm.valid)}},directives:[g.uh,g.xY,l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,g.H8,g.ZT],encapsulation:2}),a})();var Nt=p(4298),qt=p(1821);const $a=["droparea"],Ea=["uploader"];function Ha(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().createDisplay()}),t.TgZ(1,"mat-icon"),t._uU(2,"add_circle_outline"),t.qZA(),t._uU(3," CREATE DISPLAY "),t.qZA()}}function Ba(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){return t.CHM(e),t.MAs(5).click()}),t.TgZ(1,"mat-icon"),t._uU(2,"file_upload"),t.qZA(),t._uU(3," UPLOAD FILES "),t.TgZ(4,"input",10,11),t.NdJ("change",function(){return t.CHM(e),t.oxw().uploadFiles()}),t.qZA(),t.qZA()}}function ja(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().createFolder()}),t.TgZ(1,"mat-icon"),t._uU(2,"create_new_folder"),t.qZA(),t._uU(3," CREATE FOLDER "),t.qZA()}}function za(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().deleteSelectedDisplays()}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA(),t._uU(3," DELETE "),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("disabled",!e.selection.hasValue())}}const W=function(a){return{c:a}};function Ga(a,n){if(1&a&&t._UZ(0,"app-breadcrumb",15),2&a){const e=n.$implicit,i=t.oxw(3);t.Q6J("link",e.route)("queryParams",t.VKq(3,W,i.yamcs.context))("label",e.name)}}function Wa(a,n){if(1&a&&(t.TgZ(0,"app-breadcrumb-trail"),t._UZ(1,"app-breadcrumb",13),t.YNc(2,Ga,1,5,"app-breadcrumb",14),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.xp6(1),t.Q6J("queryParams",t.VKq(2,W,i.yamcs.context)),t.xp6(1),t.Q6J("ngForOf",e)}}function Xa(a,n){if(1&a&&(t.ynx(0),t.YNc(1,Wa,3,4,"app-breadcrumb-trail",6),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.Q6J("ngIf",e.length)}}function Ka(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"input",33),t.NdJ("change",function(r){t.CHM(e);const s=t.oxw(3);return r?s.masterToggle():null}),t.qZA()}if(2&a){const e=t.oxw(3);t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())}}function ti(a,n){if(1&a&&(t.TgZ(0,"th",31),t.YNc(1,Ka,1,1,"input",32),t.qZA()),2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.mayManageDisplays())}}function ei(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"input",36),t.NdJ("click",function(r){return r.stopPropagation()})("change",function(r){t.CHM(e);const s=t.oxw().$implicit,o=t.oxw(2);return r?o.selection.toggle(s):null}),t.qZA()}if(2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.Q6J("checked",i.selection.isSelected(e))}}function ai(a,n){if(1&a&&(t.TgZ(0,"td",34),t.YNc(1,ei,1,1,"input",35),t.qZA()),2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.mayManageDisplays())}}function ii(a,n){1&a&&(t.TgZ(0,"th",37),t._uU(1,"Name"),t.qZA())}function ni(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",39),t._uU(2,"folder"),t.qZA(),t.TgZ(3,"a",40),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(4),t.ALo(5,"filename"),t.qZA(),t.BQk()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(3),t.Q6J("routerLink","/telemetry/displays/browse/"+e.nameWithoutInstance)("queryParams",t.VKq(5,W,i.yamcs.context)),t.xp6(1),t.hij(" ",t.lcZ(5,3,e.name)," ")}}function ri(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",39),t._uU(2,"description"),t.qZA(),t.TgZ(3,"a",40),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(4),t.ALo(5,"filename"),t.qZA(),t.BQk()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(3),t.Q6J("routerLink","/telemetry/displays/files/"+e.nameWithoutInstance)("queryParams",t.VKq(5,W,i.yamcs.context)),t.xp6(1),t.hij(" ",t.lcZ(5,3,e.name)," ")}}function si(a,n){if(1&a&&(t.TgZ(0,"td",38),t.YNc(1,ni,6,7,"ng-container",6),t.YNc(2,ri,6,7,"ng-container",6),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.folder),t.xp6(1),t.Q6J("ngIf",!e.folder)}}function oi(a,n){1&a&&(t.TgZ(0,"th",37),t._uU(1,"Type"),t.qZA())}function li(a,n){1&a&&(t.ynx(0),t._uU(1,"Folder"),t.BQk())}function ci(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"displayType"),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.name)||"-"," ")}}function pi(a,n){if(1&a&&(t.TgZ(0,"td",38),t.YNc(1,li,2,0,"ng-container",6),t.YNc(2,ci,3,3,"ng-container",6),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.folder),t.xp6(1),t.Q6J("ngIf",!e.folder)}}function mi(a,n){1&a&&(t.TgZ(0,"th",37),t._uU(1,"Visibility"),t.qZA())}function ui(a,n){1&a&&(t.TgZ(0,"td",38),t._uU(1," Private "),t.qZA())}function _i(a,n){1&a&&(t.TgZ(0,"th",37),t._uU(1,"Date modified"),t.qZA())}function gi(a,n){if(1&a&&(t.TgZ(0,"td",38),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.modified)||"-"," ")}}function di(a,n){1&a&&t._UZ(0,"th",41)}function hi(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"app-more"),t.TgZ(1,"button",42),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2).$implicit;return t.oxw(2).renameFile(r)}),t._uU(2," Rename "),t.qZA(),t.TgZ(3,"a",43),t._uU(4," Download "),t.qZA(),t._UZ(5,"mat-divider"),t.TgZ(6,"button",42),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2).$implicit;return t.oxw(2).deleteFile(r)}),t._uU(7," Delete "),t.qZA(),t.qZA()}if(2&a){const e=t.oxw(2).$implicit;t.xp6(3),t.Q6J("href",e.objectUrl,t.LSH)}}function fi(a,n){if(1&a&&(t.ynx(0),t.YNc(1,hi,8,1,"app-more",6),t.BQk()),2&a){const e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",e.mayManageDisplays())}}function xi(a,n){if(1&a&&(t.TgZ(0,"td",38),t.YNc(1,fi,2,1,"ng-container",6),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",!e.folder)}}function Ti(a,n){1&a&&t._UZ(0,"tr",44)}function bi(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"tr",45),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).toggleOne(s)}),t.qZA()}if(2&a){const e=n.$implicit,i=t.oxw(2);t.ekj("selected",i.selection.isSelected(e))}}function yi(a,n){if(1&a&&(t.TgZ(0,"table",16),t.ynx(1,17),t.YNc(2,ti,2,1,"th",18),t.YNc(3,ai,2,1,"td",19),t.BQk(),t.ynx(4,20),t.YNc(5,ii,2,0,"th",21),t.YNc(6,si,3,2,"td",22),t.BQk(),t.ynx(7,23),t.YNc(8,oi,2,0,"th",21),t.YNc(9,pi,3,2,"td",22),t.BQk(),t.ynx(10,24),t.YNc(11,mi,2,0,"th",21),t.YNc(12,ui,2,0,"td",22),t.BQk(),t.ynx(13,25),t.YNc(14,_i,2,0,"th",21),t.YNc(15,gi,3,3,"td",22),t.BQk(),t.ynx(16,26),t.YNc(17,di,1,0,"th",27),t.YNc(18,xi,2,1,"td",28),t.BQk(),t.YNc(19,Ti,1,0,"tr",29),t.YNc(20,bi,1,2,"tr",30),t.qZA()),2&a){const e=t.oxw();t.Q6J("dataSource",e.dataSource),t.xp6(19),t.Q6J("cdkHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("cdkRowDefColumns",e.displayedColumns)}}function vi(a,n){1&a&&(t.TgZ(0,"app-empty-message"),t._uU(1,"Empty directory."),t.qZA())}let kt=(()=>{class a{constructor(e,i,r,s,o,c,m,x){this.dialog=e,this.yamcs=i,this.router=s,this.route=o,this.authService=c,this.messageService=m,this.breadcrumb$=new T.X([]),this.dragActive$=new T.X(!1),this.displayedColumns=["select","name","type","modified","actions"],this.dataSource=new u.by([]),this.selection=new k.Ov(!0,[]),r.setTitle("Displays"),this.storageClient=i.createStorageClient(),this.folderPerInstance=x.getConfig().displayFolderPerInstance,this.loadCurrentFolder(),this.routerSubscription=s.events.pipe((0,St.h)(d=>d instanceof y.m2)).subscribe(()=>{this.loadCurrentFolder()})}loadCurrentFolder(){const e={delimiter:"/"};let i="";this.folderPerInstance&&(i=this.yamcs.instance+"/");const r=this.route.snapshot.url;r.length?e.prefix=i+r.map(s=>s.path).join("/")+"/":i&&(e.prefix=i),this.storageClient.listObjects("_global","displays",e).then(s=>{this.updateBrowsePath(),this.changedir(s)})}getNameWithoutInstance(e){return this.folderPerInstance?e.substr(this.yamcs.instance.length):e}changedir(e){this.selection.clear();const i=[];for(const r of e.prefixes||[])i.push({folder:!0,name:r,nameWithoutInstance:this.getNameWithoutInstance(r)});for(const r of e.objects||[])r.name.endsWith("/")||i.push({folder:!1,name:r.name,nameWithoutInstance:this.getNameWithoutInstance(r.name),modified:r.created,objectUrl:this.storageClient.getObjectURL("_global","displays",r.name)});this.dataSource.data=i}isAllSelected(){const i=this.dataSource.data.length;return this.selection.selected.length===i&&i>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(e=>this.selection.select(e))}toggleOne(e){(!this.selection.isSelected(e)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(e)}createDisplay(){this.dialog.open(La,{width:"400px",data:{path:this.getCurrentPath(),prefix:this.folderPerInstance?this.yamcs.instance+"/":""}}).afterClosed().subscribe(i=>{i&&this.router.navigateByUrl(`/telemetry/displays/files/${i}?c=${this.yamcs.context}`)})}createFolder(){this.dialog.open(Ra,{width:"400px",data:{bucketInstance:"_global",bucket:"displays",path:this.getCurrentPath()}}).afterClosed().subscribe({next:()=>this.loadCurrentFolder()})}uploadFiles(){let e=this.getCurrentPath();e.startsWith("/")&&(e=e.substring(1));const i=this.uploaderEl.nativeElement.files,r=[];for(const s in i)if(!isNaN(parseInt(s,10))){const o=i[s],d=this.storageClient.uploadObject("_global","displays",(this.folderPerInstance?this.yamcs.instance+"/":"")+(e?e+"/"+o.name:o.name),o);r.push(d)}Promise.all(r).then(()=>this.loadCurrentFolder()).catch(s=>this.messageService.showError(s))}getCurrentPath(){let e="";for(const i of this.route.snapshot.url)e+="/"+i.path;return e||"/"}deleteSelectedDisplays(){const e=[],i=[];for(const r of this.selection.selected)r.folder?i.push(this.storageClient.listObjects("_global","displays",{prefix:r.name}).then(s=>{e.push(...(s.objects||[]).map(c=>c.name))})):e.push(r.name);Promise.all(i).then(()=>{if(confirm(`You are about to delete ${e.length} files. Are you sure you want to continue?`)){const r=[];for(const s of e)r.push(this.storageClient.deleteObject("_global","displays",s));Promise.all(r).then(()=>{this.loadCurrentFolder()})}})}renameFile(e){this.dialog.open(Fa,{data:{name:e.name},width:"400px"}).afterClosed().subscribe(r=>{r&&this.loadCurrentFolder()})}deleteFile(e){confirm(`Are you sure you want to delete ${e.nameWithoutInstance}?`)&&this.storageClient.deleteObject("_global","displays",e.name).then(()=>{this.loadCurrentFolder()})}dragEnter(e){return this.dragActive$.next(!0),e.preventDefault(),e.stopPropagation(),!1}dragOver(e){return e.preventDefault(),e.stopPropagation(),!1}dragLeave(e){return this.dragActive$.next(!1),e.preventDefault(),e.stopPropagation(),!1}drop(e){const i=e.dataTransfer||{};if(i){let r=this.getCurrentPath().substring(1);""!==r&&(r+="/"),ka.v(i).then(s=>{const o=[];for(const c of s){let m=r+c._fullPath;this.folderPerInstance&&(m=this.yamcs.instance+"/"+m);const x=this.storageClient.uploadObject("_global","displays",m,c);o.push(x)}Promise.all(o).finally(()=>{this.loadCurrentFolder()})})}return this.dragActive$.next(!1),e.preventDefault(),e.stopPropagation(),!1}mayManageDisplays(){const e=this.authService.getUser();return e.hasObjectPrivilege("ManageBucket","displays")||e.hasSystemPrivilege("ManageAnyBucket")}updateBrowsePath(){const e=[];let i="";for(const r of this.route.snapshot.url)i+="/"+r.path,e.push({name:r.path,route:"/telemetry/displays/browse"+i});return this.breadcrumb$.next(e),i||"/"}ngOnDestroy(){this.routerSubscription&&this.routerSubscription.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(g.uw),t.Y36(Z.C),t.Y36(O.Dx),t.Y36(y.F0),t.Y36(y.gz),t.Y36(G.e),t.Y36(et.e),t.Y36(J.E))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(e,i){if(1&e&&(t.Gf($a,7),t.Gf(Ea,5)),2&e){let r;t.iGM(r=t.CRH())&&(i.dropArea=r.first),t.iGM(r=t.CRH())&&(i.uploaderEl=r.first)}},decls:18,vars:17,consts:[["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],[1,"droparea",3,"dragenter"],["droparea",""],[1,"droparea-overlay",3,"dragover","dragleave","drop"],[1,"panel-content"],[4,"ngIf"],["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf","ngIfElse"],["empty",""],["mat-button","","color","primary",3,"click"],["type","file","hidden","","multiple","",3,"change"],["uploader",""],["mat-button","","color","primary",3,"disabled","click"],["link","/telemetry/displays/browse","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label",4,"ngFor","ngForOf"],[3,"link","queryParams","label"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","type"],["cdkColumnDef","visibility"],["cdkColumnDef","modified"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked","change",4,"ngIf"],["type","checkbox",3,"checked","change"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"checked","click","change",4,"ngIf"],["type","checkbox",3,"checked","click","change"],["mat-header-cell",""],["mat-cell",""],[1,"icon12",2,"vertical-align","middle","margin-right","7px"],[3,"routerLink","queryParams","click"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-menu-item","","download","",3,"href"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,i){if(1&e&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar"),t._uU(2," Displays \xa0\xa0\xa0 "),t.YNc(3,Ha,4,0,"button",0),t.YNc(4,Ba,6,0,"button",0),t.YNc(5,ja,4,0,"button",0),t.YNc(6,za,4,1,"button",1),t.qZA(),t.TgZ(7,"div",2,3),t.NdJ("dragenter",function(s){return i.dragEnter(s)}),t.ALo(9,"async"),t.TgZ(10,"div",4),t.NdJ("dragover",function(s){return i.dragOver(s)})("dragleave",function(s){return i.dragLeave(s)})("drop",function(s){return i.drop(s)}),t.ALo(11,"async"),t.qZA(),t.TgZ(12,"div",5),t.YNc(13,Xa,2,1,"ng-container",6),t.ALo(14,"async"),t.YNc(15,yi,21,3,"table",7),t.YNc(16,vi,2,0,"ng-template",null,8,t.W1O),t.qZA(),t.qZA(),t.qZA()),2&e){const r=t.MAs(17);t.xp6(3),t.Q6J("ngIf",i.mayManageDisplays()),t.xp6(1),t.Q6J("ngIf",i.mayManageDisplays()),t.xp6(1),t.Q6J("ngIf",i.mayManageDisplays()),t.xp6(1),t.Q6J("ngIf",i.mayManageDisplays()),t.xp6(1),t.ekj("active",t.lcZ(9,11,i.dragActive$)),t.xp6(3),t.ekj("hide",!t.lcZ(11,13,i.dragActive$)),t.xp6(3),t.Q6J("ngIf",t.lcZ(14,15,i.breadcrumb$)),t.xp6(2),t.Q6J("ngIf",i.dataSource&&i.dataSource.data.length)("ngIfElse",r)}},directives:[L.a,R.k,_.O5,C.lW,S.Hw,Nt.w,qt.a,_.sg,u.BZ,A.fo,A.D5,u.ge,A.O_,u.ev,y.yS,u.w1,u.fO,u.Dz,at.T,D.OP,j.d,A.s$,u.XQ,A.Sq,u.Gk,z.M],pipes:[_.Ov,st.X,At,P.i],styles:[".droparea[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:auto}.droparea-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;background:rgba(27,97,185,.1);border:1px solid rgba(27,97,185,1);z-index:10}"],changeDetection:0}),a})(),It=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,i){1&e&&t._UZ(0,"router-outlet")},directives:[y.lC],encapsulation:2,changeDetection:0}),a})(),Yt=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,i){1&e&&t._UZ(0,"router-outlet")},directives:[y.lC],encapsulation:2,changeDetection:0}),a})();var Zi=p(4e3);class Ai{constructor(){this.dirty=!1,this.archivePackets=[]}addArchiveData(n){this.archivePackets=this.archivePackets.concat(n),this.dirty=!0}reset(){this.archivePackets=[],this.dirty=!0}snapshot(){return this.archivePackets}}class wi extends k.o2{constructor(n,e){super(),this.yamcs=n,this.pageSize=100,this.blockHasMore=!1,this.packets$=new T.X([]),this.loading$=new T.X(!1),this.syncSubscription=e.sync(()=>{this.buffer.dirty&&!this.loading$.getValue()&&(this.packets$.next(this.buffer.snapshot()),this.buffer.dirty=!1)}),this.buffer=new Ai}connect(){return this.packets$}loadEntries(n,e){return this.loading$.next(!0),this.loadPage(Object.assign(Object.assign({},e),{limit:this.pageSize})).then(i=>{this.loading$.next(!1),this.buffer.reset(),this.blockHasMore=!1,this.buffer.addArchiveData(i)})}hasMore(){return!!this.continuationToken&&!this.blockHasMore}loadPage(n){return this.yamcs.yamcsClient.getPackets(this.yamcs.instance,n).then(e=>(this.continuationToken=e.continuationToken,e.packet||[]))}loadMoreData(n){!this.continuationToken||this.loadPage(Object.assign(Object.assign({},n),{next:this.continuationToken,limit:this.pageSize})).then(e=>{this.buffer.addArchiveData(e)})}disconnect(){this.syncSubscription&&this.syncSubscription.unsubscribe(),this.packets$.complete(),this.loading$.complete()}isEmpty(){return!this.packets$.getValue().length}}var Pi=p(9287),Si=p(490),Ci=p(3284),Di=p(3156),Ui=p(9177),ot=p(729),lt=p(4594),Ni=p(2768),qi=p(5682),ki=p(2652),Ii=p(6258);const Yi=["intervalSelect"];function Mi(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"app-detail-toolbar"),t._uU(2," Packet Detail "),t.qZA(),t.TgZ(3,"div",31),t.TgZ(4,"div",32),t._uU(5,"Generation time"),t.qZA(),t.TgZ(6,"div",33),t._uU(7),t.ALo(8,"datetime"),t.qZA(),t.TgZ(9,"div",32),t._uU(10,"Reception time"),t.qZA(),t.TgZ(11,"div",33),t._uU(12),t.ALo(13,"datetime"),t.ALo(14,"deltaWith"),t.qZA(),t.TgZ(15,"div",32),t._uU(16,"Size"),t.qZA(),t.TgZ(17,"div",33),t._uU(18),t.ALo(19,"formatBytes"),t.ALo(20,"binarySize"),t.qZA(),t.TgZ(21,"div",32),t._uU(22,"Data"),t.qZA(),t.TgZ(23,"div",33),t._UZ(24,"app-hex",34),t.qZA(),t.qZA(),t.BQk()),2&a){const e=n.ngIf;t.xp6(7),t.hij(" ",t.lcZ(8,5,e.generationTime)," "),t.xp6(5),t.AsE(" ",t.lcZ(13,7,e.receptionTime)," (",t.xi3(14,9,e.receptionTime,e.generationTime),") "),t.xp6(6),t.hij(" ",t.lcZ(19,12,t.lcZ(20,14,e.packet))," "),t.xp6(6),t.Q6J("base64String",e.packet)}}function Qi(a,n){1&a&&(t.TgZ(0,"app-detail-toolbar"),t._uU(1," Select a packet "),t.qZA())}function Ji(a,n){if(1&a){const e=t.EpF();t.ynx(0),t._UZ(1,"app-date-time-input",35),t._UZ(2,"app-date-time-input",36),t.TgZ(3,"button",30),t.NdJ("click",function(){return t.CHM(e),t.oxw().applyCustomDates()}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.filterForm.invalid)}}function Oi(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",37),t.NdJ("click",function(){return t.CHM(e),t.oxw().jumpToNow()}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function Li(a,n){1&a&&t._UZ(0,"app-dots")}function Ri(a,n){1&a&&(t.TgZ(0,"th",38),t._uU(1,"Packet Name"),t.qZA())}function Vi(a,n){if(1&a&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",e.id.name," ")}}function Fi(a,n){1&a&&(t.TgZ(0,"th",38),t._uU(1,"Generation Time"),t.qZA())}function $i(a,n){if(1&a&&(t.TgZ(0,"td",39),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.generationTime)," ")}}function Ei(a,n){1&a&&(t.TgZ(0,"th",38),t._uU(1,"Reception Time"),t.qZA())}function Hi(a,n){if(1&a&&(t.TgZ(0,"td",39),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.receptionTime)," ")}}function Bi(a,n){1&a&&(t.TgZ(0,"th",38),t._uU(1,"Size"),t.qZA())}function ji(a,n){if(1&a&&(t.TgZ(0,"td",39),t._uU(1),t.ALo(2,"formatBytes"),t.ALo(3,"binarySize"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,t.lcZ(3,3,e.packet))," ")}}function zi(a,n){1&a&&(t.TgZ(0,"th",38),t._uU(1,"Data"),t.qZA())}function Gi(a,n){if(1&a&&(t.TgZ(0,"td",40),t._uU(1),t.ALo(2,"hex"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.packet)," ")}}function Wi(a,n){1&a&&t._UZ(0,"th",41)}function Xi(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"td",39),t.TgZ(1,"app-more"),t.TgZ(2,"button",42),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw().copyHex(s)}),t._uU(3," Copy Hex "),t.qZA(),t.TgZ(4,"button",42),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw().copyBinary(s)}),t._uU(5," Copy Binary "),t.qZA(),t._UZ(6,"mat-divider"),t.TgZ(7,"app-download-menu-item",3),t.ALo(8,"packetDownloadLink"),t._uU(9," Download "),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=n.$implicit;t.xp6(7),t.Q6J("link",t.lcZ(8,1,e))}}function Ki(a,n){1&a&&t._UZ(0,"tr",43)}function tn(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"tr",44),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw().selectPacket(s)}),t.ALo(1,"async"),t.qZA()}if(2&a){const e=n.$implicit,i=t.oxw();t.ekj("selected",t.lcZ(1,3,i.detailPacket$)===e),t.Q6J("@rowAnimation",e.animate)}}const V="PT1H";let Mt=(()=>{class a{constructor(e,i,r,s,o,c){this.yamcs=e,this.router=i,this.route=r,this.clipboard=c,this.displayedColumns=["packetName","generationTime","receptionTime","data","size","actions"],this.filterForm=new l.cw({name:new l.NI("ANY"),interval:new l.NI(V),customStart:new l.NI(null),customStop:new l.NI(null)}),this.detailPacket$=new T.X(null),this.nameOptions$=new T.X([{id:"ANY",label:"Any name"}]),this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.downloadURL$=new T.X(null),s.setTitle("Packets"),this.dataSource=new wi(this.yamcs,o),e.yamcsClient.getPacketNames(e.instance).then(m=>{for(const x of m)this.nameOptions$.next([...this.nameOptions$.value,{id:x,label:x}])}),this.initializeOptions(),this.loadData(),this.filterForm.get("name").valueChanges.forEach(m=>{this.name="ANY"!==m?m:null,this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(m=>{if("CUSTOM"===m){const x=this.validStart||this.yamcs.getMissionTime(),d=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(h.Y6(x)),this.filterForm.get("customStop").setValue(h.Y6(d))}else"NO_LIMIT"===m?(this.validStart=null,this.validStop=null,this.appliedInterval=m,this.loadData()):(this.validStop=e.getMissionTime(),this.validStart=(0,h.rV)(this.validStop,m),this.appliedInterval=m,this.loadData())})}initializeOptions(){const e=this.route.snapshot.queryParamMap;if(e.has("name")&&(this.name=e.get("name")||"",this.filterForm.get("name").setValue(this.name)),e.has("interval"))if(this.appliedInterval=e.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const i=e.get("customStart");this.filterForm.get("customStart").setValue(i),this.validStart=new Date(i);const r=e.get("customStop");this.filterForm.get("customStop").setValue(r),this.validStop=new Date(r)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=(0,h.rV)(this.validStop,this.appliedInterval));else this.appliedInterval=V,this.validStop=this.yamcs.getMissionTime(),this.validStart=(0,h.rV)(this.validStop,V)}jumpToNow(){const e=this.filterForm.value.interval;"NO_LIMIT"===e||"CUSTOM"===e?this.filterForm.get("interval").setValue(V):(this.validStop=this.yamcs.getMissionTime(),this.validStart=(0,h.rV)(this.validStop,e),this.loadData())}applyCustomDates(){this.validStart=h.ZU(this.filterForm.value.customStart),this.validStop=h.ZU(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const e={};this.validStart&&(e.start=this.validStart.toISOString()),this.validStop&&(e.stop=this.validStop.toISOString()),this.name&&(e.name=this.name);const i={};this.validStart&&(i.start=this.validStart.toISOString()),this.validStop&&(i.stop=this.validStop.toISOString()),this.name&&(i.name=this.name),this.dataSource.loadEntries("realtime",e).then(r=>{const s=this.yamcs.yamcsClient.getPacketsDownloadURL(this.yamcs.instance,i);this.downloadURL$.next(s)})}loadMoreData(){const e={};this.validStart&&(e.start=this.validStart.toISOString()),this.name&&(e.name=this.name),this.dataSource.loadMoreData(e)}copyHex(e){const i=h.TR(e.packet);this.clipboard.copy(i)}copyBinary(e){const i=atob(e.packet);this.clipboard.copy(i)}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{name:this.name||null,interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}selectPacket(e){this.detailPacket$.next(e)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.C),t.Y36(y.F0),t.Y36(y.gz),t.Y36(O.Dx),t.Y36(q.j),t.Y36(Pi.TU))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(e,i){if(1&e&&t.Gf(Yi,5),2&e){let r;t.iGM(r=t.CRH())&&(i.intervalSelect=r.first)}},decls:59,vars:26,consts:[[3,"hasDetailPane"],[1,"ya-menu"],["exportMenu","matMenu"],[3,"link"],["mat-button","","color","primary",3,"matMenuTriggerFor","disabled"],["mat-icon-button","","matTooltip","Jump to now","color","primary",3,"click"],[4,"ngIf","ngIfElse"],["noSelection",""],[1,"table-wrapper"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","name",3,"options"],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],[4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","packetName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","receptionTime"],["matColumnDef","size"],["matColumnDef","data"],["mat-cell","","class","mono",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],[2,"flex","1 1 auto"],[1,"ya-button",3,"disabled","click"],[2,"padding","0 16px"],[1,"block-title"],[1,"block"],[3,"base64String"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"mono"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,i){if(1&e&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar",0),t._uU(2," Packets \xa0\xa0\xa0 "),t.TgZ(3,"mat-menu",1,2),t.TgZ(5,"app-download-menu-item",3),t.ALo(6,"async"),t._uU(7," Raw dump "),t.qZA(),t.qZA(),t.TgZ(8,"button",4),t.ALo(9,"async"),t.TgZ(10,"mat-icon"),t._uU(11,"save_alt"),t.qZA(),t._uU(12," EXPORT "),t.qZA(),t.TgZ(13,"button",5),t.NdJ("click",function(){return i.jumpToNow()}),t.TgZ(14,"mat-icon"),t._uU(15,"refresh"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"app-detail-pane"),t.YNc(17,Mi,25,16,"ng-container",6),t.ALo(18,"async"),t.YNc(19,Qi,2,0,"ng-template",null,7,t.W1O),t.qZA(),t.TgZ(21,"div",8),t.TgZ(22,"div",9),t.TgZ(23,"form",10),t.TgZ(24,"div",11),t._UZ(25,"app-select",12),t.ALo(26,"async"),t._UZ(27,"app-select",13,14),t.YNc(29,Ji,5,1,"ng-container",15),t.YNc(30,Oi,3,0,"ng-container",15),t.YNc(31,Li,1,0,"app-dots",15),t.ALo(32,"async"),t.qZA(),t.qZA(),t.TgZ(33,"table",16),t.ynx(34,17),t.YNc(35,Ri,2,0,"th",18),t.YNc(36,Vi,2,1,"td",19),t.BQk(),t.ynx(37,20),t.YNc(38,Fi,2,0,"th",18),t.YNc(39,$i,3,3,"td",19),t.BQk(),t.ynx(40,21),t.YNc(41,Ei,2,0,"th",18),t.YNc(42,Hi,3,3,"td",19),t.BQk(),t.ynx(43,22),t.YNc(44,Bi,2,0,"th",18),t.YNc(45,ji,4,5,"td",19),t.BQk(),t.ynx(46,23),t.YNc(47,zi,2,0,"th",18),t.YNc(48,Gi,3,3,"td",24),t.BQk(),t.ynx(49,25),t.YNc(50,Wi,1,0,"th",26),t.YNc(51,Xi,10,3,"td",19),t.BQk(),t.YNc(52,Ki,1,0,"tr",27),t.YNc(53,tn,2,5,"tr",28),t.qZA(),t.TgZ(54,"mat-toolbar"),t._UZ(55,"span",29),t.TgZ(56,"button",30),t.NdJ("click",function(){return i.loadMoreData()}),t._uU(57,"Load More"),t.qZA(),t._UZ(58,"span",29),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e){const r=t.MAs(4),s=t.MAs(20);let o;t.xp6(1),t.Q6J("hasDetailPane",!0),t.xp6(4),t.Q6J("link",t.lcZ(6,16,i.downloadURL$)),t.xp6(3),t.Q6J("matMenuTriggerFor",r)("disabled",!(null!=(o=t.lcZ(9,18,i.dataSource.packets$))&&o.length)),t.xp6(9),t.Q6J("ngIf",t.lcZ(18,20,i.detailPacket$))("ngIfElse",s),t.xp6(6),t.Q6J("formGroup",i.filterForm),t.xp6(2),t.Q6J("options",t.lcZ(26,22,i.nameOptions$)),t.xp6(2),t.Q6J("options",i.intervalOptions),t.xp6(2),t.Q6J("ngIf","CUSTOM"===i.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==i.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf",t.lcZ(32,24,i.dataSource.loading$)),t.xp6(2),t.Q6J("dataSource",i.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(3),t.Q6J("disabled",!i.dataSource.hasMore())}},directives:[L.a,R.k,D.VK,Si.t,C.lW,D.p6,S.Hw,it.gM,Ci.Z,_.O5,Di.j,Ui.p,l._Y,l.JL,l.sg,M.P,l.JJ,l.u,Y.Y,ot.b,u.BZ,u.w1,u.fO,u.ge,u.Dz,u.ev,at.T,D.OP,j.d,u.as,u.XQ,u.nj,u.Gk,lt.Ye],pipes:[_.Ov,P.i,Ni.m,qi.b,ki.n,Ii.l,wt],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}mat-row[_ngcontent-%COMP%]{cursor:pointer}"],data:{animation:[Zi.q]},changeDetection:0}),a})();class en extends k.o2{constructor(n,e){super(),this.yamcs=n,this.qualifiedName=e,this.pageSize=100,this.alarms$=new T.X([]),this.loading$=new T.X(!1)}connect(n){return this.alarms$}isEmpty(){return 0===this.alarms$.value.length}loadAlarms(n){return this.loading$.next(!0),this.loadPage(Object.assign(Object.assign({},n),{limit:this.pageSize+1})).then(e=>{this.loading$.next(!1),this.alarms$.next(e)})}hasMore(){return null!=this.offscreenRecord}loadPage(n){return this.yamcs.yamcsClient.getAlarmsForParameter(this.yamcs.instance,this.qualifiedName,n).then(e=>(this.offscreenRecord=e.length>this.pageSize?e.splice(e.length-1,1)[0]:null,e))}loadMoreData(n){!this.offscreenRecord||this.loadPage(Object.assign(Object.assign({},n),{stop:this.offscreenRecord.triggerTime,limit:this.pageSize+1})).then(e=>{const i=this.alarms$.getValue().concat(e);this.alarms$.next(i)})}disconnect(n){this.alarms$.complete(),this.loading$.complete()}}var U=p(1764),ct=p(1711),an=p(4953);function nn(a,n){1&a&&(t.TgZ(0,"th",17),t._uU(1,"Severity"),t.qZA())}function rn(a,n){if(1&a&&(t.TgZ(0,"td",18),t._UZ(1,"app-alarm-level",19),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("level",e.severity)}}function sn(a,n){1&a&&(t.TgZ(0,"th",17),t._uU(1,"Start"),t.qZA())}function on(a,n){if(1&a&&(t.TgZ(0,"td",18),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.triggerTime)||"-")}}function ln(a,n){1&a&&(t.TgZ(0,"th",17),t._uU(1,"Stop"),t.qZA())}function cn(a,n){if(1&a&&(t.TgZ(0,"td",18),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.updateTime)||"-"," ")}}function pn(a,n){1&a&&(t.TgZ(0,"th",17),t._uU(1,"Trip value"),t.qZA())}function mn(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function un(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function _n(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"value"),t.YNc(3,mn,2,0,"span",21),t.YNc(4,un,2,0,"span",21),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,3,e.triggerValue.engValue)," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.triggerValue.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.triggerValue.rangeCondition)}}function gn(a,n){if(1&a&&(t.TgZ(0,"td",20),t.YNc(1,_n,5,5,"ng-container",21),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail)}}function dn(a,n){1&a&&(t.TgZ(0,"th",17),t._uU(1,"Duration"),t.qZA())}function hn(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"duration"),t.BQk()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,i.durationFor(e))||"-"," ")}}function fn(a,n){if(1&a&&(t.TgZ(0,"mat-icon",23),t._uU(1,"comment"),t.qZA()),2&a){const e=t.oxw(2).$implicit;t.Q6J("matTooltip",null==e.clearInfo?null:e.clearInfo.clearMessage)}}function xn(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.YNc(2,fn,2,1,"mat-icon",22),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" (cleared by ",null==e.clearInfo?null:e.clearInfo.clearedBy,") "),t.xp6(1),t.Q6J("ngIf",null==e.clearInfo?null:e.clearInfo.clearMessage)}}function Tn(a,n){if(1&a&&(t.TgZ(0,"td",18),t.YNc(1,hn,3,3,"ng-container",21),t.YNc(2,xn,3,2,"ng-container",21),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.updateTime),t.xp6(1),t.Q6J("ngIf",null==e.clearInfo?null:e.clearInfo.clearedBy)}}function bn(a,n){1&a&&(t.TgZ(0,"th",24),t._uU(1,"Violations"),t.qZA())}function yn(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"number"),t.ALo(3,"number"),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,e.violations)," (",t.xi3(3,4,e.violations/e.count*100,"1.2-2"),"%) ")}}function vn(a,n){if(1&a&&(t.TgZ(0,"td",25),t.YNc(1,yn,4,7,"ng-container",26),t.qZA()),2&a){const e=n.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.violations)("ngIfElse",i.dash)}}function Zn(a,n){1&a&&t._UZ(0,"th",27)}function An(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"td",18),t.TgZ(1,"app-text-action",28),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).showChart(s)}),t._uU(2," SHOW CHART "),t.qZA(),t.TgZ(3,"app-text-action",29),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).showData(s)}),t._uU(4," SHOW DATA "),t.qZA(),t.qZA()}}function wn(a,n){1&a&&t._UZ(0,"tr",30)}function Pn(a,n){1&a&&t._UZ(0,"tr",31)}function Sn(a,n){if(1&a&&(t.TgZ(0,"table",1),t.ynx(1,2),t.YNc(2,nn,2,0,"th",3),t.YNc(3,rn,2,1,"td",4),t.BQk(),t.ynx(4,5),t.YNc(5,sn,2,0,"th",3),t.YNc(6,on,3,3,"td",4),t.BQk(),t.ynx(7,6),t.YNc(8,ln,2,0,"th",3),t.YNc(9,cn,3,3,"td",4),t.BQk(),t.ynx(10,7),t.YNc(11,pn,2,0,"th",3),t.YNc(12,gn,2,1,"td",8),t.BQk(),t.ynx(13,9),t.YNc(14,dn,2,0,"th",3),t.YNc(15,Tn,3,2,"td",4),t.BQk(),t.ynx(16,10),t.YNc(17,bn,2,0,"th",11),t.YNc(18,vn,2,2,"td",12),t.BQk(),t.ynx(19,13),t.YNc(20,Zn,1,0,"th",14),t.YNc(21,An,5,0,"td",4),t.BQk(),t.YNc(22,wn,1,0,"tr",15),t.YNc(23,Pn,1,0,"tr",16),t.qZA()),2&a){const e=t.oxw();t.Q6J("dataSource",e.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}let Cn=(()=>{class a{constructor(e,i){this.router=e,this.yamcs=i,this.displayedColumns=["severity","start","stop","duration","triggerValue","violations","actions"]}durationFor(e){if(e.updateTime)return h.ZU(e.updateTime).getTime()-h.ZU(e.triggerTime).getTime()}showChart(e){var i,r;const s=e.triggerTime,o=e.updateTime||(null===(i=e.clearInfo)||void 0===i?void 0:i.clearTime);let c,m;o?(c=U.utc(s),m=U.utc(o)):(c=U.utc(s),m=U.utc(o).add(1,"hour")),this.router.navigate(["/telemetry/parameters",null===(r=e.parameterDetail)||void 0===r?void 0:r.triggerValue.id.name,"chart"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:c.toISOString(),customStop:m.toISOString()}})}showData(e){var i,r;const s=e.triggerTime,o=e.updateTime||(null===(i=e.clearInfo)||void 0===i?void 0:i.clearTime);let c,m;o?(c=U.utc(s),m=U.utc(o)):(c=U.utc(s),m=U.utc(o).add(1,"hour")),this.router.navigate(["/telemetry/parameters",null===(r=e.parameterDetail)||void 0===r?void 0:r.triggerValue.id.name,"data"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:c.toISOString(),customStop:m.toISOString()}})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.F0),t.Y36(Z.C))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-parameter-alarms-table"]],inputs:{dataSource:"dataSource"},decls:1,vars:1,consts:[["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","start"],["matColumnDef","stop"],["matColumnDef","triggerValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","duration"],["matColumnDef","violations"],["mat-header-cell","","style","text-align: right",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level"],["mat-cell","",1,"wrap200"],[4,"ngIf"],[3,"matTooltip",4,"ngIf"],[3,"matTooltip"],["mat-header-cell","",2,"text-align","right"],["mat-cell","",2,"text-align","right"],[4,"ngIf","ngIfElse"],["mat-header-cell","",1,"expand"],["icon","show_chart",3,"click"],["icon","view_headline",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,i){1&e&&t.YNc(0,Sn,24,3,"table",0),2&e&&t.Q6J("ngIf",i.dataSource)},directives:[_.O5,u.BZ,u.w1,u.fO,u.ge,u.Dz,u.ev,H.i,S.Hw,it.gM,ct.l,u.as,u.XQ,u.nj,u.Gk],pipes:[P.i,I.V,an.u,_.JJ],encapsulation:2,changeDetection:0}),a})();function Dn(a,n){if(1&a){const e=t.EpF();t.ynx(0),t._UZ(1,"app-date-time-input",8),t._UZ(2,"app-date-time-input",9),t.TgZ(3,"button",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().applyCustomDates()}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.filter.invalid)}}function Un(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",11),t.NdJ("click",function(){return t.CHM(e),t.oxw().jumpToNow()}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function Nn(a,n){1&a&&t._UZ(0,"app-dots")}function qn(a,n){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last month"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function kn(a,n){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last year"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function In(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"all time"),t.qZA(),t.qZA())}function Yn(a,n){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3),t.ALo(4,"datetime"),t.qZA(),t._uU(5," to "),t.TgZ(6,"b"),t._uU(7),t.ALo(8,"datetime"),t.qZA(),t._uU(9," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,2,e.validStart)),t.xp6(4),t.Oqu(t.lcZ(8,4,e.validStop))}}function Mn(a,n){1&a&&(t.TgZ(0,"app-empty-message"),t._uU(1," No records found matching current filter in the selected time range. "),t.qZA())}function Qn(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"mat-toolbar"),t._UZ(1,"span",12),t.TgZ(2,"button",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().loadMoreData()}),t._uU(3,"Load More"),t.qZA(),t._UZ(4,"span",12),t.qZA()}if(2&a){const e=t.oxw();t.xp6(2),t.Q6J("disabled",!e.dataSource.hasMore())}}const X="P1M";let Qt=(()=>{class a{constructor(e,i){this.yamcs=i,this.intervalOptions=[{id:"P1M",label:"Last Month"},{id:"P1Y",label:"Last Year"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}],this.filter=new l.cw({interval:new l.NI(X),customStart:new l.NI(null),customStop:new l.NI(null)}),this.qualifiedName=e.parent.snapshot.paramMap.get("qualifiedName"),this.dataSource=new en(i,this.qualifiedName),this.validStop=i.getMissionTime(),this.validStart=h.rV(this.validStop,X),this.appliedInterval=X,this.loadData(),this.filter.get("interval").valueChanges.forEach(r=>{if("CUSTOM"===r){const s=this.validStart||this.yamcs.getMissionTime(),o=this.validStop||this.yamcs.getMissionTime();this.filter.get("customStart").setValue(h.Y6(s)),this.filter.get("customStop").setValue(h.Y6(o))}else"NO_LIMIT"===r?(this.validStart=null,this.validStop=null,this.appliedInterval=r,this.loadData()):(this.validStop=i.getMissionTime(),this.validStart=h.rV(this.validStop,r),this.appliedInterval=r,this.loadData())})}jumpToNow(){const e=this.filter.value.interval;"NO_LIMIT"===e?this.filter.get("interval").setValue(X):(this.validStop=this.yamcs.getMissionTime(),this.validStart=h.rV(this.validStop,e),this.loadData())}applyCustomDates(){this.validStart=h.ZU(this.filter.value.customStart),this.validStop=h.ZU(this.filter.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){const e={detail:!0};this.validStart&&(e.start=this.validStart.toISOString()),this.validStop&&(e.stop=this.validStop.toISOString()),this.dataSource.loadAlarms(e)}loadMoreData(){const e={detail:!0};this.validStart&&(e.start=this.validStart.toISOString()),this.dataSource.loadMoreData(e)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.gz),t.Y36(Z.C))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:17,vars:17,consts:[[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","interval","icon","access_time",3,"options"],[4,"ngIf"],[1,"table-status",3,"ngSwitch"],[4,"ngSwitchCase"],[3,"dataSource"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],[2,"flex","1 1 auto"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"form",1),t.TgZ(2,"div",2),t._UZ(3,"app-select",3),t.YNc(4,Dn,5,1,"ng-container",4),t.YNc(5,Un,3,0,"ng-container",4),t.YNc(6,Nn,1,0,"app-dots",4),t.ALo(7,"async"),t.qZA(),t.qZA(),t.TgZ(8,"div",5),t.YNc(9,qn,9,3,"span",6),t.YNc(10,kn,9,3,"span",6),t.YNc(11,In,4,0,"span",6),t.YNc(12,Yn,10,6,"span",6),t.qZA(),t._UZ(13,"app-parameter-alarms-table",7),t.YNc(14,Mn,2,0,"app-empty-message",4),t.YNc(15,Qn,5,1,"mat-toolbar",4),t.ALo(16,"async"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("formGroup",i.filter),t.xp6(2),t.Q6J("options",i.intervalOptions),t.xp6(1),t.Q6J("ngIf","CUSTOM"===i.filter.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==i.filter.value.interval),t.xp6(1),t.Q6J("ngIf",t.lcZ(7,13,i.dataSource.loading$)),t.xp6(2),t.Q6J("ngSwitch",i.appliedInterval),t.xp6(1),t.Q6J("ngSwitchCase","P1M"),t.xp6(1),t.Q6J("ngSwitchCase","P1Y"),t.xp6(1),t.Q6J("ngSwitchCase","NO_LIMIT"),t.xp6(1),t.Q6J("ngSwitchCase","CUSTOM"),t.xp6(1),t.Q6J("dataSource",i.dataSource),t.xp6(1),t.Q6J("ngIf",i.dataSource.isEmpty()),t.xp6(1),t.Q6J("ngIf",!t.lcZ(16,15,i.dataSource.loading$)&&!i.dataSource.isEmpty()))},directives:[l._Y,l.JL,l.sg,M.P,l.JJ,l.u,_.O5,Y.Y,ot.b,_.RF,_.n9,Cn,z.M,lt.Ye],pipes:[_.Ov,P.i],styles:[".table-status[_ngcontent-%COMP%]{background-color:#f7f7f7;height:24px;line-height:24px;font-size:12px;padding-left:6px}"],changeDetection:0}),a})();class Jn{constructor(n){this.watermarkObserver=n,this.dirty=!1,this.valueRange=[null,null],this.archiveSamples=[],this.bufferSize=500,this.bufferWatermark=400,this.pointer=0,this.alreadyWarned=!1,this.realtimeBuffer=Array(this.bufferSize).fill(void 0)}setArchiveData(n){this.archiveSamples=n,this.dirty=!0}setValueRange(n){this.valueRange=n}addRealtimeValue(n){this.pointer<this.bufferSize&&(this.realtimeBuffer[this.pointer]=n,this.pointer>=this.bufferWatermark&&this.watermarkObserver&&!this.alreadyWarned&&(this.watermarkObserver(),this.alreadyWarned=!0),this.pointer=this.pointer+1),this.dirty=!0}reset(){this.archiveSamples=[],this.realtimeBuffer.fill(void 0),this.pointer=0,this.alreadyWarned=!1,this.valueRange=[null,null],this.dirty=!0}snapshot(){const n=this.realtimeBuffer.filter(r=>void 0!==r);let e=null;n.length>0&&(e=n[0][0].getTime());const i=this.archiveSamples.filter(r=>null===e||r[0].getTime()<e).concat(n).sort((r,s)=>r[0].getTime()-s[0].getTime());return{valueRange:this.valueRange,samples:i}}}class On{constructor(n,e){this.yamcs=n,this.loading$=new T.X(!1),this.data$=new T.X({valueRange:[null,null],samples:[]}),this.parameters$=new T.X([]),this.latestRealtimeValues=new Map,this.syncSubscription=e.sync(()=>{if(this.plotBuffer.dirty&&!this.loading$.getValue()){const i=this.plotBuffer.snapshot();this.data$.next({samples:i.samples,valueRange:i.valueRange}),this.plotBuffer.dirty=!1}}),this.plotBuffer=new Jn(()=>{this.reloadVisibleRange()})}addParameter(...n){if(this.parameters$.next([...this.parameters$.value,...n]),this.realtimeSubscription){const e=n.map(i=>({name:i.qualifiedName}));this.addToRealtimeSubscription(e)}else this.connectRealtime()}removeParameter(n){const e=this.parameters$.value.filter(i=>i.qualifiedName!==n);this.parameters$.next(e)}reloadVisibleRange(){return this.updateWindow(this.visibleStart,this.visibleStop,[null,null])}updateWindowOnly(n,e){this.visibleStart=n,this.visibleStop=e}updateWindow(n,e,i){this.loading$.next(!0);const r=e.getTime()-n.getTime(),s=new Date(n.getTime()-r),o=new Date(e.getTime()+r),c=[];for(const x of this.parameters$.value)c.push(this.yamcs.yamcsClient.getParameterSamples(this.yamcs.instance,x.qualifiedName,{start:s.toISOString(),stop:o.toISOString(),count:6e3}));const m=Promise.all(c);return this.lastLoadPromise=m,m.then(x=>{if(this.lastLoadPromise===m){this.loading$.next(!1),this.plotBuffer.reset(),this.latestRealtimeValues.clear(),this.visibleStart=n,this.visibleStop=e,this.minValue=void 0,this.maxValue=void 0;const d=[];for(let v=0;v<x.length;v++)d[v]=this.processSamples(x[v]);let b=this.mergeSeries(...d);this.plotBuffer.setArchiveData(b),this.plotBuffer.setValueRange(i),this.lastLoadPromise=null}})}connectRealtime(){const n=this.parameters$.value.map(e=>({name:e.qualifiedName}));this.realtimeSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:n,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"REPLACE"},e=>{e.mapping&&(this.idMapping=Object.assign(Object.assign({},this.idMapping),e.mapping)),e.values&&e.values.length&&this.processRealtimeDelivery(e.values)})}addToRealtimeSubscription(n){this.realtimeSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:n,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"ADD"})}processRealtimeDelivery(n){for(const s of n){let o=null;const c=(0,h.t3)(s.engValue);null!==c&&("EXPIRED"===s.acquisitionStatus?o=null:"ACQUIRED"===s.acquisitionStatus&&(o=[c,c,c])),this.latestRealtimeValues.set(this.idMapping[s.numericId].name,o)}const e=new Date;e.setTime(Date.parse(n[0].generationTime));const r=[e,...this.parameters$.value.map(s=>this.latestRealtimeValues.get(s.qualifiedName)||null)];this.plotBuffer.addRealtimeValue(r)}disconnect(){this.data$.complete(),this.loading$.complete(),this.realtimeSubscription&&this.realtimeSubscription.cancel(),this.syncSubscription&&this.syncSubscription.unsubscribe()}processSamples(n){const e=[];for(const i of n){const r=new Date;if(r.setTime(Date.parse(i.time)),i.n>0){const s=i.avg,o=i.min,c=i.max;void 0===this.minValue?(this.minValue=o,this.maxValue=c):(this.minValue>o&&(this.minValue=o),this.maxValue<c&&(this.maxValue=c)),e.push([r,[o,s,c]])}else e.push([r,null])}return e}mergeSeries(...n){if(1===n.length)return n[0];let e=n[0];for(let i=1;i<n.length;i++){const r=[];let s=0,o=0,c=[],m=null;const x=e,d=n[i];for(;s<x.length||o<d.length;){const b=s<x.length?x[s]:null,v=o<d.length?d[o]:null;b&&v?b[0].getTime()===v[0].getTime()?(c=b.slice(1),m=v[1],r.push([b[0],...c,m]),s++,o++):b[0].getTime()<v[0].getTime()?(c=b.slice(1),r.push([b[0],...c,m]),s++):(m=v[1],r.push([v[0],...c,m]),o++):b?(c=b.slice(1),r.push([b[0],...c,m]),s++):v&&(m=v[1],r.push([v[0],...c,m]),o++)}e=r}return e}}var Jt=p(2227),Ot=p(2565),Ln=p(8372),Rn=p(3900),Lt=p(4004),pt=p(587),Rt=p(1079),Vn=p(508),Fn=p(8110),$n=p(8123);const En=["palette"],Hn=["thickness"];function Bn(a,n){if(1&a&&(t.TgZ(0,"mat-option",12),t.ALo(1,"memberPath"),t._uU(2),t.ALo(3,"memberPath"),t.qZA()),2&a){const e=n.$implicit;t.Q6J("value",t.lcZ(1,2,e)),t.xp6(2),t.hij(" ",t.lcZ(3,4,e)," ")}}let jn=(()=>{class a{constructor(e,i,r,s){this.dialogRef=e,this.yamcs=i,this.data=r,this.memberPathPipe=s,this.parameter=new l.NI(null,[l.kI.required])}ngOnInit(){const e=this.data.exclude;this.filteredOptions=this.parameter.valueChanges.pipe((0,Ln.b)(300),(0,Rn.w)(i=>this.yamcs.yamcsClient.getParameters(this.yamcs.instance,{q:i,limit:10,searchMembers:!0})),(0,Lt.U)(i=>i.parameters||[]),(0,Lt.U)(i=>i.filter(r=>{for(const s of e){const o=this.memberPathPipe.transform(r);if(s.qualifiedName===o)return!1}return!0})))}select(){this.dialogRef.close({qualifiedName:this.parameter.value,color:this.palette.selectedColor,thickness:this.thickness.selectedThickness})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(g.so),t.Y36(Z.C),t.Y36(g.WI),t.Y36(pt.e))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-compare-parameter-dialog"]],viewQuery:function(e,i){if(1&e&&(t.Gf(En,7),t.Gf(Hn,7)),2&e){let r;t.iGM(r=t.CRH())&&(i.palette=r.first),t.iGM(r=t.CRH())&&(i.thickness=r.first)}},decls:23,vars:7,consts:[[1,"mat-typography","ya-form"],["type","text",3,"formControl","matAutocomplete"],[1,"ya-autocomplete"],["auto",""],[3,"value",4,"ngFor","ngForOf"],[1,"mat-typography"],["palette",""],[3,"color"],["thickness",""],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"],[3,"value"]],template:function(e,i){if(1&e&&(t.TgZ(0,"mat-dialog-content",0),t.TgZ(1,"label"),t._uU(2," Search parameter for comparison "),t._UZ(3,"input",1),t.TgZ(4,"mat-autocomplete",2,3),t.YNc(6,Bn,4,6,"mat-option",4),t.ALo(7,"async"),t.qZA(),t.qZA(),t._UZ(8,"br"),t.TgZ(9,"label",5),t._uU(10,"Color"),t.qZA(),t._UZ(11,"app-color-palette",null,6),t._UZ(13,"br"),t.TgZ(14,"label",5),t._uU(15,"Thickness"),t.qZA(),t._UZ(16,"app-thickness",7,8),t.qZA(),t.TgZ(18,"mat-dialog-actions",9),t.TgZ(19,"button",10),t._uU(20,"CANCEL"),t.qZA(),t.TgZ(21,"button",11),t.NdJ("click",function(){return i.select()}),t._uU(22,"ADD"),t.qZA(),t.qZA()),2&e){const r=t.MAs(5),s=t.MAs(12);t.xp6(3),t.Q6J("formControl",i.parameter)("matAutocomplete",r),t.xp6(3),t.Q6J("ngForOf",t.lcZ(7,5,i.filteredOptions)),t.xp6(10),t.Q6J("color",s.selectedColor),t.xp6(5),t.Q6J("disabled",!i.parameter.valid)}},directives:[g.xY,l.Fj,Rt.ZL,l.JJ,l.oH,Rt.XC,_.sg,Vn.ey,Fn.V,$n.z,g.H8,g.ZT],pipes:[pt.e,_.Ov],encapsulation:2,changeDetection:0}),a})(),zn=(()=>{class a{constructor(e,i,r){this.dialogRef=e,this.yamcs=r,this.form=new l.cw({start:new l.NI(null,l.kI.required),stop:new l.NI(null,l.kI.required)});let s=i.start,o=i.stop;(!s||!o)&&(o=this.yamcs.getMissionTime(),s=(0,h.rV)(o,"PT1H")),this.form.setValue({start:h.Y6(s),stop:h.Y6(o)})}select(){const e=h.ZU(this.form.value.start),i=h.ZU(this.form.value.stop);this.dialogRef.close({start:e,stop:i})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(g.so),t.Y36(g.WI),t.Y36(Z.C))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-select-range-dialog"]],decls:15,vars:2,consts:[["mat-dialog-title",""],[1,"mat-typography","ya-form"],[3,"formGroup"],["formControlName","start"],["formControlName","stop"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Select Range"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.TgZ(3,"form",2),t.TgZ(4,"label"),t._uU(5," Start "),t._UZ(6,"app-date-time-input",3),t.qZA(),t.TgZ(7,"label"),t._uU(8," Stop "),t._UZ(9,"app-date-time-input",4),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"mat-dialog-actions",5),t.TgZ(11,"button",6),t._uU(12,"CANCEL"),t.qZA(),t.TgZ(13,"button",7),t.NdJ("click",function(){return i.select()}),t._uU(14,"OK"),t.qZA(),t.qZA()),2&e&&(t.xp6(3),t.Q6J("formGroup",i.form),t.xp6(10),t.Q6J("disabled",!i.form.valid))},directives:[g.uh,g.xY,l._Y,l.JL,l.sg,Y.Y,l.JJ,l.u,g.H8,g.ZT],encapsulation:2}),a})();function Gn(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"Date Range"),t.qZA())}function Wn(a,n){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"datetime"),t.ALo(3,"datetime"),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw().ngIf;t.xp6(1),t.AsE(" ",t.lcZ(2,2,i)," - ",t.lcZ(3,4,e)," ")}}function Xn(a,n){if(1&a&&(t.ynx(0),t.YNc(1,Wn,4,6,"span",0),t.BQk()),2&a){const e=t.oxw(2).ngIf;t.xp6(1),t.Q6J("ngIf","CUSTOM"===e)}}function Kn(a,n){if(1&a&&(t.ynx(0),t.YNc(1,Xn,2,1,"ng-container",0),t.ALo(2,"async"),t.BQk()),2&a){const e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,e.customStop$))}}function tr(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",11),t.TgZ(1,"app-text-action",12),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).compareParameter()}),t._uU(2," Comparison "),t.qZA(),t._UZ(3,"span",10),t.TgZ(4,"app-text-action",13),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).chooseRange()}),t.YNc(5,Gn,2,0,"span",0),t.YNc(6,Kn,3,3,"ng-container",0),t.ALo(7,"async"),t.qZA(),t.TgZ(8,"app-text-action",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).loadLatest("PT1M")}),t._uU(9," 1 minute "),t.qZA(),t.TgZ(10,"app-text-action",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).loadLatest("PT5M")}),t._uU(11," 5 minutes "),t.qZA(),t.TgZ(12,"app-text-action",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).loadLatest("PT15M")}),t._uU(13," 15 minutes "),t.qZA(),t.TgZ(14,"app-text-action",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).loadLatest("PT30M")}),t._uU(15," 30 minutes "),t.qZA(),t.TgZ(16,"app-text-action",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).loadLatest("PT1H")}),t._uU(17," 1 hour "),t.qZA(),t.TgZ(18,"app-text-action",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).loadLatest("PT6H")}),t._uU(19," 6 hours "),t.qZA(),t.TgZ(20,"app-text-action",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).loadLatest("PT12H")}),t._uU(21," 12 hours "),t.qZA(),t.TgZ(22,"app-text-action",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).loadLatest("P1D")}),t._uU(23," 1 day "),t.qZA(),t.TgZ(24,"app-text-action",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).loadLatest("P2D")}),t._uU(25," 2 days "),t.qZA(),t.TgZ(26,"app-text-action",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).loadLatest("P1W")}),t._uU(27," 7 days "),t.qZA(),t.TgZ(28,"app-text-action",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).loadLatest("P2W")}),t._uU(29," 14 days "),t.qZA(),t.TgZ(30,"app-text-action",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).loadLatest("P1M")}),t._uU(31," 30 days "),t.qZA(),t.qZA()}if(2&a){const e=n.ngIf,i=t.oxw(2);t.xp6(4),t.Q6J("active","CUSTOM"===e),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==e),t.xp6(1),t.Q6J("ngIf",t.lcZ(7,15,i.customStart$)),t.xp6(2),t.Q6J("active","PT1M"===e),t.xp6(2),t.Q6J("active","PT5M"===e),t.xp6(2),t.Q6J("active","PT15M"===e),t.xp6(2),t.Q6J("active","PT30M"===e),t.xp6(2),t.Q6J("active","PT1H"===e),t.xp6(2),t.Q6J("active","PT6H"===e),t.xp6(2),t.Q6J("active","PT12H"===e),t.xp6(2),t.Q6J("active","P1D"===e),t.xp6(2),t.Q6J("active","P2D"===e),t.xp6(2),t.Q6J("active","P1W"===e),t.xp6(2),t.Q6J("active","P2W"===e),t.xp6(2),t.Q6J("active","P1M"===e)}}function er(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last minute"),t.qZA())}function ar(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 5 minutes"),t.qZA())}function ir(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 15 minutes"),t.qZA())}function nr(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 30 minutes"),t.qZA())}function rr(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last hour"),t.qZA())}function sr(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 6 hours"),t.qZA())}function or(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 12 hours"),t.qZA())}function lr(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 24 hours"),t.qZA())}function cr(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 2 days"),t.qZA())}function pr(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last week"),t.qZA())}function mr(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 2 weeks"),t.qZA())}function ur(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last month"),t.qZA())}function _r(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"the selected range"),t.qZA())}function gr(a,n){if(1&a&&(t.TgZ(0,"span",18),t._uU(1," There is no data for this chart in "),t.ynx(2,19),t.YNc(3,er,2,0,"span",20),t.YNc(4,ar,2,0,"span",20),t.YNc(5,ir,2,0,"span",20),t.YNc(6,nr,2,0,"span",20),t.YNc(7,rr,2,0,"span",20),t.YNc(8,sr,2,0,"span",20),t.YNc(9,or,2,0,"span",20),t.YNc(10,lr,2,0,"span",20),t.YNc(11,cr,2,0,"span",20),t.YNc(12,pr,2,0,"span",20),t.YNc(13,mr,2,0,"span",20),t.YNc(14,ur,2,0,"span",20),t.YNc(15,_r,2,0,"span",21),t.BQk(),t.qZA()),2&a){const e=n.ngIf;t.xp6(2),t.Q6J("ngSwitch",e),t.xp6(1),t.Q6J("ngSwitchCase","PT1M"),t.xp6(1),t.Q6J("ngSwitchCase","PT5M"),t.xp6(1),t.Q6J("ngSwitchCase","PT15M"),t.xp6(1),t.Q6J("ngSwitchCase","PT30M"),t.xp6(1),t.Q6J("ngSwitchCase","PT1H"),t.xp6(1),t.Q6J("ngSwitchCase","PT6H"),t.xp6(1),t.Q6J("ngSwitchCase","PT12H"),t.xp6(1),t.Q6J("ngSwitchCase","P1D"),t.xp6(1),t.Q6J("ngSwitchCase","P2D"),t.xp6(1),t.Q6J("ngSwitchCase","P1W"),t.xp6(1),t.Q6J("ngSwitchCase","P2W"),t.xp6(1),t.Q6J("ngSwitchCase","P1M")}}function dr(a,n){if(1&a&&(t.TgZ(0,"div",16),t.YNc(1,gr,16,13,"span",17),t.ALo(2,"async"),t.qZA()),2&a){const e=t.oxw(4);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,e.range$))}}function hr(a,n){if(1&a&&(t.ynx(0),t.YNc(1,dr,3,3,"div",15),t.BQk()),2&a){const e=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",0===e.samples.length)}}function fr(a,n){if(1&a&&(t.ynx(0),t.YNc(1,hr,2,1,"ng-container",0),t.ALo(2,"async"),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!t.lcZ(2,1,e.dataSource.loading$))}}function xr(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1),t.YNc(2,tr,32,17,"div",2),t.ALo(3,"async"),t.qZA(),t.TgZ(4,"div",3),t.TgZ(5,"app-parameter-plot",4,5),t.NdJ("onVisibleRange",function(r){return t.CHM(e),t.oxw().onVisibleRange(r)})("onManualRangeChange",function(){return t.CHM(e),t.oxw().onManualRangeChange()}),t._UZ(7,"app-parameter-series",6),t.qZA(),t.TgZ(8,"div",7),t.TgZ(9,"div",8),t.TgZ(10,"button",9),t.NdJ("click",function(){return t.CHM(e),t.MAs(6).zoomIn()}),t.TgZ(11,"mat-icon"),t._uU(12,"add"),t.qZA(),t.qZA(),t._UZ(13,"span",10),t.TgZ(14,"button",9),t.NdJ("click",function(){return t.CHM(e),t.MAs(6).zoomOut()}),t.TgZ(15,"mat-icon"),t._uU(16,"remove"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(17,fr,3,3,"ng-container",0),t.ALo(18,"async"),t.qZA(),t.BQk()}if(2&a){const e=n.ngIf,i=t.oxw();t.xp6(2),t.Q6J("ngIf",t.lcZ(3,9,i.range$)),t.xp6(3),t.Q6J("xGrid",!0)("xAxisHeight",24)("dataSource",i.dataSource)("stop",i.missionTime)("removableSeries",!0),t.xp6(2),t.Q6J("parameter",e.qualifiedName)("grid",!0),t.xp6(10),t.Q6J("ngIf",t.lcZ(18,11,i.dataSource.data$))}}let Vt=(()=>{class a{constructor(e,i,r,s,o){this.router=e,this.route=i,this.yamcs=r,this.dialog=s,this.synchronizer=o,this.range$=new T.X("PT15M"),this.customStart$=new T.X(null),this.customStop$=new T.X(null),this.missionTime=r.getMissionTime(),this.initializeOptions();const c=this.route.parent.snapshot.paramMap.get("qualifiedName");this.dataSource=new On(this.yamcs,this.synchronizer),this.parameter$=this.yamcs.yamcsClient.getParameter(this.yamcs.instance,c),this.parameter$.then(m=>{if(m.qualifiedName=c,this.dataSource.addParameter(m),"CUSTOM"===this.range$.value)this.dataSource.updateWindow(this.customStart$.value,this.customStop$.value,[null,null]);else{const d=this.yamcs.getMissionTime(),b=(0,h.rV)(d,this.range$.value);this.dataSource.updateWindow(b,d,[null,null])}this.timeSubscription=this.yamcs.time$.subscribe(()=>{var d;if("CUSTOM"!==this.range$.value){const b=this.yamcs.getMissionTime(),v=(0,h.rV)(b,this.range$.value);null===(d=this.plot)||void 0===d||d.updateWindowOnly(v,b)}})})}ngAfterViewInit(){}initializeOptions(){const e=this.route.snapshot.queryParamMap;e.has("interval")&&(this.range$.next(e.get("interval")),"CUSTOM"===e.get("interval")&&(this.customStart$.next(new Date(e.get("customStart"))),this.customStop$.next(new Date(e.get("customStop"))))),this.updateURL()}onVisibleRange(e){this.customStart$.next(e[0]),this.customStop$.next(e[1])}onManualRangeChange(){this.range$.next("CUSTOM")}loadLatest(e){this.range$.next(e);const i=this.yamcs.getMissionTime(),r=(0,h.rV)(i,e);this.updateURL(),this.dataSource.updateWindow(r,i,[null,null])}chooseRange(){const e=this.plot.getDateRange();e&&this.dialog.open(zn,{width:"400px",data:{start:e[0],stop:e[1]}}).afterClosed().subscribe(r=>{r&&(this.range$.next("CUSTOM"),this.customStart$.next(r.start),this.customStop$.next(r.stop),this.updateURL(),this.dataSource.updateWindow(r.start,r.stop,[null,null]))})}compareParameter(){this.dialog.open(jn,{width:"600px",data:{exclude:this.plot.getParameters()}}).afterClosed().subscribe(i=>{i&&this.yamcs.yamcsClient.getParameter(this.yamcs.instance,i.qualifiedName).then(r=>{const s=new Ot.z;s.parameter=i.qualifiedName,s.color=i.color,s.strokeWidth=i.thickness,r.qualifiedName=i.qualifiedName,this.plot.addParameter(r,s)})})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.range$.value,customStart:"CUSTOM"===this.range$.value?this.customStart$.value:null,customStop:"CUSTOM"===this.range$.value?this.customStop$.value:null},queryParamsHandling:"merge"})}ngOnDestroy(){this.timeSubscription&&this.timeSubscription.unsubscribe(),this.dataSource.disconnect()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.F0),t.Y36(y.gz),t.Y36(Z.C),t.Y36(g.uw),t.Y36(q.j))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(e,i){if(1&e&&t.Gf(Jt.G,5),2&e){let r;t.iGM(r=t.CRH())&&(i.plot=r.first)}},decls:2,vars:3,consts:[[4,"ngIf"],[2,"padding-left","12px","padding-right","12px","padding-top","12px"],["class","plot-top-actions",4,"ngIf"],[1,"plot-container"],["duration","",3,"xGrid","xAxisHeight","dataSource","stop","removableSeries","onVisibleRange","onManualRangeChange"],["plot",""],[3,"parameter","grid"],[1,"zoom-actions"],[1,"zoom-actions-inner","mat-elevation-z1"],["mat-button","",3,"click"],[1,"separator"],[1,"plot-top-actions"],["icon","add_circle_outline",3,"click"],["icon","date_range",3,"active","click"],[3,"active","click"],["class","no-data-message",4,"ngIf"],[1,"no-data-message"],["class","mat-caption","style","color: #777;",4,"ngIf"],[1,"mat-caption",2,"color","#777"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(e,i){1&e&&(t.YNc(0,xr,19,13,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,i.parameter$))},directives:[_.O5,ct.l,Jt.G,Ot.z,C.lW,S.Hw,_.RF,_.n9,_.ED],pipes:[_.Ov,P.i],styles:[".plot-container[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.12);position:absolute;inset:48px 0 0}.zoom-actions[_ngcontent-%COMP%]{position:absolute;bottom:35px;left:0;right:0;margin:0 auto;text-align:center}.zoom-actions-inner[_ngcontent-%COMP%]{display:inline-block;background-color:#fafafa}.zoom-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{line-height:inherit;min-width:0}.no-data-message[_ngcontent-%COMP%]{position:absolute;inset:50% 0 0;margin:0 auto;text-align:center;pointer-events:none}.plot-top-actions[_ngcontent-%COMP%]{height:24px;line-height:24px}.separator[_ngcontent-%COMP%]{border-right:1px solid rgba(0,0,0,.12)}"],changeDetection:0}),a})(),Tr=(()=>{class a{constructor(e,i,r){this.dialogRef=e,this.yamcs=i,this.data=r,this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}],this.downloadURL$=new T.X(null),this.form=new l.cw({start:new l.NI(null),stop:new l.NI(null),delimiter:new l.NI(null,l.kI.required)});let s=r.start,o=r.stop;(!s||!o)&&(o=i.getMissionTime(),s=(0,h.rV)(o,"PT1H")),this.form.setValue({start:r.start?h.Y6(r.start):"",stop:r.stop?h.Y6(r.stop):"",delimiter:"TAB"}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){const e={parameters:this.data.parameter,delimiter:this.form.value.delimiter};this.form.value.start&&(e.start=h.Y6(this.form.value.start)),this.form.value.stop&&(e.stop=h.Y6(this.form.value.stop));const i=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,e);this.downloadURL$.next(i)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription&&this.formChangeSubscription.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(g.so),t.Y36(Z.C),t.Y36(g.WI))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:22,vars:7,consts:[["mat-dialog-title",""],[1,"mat-typography","ya-form"],[3,"formGroup"],["formControlName","start"],["formControlName","stop"],["formControlName","delimiter",3,"options"],["align","end"],["mat-dialog-close","",1,"ya-button"],[3,"link","primary","disabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Export parameter data"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.TgZ(3,"form",2),t.TgZ(4,"label"),t._uU(5," Start "),t._UZ(6,"app-date-time-input",3),t.qZA(),t._UZ(7,"br"),t.TgZ(8,"label"),t._uU(9," Stop "),t._UZ(10,"app-date-time-input",4),t.qZA(),t._UZ(11,"br"),t.TgZ(12,"label"),t._uU(13," CSV column delimiter"),t._UZ(14,"br"),t._UZ(15,"app-select",5),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"mat-dialog-actions",6),t.TgZ(17,"button",7),t._uU(18,"CANCEL"),t.qZA(),t.TgZ(19,"app-download-button",8),t.NdJ("click",function(){return i.closeDialog()}),t.ALo(20,"async"),t._uU(21," DOWNLOAD "),t.qZA(),t.qZA()),2&e&&(t.xp6(3),t.Q6J("formGroup",i.form),t.xp6(12),t.Q6J("options",i.delimiterOptions),t.xp6(4),t.Q6J("link",t.lcZ(20,5,i.downloadURL$))("primary",!0)("disabled",!i.form.valid))},directives:[g.uh,g.xY,l._Y,l.JL,l.sg,Y.Y,l.JJ,l.u,M.P,g.H8,g.ZT,Tt.o],pipes:[_.Ov],encapsulation:2,changeDetection:0}),a})();class br extends k.o2{constructor(n,e){super(),this.yamcs=n,this.qualifiedName=e,this.pageSize=100,this.pvals$=new T.X([]),this.loading$=new T.X(!1)}connect(n){return this.pvals$}isEmpty(){return 0===this.pvals$.value.length}loadParameterValues(n){return this.loading$.next(!0),this.loadPage(Object.assign(Object.assign({},n),{limit:this.pageSize+1})).then(e=>{this.loading$.next(!1),this.pvals$.next(e)})}hasMore(){return null!=this.offscreenRecord}loadPage(n){return this.yamcs.yamcsClient.getParameterValues(this.yamcs.instance,this.qualifiedName,n).then(e=>(this.offscreenRecord=e.length>this.pageSize?e.splice(e.length-1,1)[0]:null,e))}loadMoreData(n){!this.offscreenRecord||this.loadPage(Object.assign(Object.assign({},n),{stop:this.offscreenRecord.generationTime,limit:this.pageSize+1})).then(e=>{const i=this.pvals$.getValue().concat(e);this.pvals$.next(i)})}disconnect(n){this.pvals$.complete(),this.loading$.complete()}}function yr(a,n){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Severity"),t.qZA())}function vr(a,n){if(1&a&&t._UZ(0,"app-alarm-level",20),2&a){const e=t.oxw().$implicit;t.Q6J("level",e.monitoringResult)}}function Zr(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function Ar(a,n){if(1&a&&(t.TgZ(0,"td",17),t.YNc(1,vr,1,1,"app-alarm-level",18),t.YNc(2,Zr,2,0,"span",19),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.monitoringResult),t.xp6(1),t.Q6J("ngIf",!e.monitoringResult)}}function wr(a,n){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Generation Time"),t.qZA())}function Pr(a,n){if(1&a&&(t.TgZ(0,"td",17),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.generationTime)||"-")}}function Sr(a,n){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Reception Time"),t.qZA())}function Cr(a,n){if(1&a&&(t.TgZ(0,"td",17),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.acquisitionTime)||"-")}}function Dr(a,n){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Raw"),t.qZA())}function Ur(a,n){if(1&a&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"value"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.rawValue)||"-")}}function Nr(a,n){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Eng"),t.qZA())}function qr(a,n){if(1&a&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"value"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.engValue)||"-")}}function kr(a,n){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Range Condition"),t.qZA())}function Ir(a,n){if(1&a&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(e.rangeCondition||"-")}}function Yr(a,n){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Acquisition Status"),t.qZA())}function Mr(a,n){if(1&a&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(e.acquisitionStatus||"-")}}function Qr(a,n){1&a&&t._UZ(0,"th",22)}function Jr(a,n){1&a&&t._UZ(0,"td",17)}function Or(a,n){1&a&&t._UZ(0,"tr",23)}function Lr(a,n){1&a&&t._UZ(0,"tr",24)}function Rr(a,n){if(1&a&&(t.TgZ(0,"table",1),t.ynx(1,2),t.YNc(2,yr,2,0,"th",3),t.YNc(3,Ar,3,2,"td",4),t.BQk(),t.ynx(4,5),t.YNc(5,wr,2,0,"th",3),t.YNc(6,Pr,3,3,"td",4),t.BQk(),t.ynx(7,6),t.YNc(8,Sr,2,0,"th",3),t.YNc(9,Cr,3,3,"td",4),t.BQk(),t.ynx(10,7),t.YNc(11,Dr,2,0,"th",3),t.YNc(12,Ur,3,3,"td",8),t.BQk(),t.ynx(13,9),t.YNc(14,Nr,2,0,"th",3),t.YNc(15,qr,3,3,"td",8),t.BQk(),t.ynx(16,10),t.YNc(17,kr,2,0,"th",3),t.YNc(18,Ir,2,1,"td",4),t.BQk(),t.ynx(19,11),t.YNc(20,Yr,2,0,"th",3),t.YNc(21,Mr,2,1,"td",4),t.BQk(),t.ynx(22,12),t.YNc(23,Qr,1,0,"th",13),t.YNc(24,Jr,1,0,"td",4),t.BQk(),t.YNc(25,Or,1,0,"tr",14),t.YNc(26,Lr,1,0,"tr",15),t.qZA()),2&a){const e=t.oxw();t.Q6J("dataSource",e.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}let Vr=(()=>{class a{constructor(){this.displayedColumns=["severity","generationTime","rawValue","engValue","rangeCondition","acquisitionStatus","actions"]}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-parameter-values-table"]],inputs:{dataSource:"dataSource"},decls:1,vars:1,consts:[["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","receptionTime"],["matColumnDef","rawValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","engValue"],["matColumnDef","rangeCondition"],["matColumnDef","acquisitionStatus"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level",4,"ngIf"],[4,"ngIf"],[3,"level"],["mat-cell","",1,"wrap200"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,i){1&e&&t.YNc(0,Rr,27,3,"table",0),2&e&&t.Q6J("ngIf",i.dataSource)},directives:[_.O5,u.BZ,u.w1,u.fO,u.ge,u.Dz,u.ev,H.i,u.as,u.XQ,u.nj,u.Gk],pipes:[P.i,I.V],encapsulation:2,changeDetection:0}),a})();function Fr(a,n){if(1&a){const e=t.EpF();t.ynx(0),t._UZ(1,"app-date-time-input",10),t._UZ(2,"app-date-time-input",11),t.TgZ(3,"button",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().applyCustomDates()}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.filterForm.invalid)}}function $r(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",13),t.NdJ("click",function(){return t.CHM(e),t.oxw().jumpToNow()}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function Er(a,n){1&a&&t._UZ(0,"app-dots")}function Hr(a,n){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last hour"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function Br(a,n){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last 6 hours"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function jr(a,n){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last 24 hours"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function zr(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"all time"),t.qZA(),t.qZA())}function Gr(a,n){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3),t.ALo(4,"datetime"),t.qZA(),t._uU(5," to "),t.TgZ(6,"b"),t._uU(7),t.ALo(8,"datetime"),t.qZA(),t._uU(9," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,2,e.validStart)),t.xp6(4),t.Oqu(t.lcZ(8,4,e.validStop))}}function Wr(a,n){1&a&&(t.TgZ(0,"app-empty-message"),t._uU(1," No records found matching current filter in the selected time range. "),t.qZA())}function Xr(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"mat-toolbar"),t._UZ(1,"span",14),t.TgZ(2,"button",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().loadMoreData()}),t._uU(3,"Load More"),t.qZA(),t._UZ(4,"span",14),t.qZA()}if(2&a){const e=t.oxw();t.xp6(2),t.Q6J("disabled",!e.dataSource.hasMore())}}const Q="PT1H";let Ft=(()=>{class a{constructor(e,i,r,s){this.route=e,this.router=i,this.yamcs=r,this.dialog=s,this.intervalOptions=[{id:"PT1H",label:"Last Hour"},{id:"PT6H",label:"Last 6 Hours"},{id:"P1D",label:"Last 24 Hours"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}],this.filterForm=new l.cw({interval:new l.NI(Q),customStart:new l.NI(null),customStop:new l.NI(null)}),this.downloadURL$=new T.X(null),this.qualifiedName=e.parent.snapshot.paramMap.get("qualifiedName"),this.dataSource=new br(r,this.qualifiedName),this.validStop=r.getMissionTime(),this.validStart=h.rV(this.validStop,Q),this.appliedInterval=Q,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(o=>{if("CUSTOM"===o){const c=this.validStart||this.yamcs.getMissionTime(),m=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(h.Y6(c)),this.filterForm.get("customStop").setValue(h.Y6(m))}else"NO_LIMIT"===o?(this.validStart=null,this.validStop=null,this.appliedInterval=o,this.loadData()):(this.validStop=r.getMissionTime(),this.validStart=h.rV(this.validStop,o),this.appliedInterval=o,this.loadData())})}initializeOptions(){const e=this.route.snapshot.queryParamMap;if(e.has("interval"))if(this.appliedInterval=e.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const i=e.get("customStart");this.filterForm.get("customStart").setValue(i),this.validStart=new Date(i);const r=e.get("customStop");this.filterForm.get("customStop").setValue(r),this.validStop=new Date(r)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=(0,h.rV)(this.validStop,this.appliedInterval));else this.appliedInterval=Q,this.validStop=this.yamcs.getMissionTime(),this.validStart=(0,h.rV)(this.validStop,Q)}jumpToNow(){const e=this.filterForm.value.interval;"NO_LIMIT"===e?this.filterForm.get("interval").setValue(Q):(this.validStop=this.yamcs.getMissionTime(),this.validStart=h.rV(this.validStop,e),this.loadData())}applyCustomDates(){this.validStart=h.ZU(this.filterForm.value.customStart),this.validStop=h.ZU(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const e={};if(this.validStart){const i=new Date(this.validStart.getTime());i.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),e.start=i.toISOString()}this.validStop&&(e.stop=this.validStop.toISOString()),this.dataSource.loadParameterValues(e)}loadMoreData(){const e={};if(this.validStart){const i=new Date(this.validStart.getTime());i.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),e.start=i.toISOString()}this.dataSource.loadMoreData(e)}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}exportParameterData(){this.dialog.open(Tr,{width:"400px",data:{parameter:this.qualifiedName,start:this.validStart,stop:this.validStop}})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.gz),t.Y36(y.F0),t.Y36(Z.C),t.Y36(g.uw))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:21,vars:18,consts:[[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],[4,"ngIf"],[1,"table-status",3,"ngSwitch"],[1,"message-zone"],[3,"click"],[4,"ngSwitchCase"],[3,"dataSource"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],[2,"flex","1 1 auto"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"form",1),t.TgZ(2,"div",2),t._UZ(3,"app-select",3),t.YNc(4,Fr,5,1,"ng-container",4),t.YNc(5,$r,3,0,"ng-container",4),t.YNc(6,Er,1,0,"app-dots",4),t.ALo(7,"async"),t.qZA(),t.qZA(),t.TgZ(8,"div",5),t.TgZ(9,"div",6),t.TgZ(10,"app-text-action",7),t.NdJ("click",function(){return i.exportParameterData()}),t._uU(11,"Download Data"),t.qZA(),t.qZA(),t.YNc(12,Hr,9,3,"span",8),t.YNc(13,Br,9,3,"span",8),t.YNc(14,jr,9,3,"span",8),t.YNc(15,zr,4,0,"span",8),t.YNc(16,Gr,10,6,"span",8),t.qZA(),t._UZ(17,"app-parameter-values-table",9),t.YNc(18,Wr,2,0,"app-empty-message",4),t.YNc(19,Xr,5,1,"mat-toolbar",4),t.ALo(20,"async"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("formGroup",i.filterForm),t.xp6(2),t.Q6J("options",i.intervalOptions),t.xp6(1),t.Q6J("ngIf","CUSTOM"===i.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==i.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf",t.lcZ(7,14,i.dataSource.loading$)),t.xp6(2),t.Q6J("ngSwitch",i.appliedInterval),t.xp6(4),t.Q6J("ngSwitchCase","PT1H"),t.xp6(1),t.Q6J("ngSwitchCase","PT6H"),t.xp6(1),t.Q6J("ngSwitchCase","P1D"),t.xp6(1),t.Q6J("ngSwitchCase","NO_LIMIT"),t.xp6(1),t.Q6J("ngSwitchCase","CUSTOM"),t.xp6(1),t.Q6J("dataSource",i.dataSource),t.xp6(1),t.Q6J("ngIf",i.dataSource.isEmpty()),t.xp6(1),t.Q6J("ngIf",!t.lcZ(20,16,i.dataSource.loading$)&&!i.dataSource.isEmpty()))},directives:[l._Y,l.JL,l.sg,M.P,l.JJ,l.u,_.O5,Y.Y,ot.b,_.RF,ct.l,_.n9,Vr,z.M,lt.Ye],pipes:[_.Ov,P.i],styles:[".table-status[_ngcontent-%COMP%]{background-color:#f7f7f7;height:24px;line-height:24px;font-size:12px;padding-left:6px}.table-status[_ngcontent-%COMP%]   .message-zone[_ngcontent-%COMP%]{float:right;height:24px;line-height:24px;font-size:12px;padding-right:6px}"],changeDetection:0}),a})();var $t=p(3494),Kr=p(3748),ts=p(471),K=p(6057);function es(a,n){if(1&a&&(t.TgZ(0,"option",10),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.Q6J("value",e.label),t.xp6(1),t.hij(" ",e.label,"")}}function as(a,n){if(1&a&&(t.TgZ(0,"label"),t.TgZ(1,"div",4),t.TgZ(2,"div",5),t._uU(3),t.qZA(),t.qZA(),t._uU(4),t._UZ(5,"app-errors",6),t.TgZ(6,"select",7),t.TgZ(7,"option",8),t._uU(8," -- select an option -- "),t.qZA(),t.YNc(9,es,2,2,"option",9),t.qZA(),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.xp6(3),t.Oqu(i.parameter.type.engType),t.xp6(1),t.hij(" ",i.parameter.name," "),t.xp6(1),t.Q6J("controlName",e),t.xp6(1),t.Q6J("formControlName",e),t.xp6(3),t.Q6J("ngForOf",i.parameter.type.enumValue)}}function is(a,n){if(1&a&&(t.TgZ(0,"label"),t._uU(1),t._UZ(2,"app-errors",6),t._UZ(3,"br"),t._UZ(4,"input",11),t._uU(5," true"),t._UZ(6,"br"),t._UZ(7,"input",12),t._uU(8," false "),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.xp6(1),t.hij(" ",i.parameter.name," "),t.xp6(1),t.Q6J("controlName",e),t.xp6(2),t.Q6J("formControlName",e),t.xp6(3),t.Q6J("formControlName",e)}}function ns(a,n){if(1&a&&(t.TgZ(0,"label"),t._uU(1),t._UZ(2,"app-errors",6),t._UZ(3,"app-date-time-input",7),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.xp6(1),t.hij(" ",i.parameter.name," "),t.xp6(1),t.Q6J("controlName",e),t.xp6(1),t.Q6J("formControlName",e)}}function rs(a,n){if(1&a&&(t.TgZ(0,"label"),t.TgZ(1,"div",4),t.TgZ(2,"div",5),t.ALo(3,"async"),t._uU(4),t.qZA(),t.qZA(),t._uU(5),t._UZ(6,"app-errors",6,13),t._UZ(8,"app-binary-input",7),t.qZA()),2&a){const e=t.MAs(7),i=t.oxw().ngIf,r=t.oxw();t.xp6(2),t.ekj("error",t.lcZ(3,6,e.invalid$)),t.xp6(2),t.Oqu(r.parameter.type.engType),t.xp6(1),t.hij(" ",r.parameter.name," "),t.xp6(1),t.Q6J("controlName",i),t.xp6(2),t.Q6J("formControlName",i)}}function ss(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"app-parameter-form",16),t._UZ(2,"br"),t.BQk()),2&a){const e=n.$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("parameter",e)("formGroup",i.formGroup)("parent",i.parent?i.parent+"."+i.parameter.name:i.parameter.name)}}function os(a,n){if(1&a&&(t.TgZ(0,"label"),t.TgZ(1,"div",4),t.TgZ(2,"div",5),t._uU(3),t.qZA(),t.qZA(),t._uU(4),t.TgZ(5,"div",14),t.YNc(6,ss,3,3,"ng-container",15),t.qZA(),t.qZA()),2&a){const e=t.oxw(2);t.xp6(3),t.Oqu(e.parameter.type.engType),t.xp6(1),t.hij(" ",e.parameter.name," "),t.xp6(2),t.Q6J("ngForOf",null==e.parameter.type?null:e.parameter.type.member)}}function ls(a,n){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function cs(a,n){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function ps(a,n){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function ms(a,n){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function us(a,n){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function _s(a,n){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function gs(a,n){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function ds(a,n){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function hs(a,n){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function fs(a,n){if(1&a&&(t.TgZ(0,"div",5),t._uU(1),t.ALo(2,"units"),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e.parameter.type?null:e.parameter.type.unitSet)," ")}}function xs(a,n){if(1&a&&(t.TgZ(0,"label"),t.TgZ(1,"div",4),t.ALo(2,"async"),t.YNc(3,fs,3,3,"div",17),t.TgZ(4,"div",5),t._uU(5),t.qZA(),t.qZA(),t._uU(6),t._UZ(7,"app-errors",6,13),t._UZ(9,"input",18),t.qZA()),2&a){const e=t.MAs(8),i=t.oxw().ngIf,r=t.oxw();t.xp6(1),t.ekj("error",t.lcZ(2,7,e.invalid$)),t.xp6(2),t.Q6J("ngIf",null==r.parameter.type?null:r.parameter.type.unitSet),t.xp6(2),t.Oqu(r.parameter.type.engType),t.xp6(1),t.hij(" ",r.parameter.name," "),t.xp6(1),t.Q6J("controlName",i),t.xp6(2),t.Q6J("formControlName",i)}}function Ts(a,n){if(1&a&&(t.ynx(0,1),t.YNc(1,as,10,5,"label",2),t.YNc(2,is,9,4,"label",2),t.YNc(3,ns,4,3,"label",2),t.YNc(4,rs,9,8,"label",2),t.YNc(5,os,7,3,"label",2),t.YNc(6,ls,2,0,"ng-container",2),t.YNc(7,cs,2,0,"ng-container",2),t.YNc(8,ps,2,0,"ng-container",2),t.YNc(9,ms,2,0,"ng-container",2),t.YNc(10,us,2,0,"ng-container",2),t.YNc(11,_s,2,0,"ng-container",2),t.YNc(12,gs,2,0,"ng-container",2),t.YNc(13,ds,2,0,"ng-container",2),t.YNc(14,hs,2,0,"ng-container",2),t.YNc(15,xs,10,9,"label",3),t.BQk()),2&a){const e=t.oxw();t.Q6J("formGroup",e.formGroup)("ngSwitch",null==e.parameter.type?null:e.parameter.type.engType),t.xp6(1),t.Q6J("ngSwitchCase","enumeration"),t.xp6(1),t.Q6J("ngSwitchCase","boolean"),t.xp6(1),t.Q6J("ngSwitchCase","time"),t.xp6(1),t.Q6J("ngSwitchCase","binary"),t.xp6(1),t.Q6J("ngSwitchCase","aggregate"),t.xp6(1),t.Q6J("ngSwitchCase","float[]"),t.xp6(1),t.Q6J("ngSwitchCase","double[]"),t.xp6(1),t.Q6J("ngSwitchCase","integer[]"),t.xp6(1),t.Q6J("ngSwitchCase","enumeration[]"),t.xp6(1),t.Q6J("ngSwitchCase","string[]"),t.xp6(1),t.Q6J("ngSwitchCase","boolean[]"),t.xp6(1),t.Q6J("ngSwitchCase","time[]"),t.xp6(1),t.Q6J("ngSwitchCase","binary[]"),t.xp6(1),t.Q6J("ngSwitchCase","aggregate[]")}}let bs=(()=>{class a{constructor(){this.controlName$=new T.X(null)}ngOnInit(){this.controlName$.next(this.parent?this.parent+"."+this.parameter.name:this.parameter.name)}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-parameter-form"]],inputs:{formGroup:"formGroup",parameter:"parameter",parent:"parent"},decls:2,vars:3,consts:[[3,"formGroup","ngSwitch",4,"ngIf"],[3,"formGroup","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"meta"],[1,"item"],[3,"controlName"],[3,"formControlName"],["hidden","","disabled","","selected","","value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","radio","value","true",3,"formControlName"],["type","radio","value","false",3,"formControlName"],["err",""],[1,"members"],[4,"ngFor","ngForOf"],[3,"parameter","formGroup","parent"],["class","item",4,"ngIf"],["type","text",3,"formControlName"]],template:function(e,i){1&e&&(t.YNc(0,Ts,16,16,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,i.controlName$))},directives:[_.O5,l.JL,l.sg,_.RF,_.n9,Kr.D,l.EJ,l.JJ,l.u,l.YN,l.Kr,_.sg,l._,l.Fj,Y.Y,ts.Y,a,_.ED],pipes:[_.Ov,K.H],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px}"],changeDetection:0}),a})(),ys=(()=>{class a{constructor(e,i){this.dialogRef=e,this.data=i,this.form=new l.cw({}),this.parameter=i.parameter;const r=this.getValidatorsForType(this.parameter.type);"aggregate"===this.parameter.type.engType?this.addMemberControls(this.parameter.name+".",this.parameter.type.member||[]):this.form.addControl(this.parameter.name,new l.NI(null,r))}addMemberControls(e,i){for(const r of i)if("aggregate"===r.type.engType)this.addMemberControls(e+r.name+".",r.type.member||[]);else{const s=e+r.name,o=this.getValidatorsForType(r.type);this.form.addControl(s,new l.NI("",o))}}getValidatorsForType(e){const i=[l.kI.required];return"integer"===e.engType?i.push($t.V):"float"===e.engType&&i.push($t.H),i}save(){const e=this.toValue("",this.parameter);this.dialogRef.close(e)}toValue(e,i){const r=this.form.value[e+i.name];switch(i.type.engType){case"boolean":return{type:"BOOLEAN",booleanValue:"true"===r};case"float":return{type:"FLOAT",floatValue:r};case"double":return{type:"DOUBLE",doubleValue:r};case"enumeration":case"string":return{type:"STRING",stringValue:r};case"integer":return{type:"SINT32",sint32Value:r};case"time":return{type:"TIMESTAMP",stringValue:h.Y6(r)};case"binary":return{type:"BINARY",binaryValue:h.MU(r)};case"aggregate":const s=[],o=[];for(const c of i.type.member||[])s.push(c.name),o.push(this.toValue(e+i.name+".",c));return{type:"AGGREGATE",aggregateValue:{name:s,value:o}};default:throw new Error(`Unexpected type: ${i.type.engType}`)}}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(g.so),t.Y36(g.WI))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-set-parameter-dialog"]],decls:10,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],[3,"parameter","formGroup"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Set parameter value"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.TgZ(3,"form",2),t._UZ(4,"app-parameter-form",3),t.qZA(),t.qZA(),t.TgZ(5,"mat-dialog-actions",4),t.TgZ(6,"button",5),t._uU(7,"CANCEL"),t.qZA(),t.TgZ(8,"button",6),t.NdJ("click",function(){return i.save()}),t._uU(9,"SAVE"),t.qZA(),t.qZA()),2&e&&(t.xp6(3),t.Q6J("formGroup",i.form),t.xp6(1),t.Q6J("parameter",i.parameter)("formGroup",i.form),t.xp6(4),t.Q6J("disabled",!i.form.valid))},directives:[g.uh,g.xY,l._Y,l.JL,l.sg,bs,g.H8,g.ZT],encapsulation:2}),a})();var vs=p(7147),Et=p(3251),Ht=p(4302),Bt=p(3995);const Zs=function(a,n){return{c:a,system:n}};function As(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",11),t._uU(2),t.qZA(),t._uU(3),t.ALo(4,"shortName"),t.ALo(5,"async"),t._UZ(6,"app-title-copy",12),t.ALo(7,"async"),t.BQk()),2&a){const e=n.ngIf,i=t.oxw().ngIf,r=t.oxw();t.xp6(1),t.Q6J("queryParams",t.WLB(11,Zs,r.yamcs.context,e)),t.xp6(1),t.hij(" ",e," "),t.xp6(1),t.AsE("/",t.lcZ(4,5,i.qualifiedName),"",t.lcZ(5,7,r.offset$)," "),t.xp6(3),t.Q6J("text",i.qualifiedName+(t.lcZ(7,9,r.offset$)||""))}}function ws(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).setParameter()}),t.TgZ(1,"mat-icon"),t._uU(2,"edit"),t.qZA(),t._uU(3," SET VALUE "),t.qZA()}}const Ps=function(a){return["/mdb/parameters",a]},F=function(a){return{c:a}};function Ss(a,n){if(1&a&&(t.TgZ(0,"a",14),t.TgZ(1,"mat-icon"),t._uU(2,"auto_stories"),t.qZA(),t._uU(3," VIEW IN MDB "),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.Q6J("routerLink",t.VKq(2,Ps,e.qualifiedName))("queryParams",t.VKq(4,F,i.yamcs.context))}}function Cs(a,n){if(1&a&&(t.TgZ(0,"a",15,16),t._uU(2," Chart "),t.qZA()),2&a){const e=t.MAs(1),i=t.oxw(2);t.Q6J("active",e.isActive)("queryParams",t.VKq(2,F,i.yamcs.context))}}function Ds(a,n){if(1&a&&(t.TgZ(0,"a",17,18),t._uU(2," Alarm History "),t.qZA()),2&a){const e=t.MAs(1),i=t.oxw(2);t.Q6J("active",e.isActive)("queryParams",t.VKq(2,F,i.yamcs.context))}}function Us(a,n){if(1&a&&(t.TgZ(0,"a",19,20),t._uU(2," Historical Data "),t.qZA()),2&a){const e=t.MAs(1),i=t.oxw(2);t.Q6J("active",e.isActive)("queryParams",t.VKq(2,F,i.yamcs.context))}}function Ns(a,n){if(1&a&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar"),t.YNc(2,As,8,14,"ng-container",0),t.ALo(3,"spaceSystemName"),t._uU(4," \xa0\xa0\xa0 "),t.YNc(5,ws,4,0,"button",1),t.ALo(6,"async"),t.YNc(7,Ss,4,6,"a",2),t.qZA(),t.TgZ(8,"nav",3,4),t.TgZ(10,"a",5,6),t._uU(12," Summary "),t.qZA(),t.YNc(13,Cs,3,4,"a",7),t.YNc(14,Ds,3,4,"a",8),t.YNc(15,Us,3,4,"a",9),t.qZA(),t.TgZ(16,"div",10),t._UZ(17,"router-outlet"),t.qZA(),t.qZA()),2&a){const e=n.ngIf,i=t.MAs(9),r=t.MAs(11),s=t.oxw();t.xp6(2),t.Q6J("ngIf",t.lcZ(3,10,e.qualifiedName)),t.xp6(3),t.Q6J("ngIf",s.isWritable()&&s.maySetParameter()&&!t.lcZ(6,12,s.offset$)),t.xp6(2),t.Q6J("ngIf",s.mayReadMissionDatabase()),t.xp6(3),t.Q6J("active",r.isActive)("queryParams",t.VKq(14,F,s.yamcs.context)),t.xp6(3),t.Q6J("ngIf",s.config.tmArchive),t.xp6(1),t.Q6J("ngIf",s.mayReadAlarms()),t.xp6(1),t.Q6J("ngIf",s.config.tmArchive),t.xp6(1),t.ekj("noscroll",1===i.selectedIndex)}}let jt=(()=>{class a{constructor(e,i,r,s,o,c,m,x,d){this.yamcs=i,this.authService=r,this.messageService=s,this.dialog=o,this.title=c,this.valuePipe=m,this.unitsPipe=x,this.parameter$=new T.X(null),this.offset$=new T.X(null),this.parameterValue$=new T.X(null),this.config=d.getConfig(),e.paramMap.subscribe(b=>{const v=b.get("qualifiedName");this.changeParameter(v)})}changeParameter(e){this.yamcs.yamcsClient.getParameter(this.yamcs.instance,e).then(i=>{this.parameter$.next(i),this.offset$.next(e!==i.qualifiedName?e.substring(i.qualifiedName.length):null),this.updateTitle()}).catch(i=>{this.messageService.showError(i)}),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:e}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},i=>{this.parameterValue$.next(i.values?i.values[0]:null),this.updateTitle()})}updateTitle(){const e=this.parameter$.getValue(),i=this.offset$.getValue();if(e){let r=e.name;i&&(r+=i);const s=this.parameterValue$.getValue();s&&(r+=": "+this.valuePipe.transform(s.engValue),e.type&&e.type.unitSet&&(r+=" "+this.unitsPipe.transform(e.type.unitSet)),s.rangeCondition&&"LOW"===s.rangeCondition?r+=" \u2193":s.rangeCondition&&"HIGH"===s.rangeCondition&&(r+=" \u2191")),this.title.setTitle(r)}}isWritable(){const e=this.parameter$.value;return!!e&&("LOCAL"===e.dataSource||"EXTERNAL1"===e.dataSource||"EXTERNAL2"===e.dataSource||"EXTERNAL3"===e.dataSource)}maySetParameter(){const e=this.parameter$.value;return!!e&&this.authService.getUser().hasObjectPrivilege("WriteParameter",e.qualifiedName)}mayReadAlarms(){return this.authService.getUser().hasSystemPrivilege("ReadAlarms")}mayReadMissionDatabase(){return this.authService.getUser().hasSystemPrivilege("GetMissionDatabase")}setParameter(){const e=this.parameter$.value;this.dialog.open(ys,{width:"400px",data:{parameter:this.parameter$.value}}).afterClosed().subscribe(r=>{r&&this.yamcs.yamcsClient.setParameterValue(this.yamcs.instance,this.yamcs.processor,e.qualifiedName,r).catch(s=>this.messageService.showError(s))})}ngOnDestroy(){this.parameterValueSubscription&&this.parameterValueSubscription.cancel()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.gz),t.Y36(Z.C),t.Y36(G.e),t.Y36(et.e),t.Y36(g.uw),t.Y36(O.Dx),t.Y36(I.V),t.Y36(K.H),t.Y36(J.E))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"routerLink","queryParams",4,"ngIf"],["mat-tab-nav-bar","",1,"secondary"],["tabs",""],["mat-tab-link","","routerLink","summary","routerLinkActive","",3,"active","queryParams"],["rla","routerLinkActive"],["mat-tab-link","","routerLink","chart","routerLinkActive","",3,"active","queryParams",4,"ngIf"],["mat-tab-link","","routerLink","alarms","routerLinkActive","",3,"active","queryParams",4,"ngIf"],["mat-tab-link","","routerLink","data","routerLinkActive","",3,"active","queryParams",4,"ngIf"],[1,"tab-content-wrapper"],["routerLink","/telemetry/parameters",1,"ya-link","ya-header-link",3,"queryParams"],[3,"text"],["mat-button","","color","primary",3,"click"],["mat-button","","color","primary",3,"routerLink","queryParams"],["mat-tab-link","","routerLink","chart","routerLinkActive","",3,"active","queryParams"],["rlb","routerLinkActive"],["mat-tab-link","","routerLink","alarms","routerLinkActive","",3,"active","queryParams"],["rlc","routerLinkActive"],["mat-tab-link","","routerLink","data","routerLinkActive","",3,"active","queryParams"],["rld","routerLinkActive"]],template:function(e,i){1&e&&(t.YNc(0,Ns,18,16,"app-instance-page",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,i.parameter$))},directives:[_.O5,L.a,R.k,y.yS,vs.Y,C.lW,S.Hw,C.zs,Et.BU,Et.Nj,y.Od,y.lC],pipes:[_.Ov,Ht.B,Bt.y],styles:[".tab-content-wrapper[_ngcontent-%COMP%]{position:absolute;inset:37px 0 0;overflow:auto}.tab-content-wrapper.noscroll[_ngcontent-%COMP%]{overflow:hidden}"],changeDetection:0}),a})();var zt=p(6087),Gt=p(4574);class ks extends k.o2{constructor(n,e,i){super(),this.yamcs=n,this.synchronizer=e,this.memberPathPipe=i,this.items$=new T.X([]),this.totalSize$=new T.X(0),this.loading$=new T.X(!1),this.idMapping={},this.latestValues=new Map}connect(){return this.syncSubscription=this.synchronizer.syncFast(()=>{this.refreshTable()}),this.items$}loadParameters(n){return function(a,n,e,i){return new(e||(e=Promise))(function(s,o){function c(d){try{x(i.next(d))}catch(b){o(b)}}function m(d){try{x(i.throw(d))}catch(b){o(b)}}function x(d){d.done?s(d.value):function r(s){return s instanceof e?s:new e(function(o){o(s)})}(d.value).then(c,m)}x((i=i.apply(a,n||[])).next())})}(this,void 0,void 0,function*(){return this.loading$.next(!0),this.dataSubscription&&(this.dataSubscription.cancel(),this.dataSubscription=void 0),this.yamcs.yamcsClient.getParameters(this.yamcs.instance,n).then(e=>{this.loading$.next(!1),this.totalSize$.next(e.totalSize);const i=[];for(const r of e.spaceSystems||[])i.push({spaceSystem:!0,name:r});for(const r of e.parameters||[])i.push({spaceSystem:!1,name:this.memberPathPipe.transform(r),parameter:r});this.items$.next(i),this.startSubscription(e.parameters||[])})})}refreshTable(){const n=this.items$.value;for(const e of n)e.spaceSystem||(e.pval=this.latestValues.get(e.name));this.items$.next([...n])}startSubscription(n){const e=n.map(i=>({name:this.memberPathPipe.transform(i)}));e.length&&(this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:e,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},i=>{i.mapping&&(this.idMapping=i.mapping,this.latestValues.clear()),this.processDelivery(i.values||[])}))}processDelivery(n){for(const e of n){const i=this.idMapping[e.numericId];i&&this.latestValues.set(i.name,e)}}getAliasNamespaces(){var n;const e=[];for(const i of this.items$.value)if(null===(n=i.parameter)||void 0===n?void 0:n.alias)for(const r of i.parameter.alias)r.namespace&&-1===e.indexOf(r.namespace)&&e.push(r.namespace);return e.sort()}disconnect(){this.syncSubscription&&this.syncSubscription.unsubscribe(),this.dataSubscription&&this.dataSubscription.cancel(),this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}}var Is=p(9971),Ys=p(8726),Wt=p(4165),Ms=p(1672);const Qs=["top"];function Js(a,n){if(1&a&&t._UZ(0,"app-breadcrumb",17),2&a){const e=n.$implicit;t.Q6J("link",e.route)("queryParams",e.queryParams)("label",e.name)}}const Xt=function(a){return{c:a}};function Os(a,n){if(1&a&&(t.TgZ(0,"div",4),t.TgZ(1,"app-breadcrumb-trail"),t._UZ(2,"app-breadcrumb",15),t.YNc(3,Js,1,3,"app-breadcrumb",16),t.qZA(),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.xp6(2),t.Q6J("queryParams",t.VKq(2,Xt,i.yamcs.context)),t.xp6(1),t.Q6J("ngForOf",e)}}function Ls(a,n){if(1&a&&(t.ynx(0),t.YNc(1,Os,4,4,"div",14),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.Q6J("ngIf",e.length)}}function Rs(a,n){1&a&&(t.TgZ(0,"th",36),t._uU(1,"Name"),t.qZA())}const Vs=function(){return["/telemetry/parameters"]},Fs=function(a,n){return{c:a,system:n}};function $s(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",38),t._uU(2,"folder"),t.qZA(),t.TgZ(3,"a",39),t._uU(4),t.ALo(5,"filename"),t.qZA(),t.BQk()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(3),t.Q6J("routerLink",t.DdM(5,Vs))("queryParams",t.WLB(6,Fs,i.yamcs.context,e.name)),t.xp6(1),t.hij(" ",t.lcZ(5,3,e.name),"/ ")}}function Es(a,n){if(1&a&&t._UZ(0,"app-highlight",41),2&a){const e=t.oxw(2).$implicit,i=t.oxw(2);t.Q6J("text",e.name)("term",i.filterForm.value.filter)}}function Hs(a,n){if(1&a&&(t._UZ(0,"app-highlight",41),t.ALo(1,"slice")),2&a){const e=t.oxw(2).$implicit,i=t.oxw(2);t.Q6J("text",t.xi3(1,2,e.name,i.system.length+1))("term",i.filterForm.value.filter)}}const Bs=function(a){return["/telemetry/parameters",a]};function js(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",38),t._uU(2,"toll"),t.qZA(),t.TgZ(3,"a",39),t.YNc(4,Es,1,2,"app-highlight",40),t.YNc(5,Hs,2,5,"app-highlight",40),t.qZA(),t.BQk()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(3),t.Q6J("routerLink",t.VKq(4,Bs,e.name))("queryParams",t.VKq(6,Xt,i.yamcs.context)),t.xp6(1),t.Q6J("ngIf",!i.system),t.xp6(1),t.Q6J("ngIf",i.system)}}function zs(a,n){if(1&a&&(t.TgZ(0,"td",37),t.YNc(1,$s,6,9,"ng-container",3),t.YNc(2,js,6,8,"ng-container",3),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.spaceSystem),t.xp6(1),t.Q6J("ngIf",!e.spaceSystem)}}function Gs(a,n){1&a&&(t.TgZ(0,"th",42),t._uU(1,"Raw value"),t.qZA())}function Ws(a,n){if(1&a&&(t.TgZ(0,"td",43),t._uU(1),t.ALo(2,"value"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e.pval?null:e.pval.rawValue)||"-"," ")}}function Xs(a,n){1&a&&(t.TgZ(0,"th",42),t._uU(1,"Value"),t.qZA())}function Ks(a,n){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"units"),t.ALo(3,"parameterTypeForPath"),t.qZA()),2&a){const e=t.oxw(2).$implicit;let i;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==(i=t.lcZ(3,3,e.parameter))?null:i.unitSet)," ")}}function to(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function eo(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function ao(a,n){if(1&a&&(t.TgZ(0,"app-expirable",45),t._uU(1),t.ALo(2,"value"),t.YNc(3,Ks,4,5,"span",3),t.YNc(4,to,2,0,"span",3),t.YNc(5,eo,2,0,"span",3),t.qZA()),2&a){const e=t.oxw().$implicit;t.Q6J("pval",e.pval),t.xp6(1),t.hij(" ",t.lcZ(2,5,null==e.pval?null:e.pval.engValue)||"-"," "),t.xp6(2),t.Q6J("ngIf",null==e.parameter||null==e.parameter.type?null:e.parameter.type.unitSet),t.xp6(1),t.Q6J("ngIf","LOW"===(null==e.pval?null:e.pval.rangeCondition)),t.xp6(1),t.Q6J("ngIf","HIGH"===(null==e.pval?null:e.pval.rangeCondition))}}function io(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function no(a,n){if(1&a&&(t.TgZ(0,"td",43),t.YNc(1,ao,6,7,"app-expirable",44),t.YNc(2,io,2,0,"span",3),t.qZA()),2&a){const e=n.$implicit;t.ekj("alert",(null==e.pval?null:e.pval.monitoringResult)&&"IN_LIMITS"!==(null==e.pval?null:e.pval.monitoringResult)),t.xp6(1),t.Q6J("ngIf",e.pval),t.xp6(1),t.Q6J("ngIf",!e.pval)}}function ro(a,n){1&a&&(t.TgZ(0,"th",36),t._uU(1,"Type"),t.qZA())}function so(a,n){if(1&a&&(t.TgZ(0,"span",47),t._uU(1),t.qZA()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",e," ")}}function oo(a,n){if(1&a&&(t.TgZ(0,"td",43),t.YNc(1,so,2,1,"span",46),t.ALo(2,"parameterTypeForPath"),t.qZA()),2&a){const e=n.$implicit;t.oxw(2);const i=t.MAs(21);let r;t.xp6(1),t.Q6J("ngIf",null==(r=t.lcZ(2,2,e.parameter))?null:r.engType)("ngIfElse",i)}}function lo(a,n){1&a&&(t.TgZ(0,"th",36),t._uU(1,"Data Source"),t.qZA())}function co(a,n){if(1&a&&(t.TgZ(0,"td",43),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,null==e.parameter?null:e.parameter.dataSource)||"-")}}function po(a,n){1&a&&(t.TgZ(0,"th",42),t._uU(1,"Description"),t.qZA())}function mo(a,n){if(1&a&&(t.TgZ(0,"td",43),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu((null==e.parameter?null:e.parameter.shortDescription)||"-")}}function uo(a,n){if(1&a&&(t.TgZ(0,"th",36),t._uU(1),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.label," ")}}function _o(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"app-highlight",41),t.BQk()),2&a){const e=n.ngIf,i=t.oxw(4);t.xp6(1),t.Q6J("text",e)("term",i.filterForm.value.filter)}}function go(a,n){if(1&a&&(t.TgZ(0,"td",43),t.YNc(1,_o,2,2,"ng-container",49),t.ALo(2,"alias"),t.qZA()),2&a){const e=n.$implicit,i=t.oxw().$implicit;t.oxw(2);const r=t.MAs(21);t.xp6(1),t.Q6J("ngIf",t.xi3(2,2,e.parameter,i.id))("ngIfElse",r)}}function ho(a,n){1&a&&(t.ynx(0,48),t.YNc(1,uo,2,1,"th",20),t.YNc(2,go,3,5,"td",28),t.BQk()),2&a&&t.Q6J("matColumnDef",n.$implicit.id)}function fo(a,n){1&a&&t._UZ(0,"th",50)}function xo(a,n){1&a&&t._UZ(0,"td",43)}function To(a,n){1&a&&t._UZ(0,"tr",51)}function bo(a,n){if(1&a&&t._UZ(0,"tr",52),2&a){const e=n.$implicit,i=t.oxw(2);t.ekj("selected",i.selection.isSelected(e))}}function yo(a,n){if(1&a&&(t.TgZ(0,"table",18),t.ynx(1,19),t.YNc(2,Rs,2,0,"th",20),t.YNc(3,zs,3,2,"td",21),t.BQk(),t.ynx(4,22),t.YNc(5,Gs,2,0,"th",23),t.YNc(6,Ws,3,3,"td",24),t.BQk(),t.ynx(7,25),t.YNc(8,Xs,2,0,"th",23),t.YNc(9,no,3,4,"td",26),t.BQk(),t.ynx(10,27),t.YNc(11,ro,2,0,"th",20),t.YNc(12,oo,3,4,"td",28),t.BQk(),t.ynx(13,29),t.YNc(14,lo,2,0,"th",20),t.YNc(15,co,3,3,"td",28),t.BQk(),t.ynx(16,30),t.YNc(17,po,2,0,"th",23),t.YNc(18,mo,2,1,"td",28),t.BQk(),t.YNc(19,ho,3,1,"ng-container",31),t.ALo(20,"async"),t.ynx(21,32),t.YNc(22,fo,1,0,"th",33),t.YNc(23,xo,1,0,"td",28),t.BQk(),t.YNc(24,To,1,0,"tr",34),t.ALo(25,"async"),t.YNc(26,bo,1,2,"tr",35),t.ALo(27,"async"),t.qZA()),2&a){const e=t.oxw(),i=t.MAs(14);t.Q6J("dataSource",e.dataSource),t.xp6(19),t.Q6J("ngForOf",t.lcZ(20,4,e.aliasColumns$)),t.xp6(5),t.Q6J("matHeaderRowDef",t.lcZ(25,6,i.displayedColumns$)),t.xp6(2),t.Q6J("matRowDefColumns",t.lcZ(27,8,i.displayedColumns$))}}function vo(a,n){if(1&a&&(t.TgZ(0,"div",1),t._uU(1," The Mission Database for "),t.TgZ(2,"i"),t._uU(3),t.qZA(),t._uU(4," does not define any parameters. "),t.qZA()),2&a){const e=t.oxw();t.xp6(3),t.Oqu(e.yamcs.instance)}}function Zo(a,n){1&a&&t._uU(0,"-")}let Kt=(()=>{class a{constructor(e,i,r,s,o,c){this.yamcs=e,this.route=r,this.router=s,this.filterForm=new l.cw({filter:new l.NI,type:new l.NI("ANY"),source:new l.NI("ANY")}),this.shortName=!1,this.pageSize=100,this.system=null,this.breadcrumb$=new T.X([]),this.columns=[{id:"name",label:"Name",alwaysVisible:!0},{id:"type",label:"Type",visible:!0},{id:"dataSource",label:"Data Source",visible:!0},{id:"engValue",label:"Value",visible:!0},{id:"shortDescription",label:"Description",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],this.aliasColumns$=new T.X([]),this.typeOptions=[{id:"ANY",label:"Any type"},{id:"aggregate",label:"aggregate"},{id:"array",label:"array"},{id:"binary",label:"binary"},{id:"boolean",label:"boolean"},{id:"enumeration",label:"enumeration"},{id:"float",label:"float"},{id:"integer",label:"integer"},{id:"string",label:"string"},{id:"time",label:"time"}],this.sourceOptions=[{id:"ANY",label:"Any source"},{id:"COMMAND",label:"Command"},{id:"COMMAND_HISTORY",label:"Command History"},{id:"CONSTANT",label:"Constant"},{id:"DERIVED",label:"Derived"},{id:"EXTERNAL1",label:"External 1"},{id:"EXTERNAL2",label:"External 2"},{id:"EXTERNAL3",label:"External 3"},{id:"GROUND",label:"Ground"},{id:"LOCAL",label:"Local"},{id:"SYSTEM",label:"System"},{id:"TELEMETERED",label:"Telemetered"}],this.selection=new k.Ov(!1),i.setTitle("Parameters"),this.dataSource=new ks(e,o,c)}ngAfterViewInit(){const e=this.route.snapshot.queryParamMap;e.has("filter")&&(this.filter=e.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),e.has("type")&&(this.type=e.get("type"),this.filterForm.get("type").setValue(this.type)),e.has("source")&&(this.source=e.get("source"),this.filterForm.get("source").setValue(this.source)),this.filterForm.get("filter").valueChanges.subscribe(i=>{this.paginator.pageIndex=0,this.filter=i,this.updateDataSource()}),this.filterForm.get("type").valueChanges.forEach(i=>{this.type="ANY"!==i?i:null,this.updateDataSource()}),this.filterForm.get("source").valueChanges.forEach(i=>{this.source="ANY"!==i?i:null,this.updateDataSource()}),this.changeSystem(this.route.snapshot.queryParamMap),this.queryParamMapSubscription=this.route.queryParamMap.subscribe(i=>{i.get("system")!==this.system&&this.changeSystem(i)}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(e){this.system=e.get("system"),this.updateBrowsePath(),this.paginator.pageIndex=e.has("page")?Number(e.get("page")):0,this.updateDataSource()}updateDataSource(){this.updateURL();const e={system:this.system||"/",details:!0,pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize};this.filter&&(e.q=this.filter,e.searchMembers=!0),this.type&&(e.type=this.type),this.source&&(e.source=this.source),this.dataSource.loadParameters(e).then(()=>{this.selection.clear(),this.updateBrowsePath();for(const r of this.aliasColumns$.value){const s=this.columns.indexOf(r);-1!==s&&this.columns.splice(s,1)}const i=[];for(const r of this.dataSource.getAliasNamespaces())i.push({id:r,label:r,alwaysVisible:!0});this.columns.splice(1,0,...i),this.aliasColumns$.next(i),this.columnChooser.recalculate(this.columns)})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{page:this.paginator.pageIndex||null,filter:this.filter||null,type:this.type||null,source:this.source||null,system:this.system||null},queryParamsHandling:"merge"})}updateBrowsePath(){const e=[];let i="";if(this.system)for(const r of this.system.slice(1).split("/"))i+="/"+r,e.push({name:r,route:"/telemetry/parameters",queryParams:{system:i,c:this.yamcs.context}});this.breadcrumb$.next(e)}selectNext(){const e=this.dataSource.items$.value;let i=0;if(this.selection.hasValue()){const r=this.selection.selected[0];-1!==e.indexOf(r)&&(i=Math.min(e.indexOf(r)+1,e.length-1))}this.selection.select(e[i])}selectPrevious(){const e=this.dataSource.items$.value;let i=0;if(this.selection.hasValue()){const r=this.selection.selected[0];-1!==e.indexOf(r)&&(i=Math.max(e.indexOf(r)-1,0))}this.selection.select(e[i])}applySelection(){var e;if(this.selection.hasValue()){const i=this.selection.selected[0],r=this.dataSource.items$.value;i.parameter&&-1!==r.indexOf(i)&&this.router.navigate(["/telemetry/parameters",null===(e=i.parameter)||void 0===e?void 0:e.qualifiedName],{queryParams:{c:this.yamcs.context}})}}ngOnDestroy(){this.queryParamMapSubscription&&this.queryParamMapSubscription.unsubscribe(),this.dataSource.disconnect()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.C),t.Y36(O.Dx),t.Y36(y.gz),t.Y36(y.F0),t.Y36(q.j),t.Y36(pt.e))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(e,i){if(1&e&&(t.Gf(Qs,7),t.Gf(zt.NW,7),t.Gf(Gt.k,5)),2&e){let r;t.iGM(r=t.CRH())&&(i.top=r.first),t.iGM(r=t.CRH())&&(i.paginator=r.first),t.iGM(r=t.CRH())&&(i.columnChooser=r.first)}},decls:22,vars:15,consts:[["top",""],[1,"panel-content"],[3,"formGroup"],[4,"ngIf"],[1,"filter-bar"],["placeholder","Search by name","icon","search",3,"formControl","onArrowDown","onArrowUp","onEnter"],["formControlName","type",3,"options"],["formControlName","source",3,"options"],["preferenceKey","tmParameters",3,"columns"],["columnChooser",""],["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["empty",""],["dash",""],["class","filter-bar",4,"ngIf"],["link","/telemetry/parameters","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label",4,"ngFor","ngForOf"],[3,"link","queryParams","label"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","primary-td",4,"matCellDef"],["matColumnDef","rawValue"],["mat-header-cell","","class","wrap200",4,"matHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["matColumnDef","engValue"],["mat-cell","",3,"alert",4,"matCellDef"],["matColumnDef","type"],["mat-cell","",4,"matCellDef"],["matColumnDef","dataSource"],["matColumnDef","shortDescription"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],[3,"routerLink","queryParams"],[3,"text","term",4,"ngIf"],[3,"text","term"],["mat-header-cell","",1,"wrap200"],["mat-cell",""],[3,"pval",4,"ngIf"],[3,"pval"],["class","mono",4,"ngIf","ngIfElse"],[1,"mono"],[3,"matColumnDef"],[4,"ngIf","ngIfElse"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,i){1&e&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar"),t._uU(2," Parameters "),t.qZA(),t._UZ(3,"span",null,0),t.TgZ(5,"div",1),t.TgZ(6,"form",2),t.YNc(7,Ls,2,1,"ng-container",3),t.ALo(8,"async"),t.TgZ(9,"div",4),t.TgZ(10,"app-search-filter",5),t.NdJ("onArrowDown",function(){return i.selectNext()})("onArrowUp",function(){return i.selectPrevious()})("onEnter",function(){return i.applySelection()}),t.qZA(),t._UZ(11,"app-select",6),t._UZ(12,"app-select",7),t._UZ(13,"app-column-chooser",8,9),t.qZA(),t.qZA(),t.YNc(15,yo,28,10,"table",10),t._UZ(16,"mat-paginator",11),t.ALo(17,"async"),t.qZA(),t.YNc(18,vo,5,1,"ng-template",null,12,t.W1O),t.YNc(20,Zo,1,0,"ng-template",null,13,t.W1O),t.qZA()),2&e&&(t.xp6(6),t.Q6J("formGroup",i.filterForm),t.xp6(1),t.Q6J("ngIf",t.lcZ(8,11,i.breadcrumb$)),t.xp6(3),t.Q6J("formControl",i.filterForm.controls.filter),t.xp6(1),t.Q6J("options",i.typeOptions),t.xp6(1),t.Q6J("options",i.sourceOptions),t.xp6(1),t.Q6J("columns",i.columns),t.xp6(2),t.Q6J("ngIf",i.dataSource),t.xp6(1),t.Q6J("pageSize",i.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",t.lcZ(17,13,i.dataSource.totalSize$)))},directives:[L.a,R.k,l._Y,l.JL,l.sg,_.O5,Nt.w,qt.a,_.sg,Is.a,l.JJ,l.oH,M.P,l.u,Gt.k,u.BZ,u.w1,u.fO,u.ge,u.Dz,u.ev,S.Hw,y.yS,Ys.y,A.O_,B.Y,u.as,u.XQ,u.nj,u.Gk,zt.NW],pipes:[_.Ov,st.X,_.OU,I.V,K.H,Wt.W,_.rS,Ms.p],styles:[".primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}"],changeDetection:0}),a})();var te=p(6429),Ao=p(8619),wo=p(5981);const Po=["container"],w="http://www.w3.org/2000/svg";let So=(()=>{class a{ngOnChanges(){this.pval&&this.indicator&&this.redraw()}ngAfterViewInit(){const e=this.container.nativeElement,i=document.createElementNS(w,"rect");i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("width","100"),i.setAttribute("height","50"),i.setAttribute("shape-rendering","crispEdges"),i.style.fill="#00ff00",e.appendChild(i),this.watchLowRange=document.createElementNS(w,"rect"),this.watchLowRange.setAttribute("x","0"),this.watchLowRange.setAttribute("y","0"),this.watchLowRange.setAttribute("width","0"),this.watchLowRange.setAttribute("height","50"),this.watchLowRange.setAttribute("shape-rendering","crispEdges"),this.watchLowRange.style.fill="#ffff98",e.appendChild(this.watchLowRange),this.watchHighRange=document.createElementNS(w,"rect"),this.watchHighRange.setAttribute("x","0"),this.watchHighRange.setAttribute("y","0"),this.watchHighRange.setAttribute("width","0"),this.watchHighRange.setAttribute("height","50"),this.watchHighRange.setAttribute("shape-rendering","crispEdges"),this.watchHighRange.style.fill="#ffff98",e.appendChild(this.watchHighRange),this.warningLowRange=document.createElementNS(w,"rect"),this.warningLowRange.setAttribute("x","0"),this.warningLowRange.setAttribute("y","0"),this.warningLowRange.setAttribute("width","0"),this.warningLowRange.setAttribute("height","50"),this.warningLowRange.setAttribute("shape-rendering","crispEdges"),this.warningLowRange.style.fill="#ffff00",e.appendChild(this.warningLowRange),this.warningHighRange=document.createElementNS(w,"rect"),this.warningHighRange.setAttribute("x","0"),this.warningHighRange.setAttribute("y","0"),this.warningHighRange.setAttribute("width","0"),this.warningHighRange.setAttribute("height","50"),this.warningHighRange.setAttribute("shape-rendering","crispEdges"),this.warningHighRange.style.fill="#ffff00",e.appendChild(this.warningHighRange),this.distressLowRange=document.createElementNS(w,"rect"),this.distressLowRange.setAttribute("x","0"),this.distressLowRange.setAttribute("y","0"),this.distressLowRange.setAttribute("width","0"),this.distressLowRange.setAttribute("height","50"),this.distressLowRange.setAttribute("shape-rendering","crispEdges"),this.distressLowRange.style.fill="#ff6600",e.appendChild(this.distressLowRange),this.distressHighRange=document.createElementNS(w,"rect"),this.distressHighRange.setAttribute("x","0"),this.distressHighRange.setAttribute("y","0"),this.distressHighRange.setAttribute("width","0"),this.distressHighRange.setAttribute("height","50"),this.distressHighRange.setAttribute("shape-rendering","crispEdges"),this.distressHighRange.style.fill="#ff6600",e.appendChild(this.distressHighRange),this.criticalLowRange=document.createElementNS(w,"rect"),this.criticalLowRange.setAttribute("x","0"),this.criticalLowRange.setAttribute("y","0"),this.criticalLowRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("height","50"),this.criticalLowRange.setAttribute("shape-rendering","crispEdges"),this.criticalLowRange.style.fill="red",e.appendChild(this.criticalLowRange),this.criticalHighRange=document.createElementNS(w,"rect"),this.criticalHighRange.setAttribute("x","0"),this.criticalHighRange.setAttribute("y","0"),this.criticalHighRange.setAttribute("width","0"),this.criticalHighRange.setAttribute("height","50"),this.criticalHighRange.setAttribute("shape-rendering","crispEdges"),this.criticalHighRange.style.fill="red",e.appendChild(this.criticalHighRange),this.severeLowRange=document.createElementNS(w,"rect"),this.severeLowRange.setAttribute("x","0"),this.severeLowRange.setAttribute("y","0"),this.severeLowRange.setAttribute("width","0"),this.severeLowRange.setAttribute("height","50"),this.severeLowRange.setAttribute("shape-rendering","crispEdges"),this.severeLowRange.style.fill="#800000",e.appendChild(this.severeLowRange),this.severeHighRange=document.createElementNS(w,"rect"),this.severeHighRange.setAttribute("x","0"),this.severeHighRange.setAttribute("y","0"),this.severeHighRange.setAttribute("width","0"),this.severeHighRange.setAttribute("height","50"),this.severeHighRange.setAttribute("shape-rendering","crispEdges"),this.severeHighRange.style.fill="#800000",e.appendChild(this.severeHighRange),this.indicator=document.createElementNS(w,"polygon"),this.indicator.classList.add("indicator"),this.indicator.style.fill="black",this.indicator.style.visibility="hidden",e.appendChild(this.indicator),this.pval&&this.redraw()}redraw(){let e,i;const r=new Map;if(this.pval.alarmRange)for(const s of this.pval.alarmRange)r.set(s.level,s),void 0!==s.minInclusive&&(void 0===e||s.minInclusive<e)&&(e=s.minInclusive),void 0!==s.minExclusive&&(void 0===e||s.minExclusive<e)&&(e=s.minExclusive),void 0!==s.maxInclusive&&(void 0===i||s.maxInclusive>i)&&(i=s.maxInclusive),void 0!==s.maxExclusive&&(void 0===i||s.maxExclusive>i)&&(i=s.maxExclusive);if(this.criticalHighRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("width","0"),this.indicator.style.visibility="hidden",void 0!==e&&void 0!==i&&e!==i){const s=e-(i-e)/5,o=i+(i-e)/5,c=100/(o-s),m=r.get("WATCH");if(m)if(m.minInclusive?this.watchLowRange.setAttribute("width",String((m.minInclusive-s)*c)):m.minExclusive&&this.watchLowRange.setAttribute("width",String((m.minExclusive-s)*c)),m.maxInclusive){const f=(m.maxInclusive-s)*c;this.watchHighRange.setAttribute("x",String(f)),this.watchHighRange.setAttribute("width",String(100-f))}else if(m.maxExclusive){const f=(m.maxExclusive-s)*c;this.watchHighRange.setAttribute("x",String(f)),this.watchHighRange.setAttribute("width",String(100-f))}const x=r.get("WARNING");if(x)if(x.minInclusive?this.warningLowRange.setAttribute("width",String((x.minInclusive-s)*c)):x.minExclusive&&this.warningLowRange.setAttribute("width",String((x.minExclusive-s)*c)),x.maxInclusive){const f=(x.maxInclusive-s)*c;this.warningHighRange.setAttribute("x",String(f)),this.warningHighRange.setAttribute("width",String(100-f))}else if(x.maxExclusive){const f=(x.maxExclusive-s)*c;this.warningHighRange.setAttribute("x",String(f)),this.warningHighRange.setAttribute("width",String(100-f))}const d=r.get("DISTRESS");if(d)if(d.minInclusive?this.distressLowRange.setAttribute("width",String((d.minInclusive-s)*c)):d.minExclusive&&this.distressLowRange.setAttribute("width",String((d.minExclusive-s)*c)),d.maxInclusive){const f=(d.maxInclusive-s)*c;this.distressHighRange.setAttribute("x",String(f)),this.distressHighRange.setAttribute("width",String(100-f))}else if(d.maxExclusive){const f=(d.maxExclusive-s)*c;this.distressHighRange.setAttribute("x",String(f)),this.distressHighRange.setAttribute("width",String(100-f))}const b=r.get("CRITICAL");if(b)if(b.minInclusive?this.criticalLowRange.setAttribute("width",String((b.minInclusive-s)*c)):b.minExclusive&&this.criticalLowRange.setAttribute("width",String((b.minExclusive-s)*c)),b.maxInclusive){const f=(b.maxInclusive-s)*c;this.criticalHighRange.setAttribute("x",String(f)),this.criticalHighRange.setAttribute("width",String(100-f))}else if(b.maxExclusive){const f=(b.maxExclusive-s)*c;this.criticalHighRange.setAttribute("x",String(f)),this.criticalHighRange.setAttribute("width",String(100-f))}const v=r.get("SEVERE");if(v)if(v.minInclusive?this.severeLowRange.setAttribute("width",String((v.minInclusive-s)*c)):v.minExclusive&&this.severeLowRange.setAttribute("width",String((v.minExclusive-s)*c)),v.maxInclusive){const f=(v.maxInclusive-s)*c;this.severeHighRange.setAttribute("x",String(f)),this.severeHighRange.setAttribute("width",String(100-f))}else if(v.maxExclusive){const f=(v.maxExclusive-s)*c;this.severeHighRange.setAttribute("x",String(f)),this.severeHighRange.setAttribute("width",String(100-f))}const ie=this.getNumericValue(this.pval);if(void 0!==ie){const ut=(Math.min(Math.max(ie,s),o)-s)*c;this.indicator.setAttribute("points",`${ut},25 ${ut-3.5},100 ${ut+3.5},100`),this.indicator.style.visibility="visible"}else this.indicator.style.visibility="hidden"}}getNumericValue(e){const i=e.engValue;switch(i.type){case"FLOAT":return i.floatValue;case"DOUBLE":return i.doubleValue;case"UINT32":return i.uint32Value;case"SINT32":return i.sint32Value;case"UINT64":return i.uint64Value;case"SINT64":return i.sint64Value}}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-severity-meter"]],viewQuery:function(e,i){if(1&e&&t.Gf(Po,7),2&e){let r;t.iGM(r=t.CRH())&&(i.container=r.first)}},inputs:{pval:"pval"},features:[t.TTD],decls:2,vars:0,consts:[["width","100%","height","8px","viewBox","0 0 100 100","preserveAspectRatio","none",2,"overflow","visible"],["container",""]],template:function(e,i){1&e&&(t.O4$(),t._UZ(0,"svg",0,1))},encapsulation:2,changeDetection:0}),a})();var Co=p(905);const ee=function(a,n){return{c:a,filter:n}};function Do(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",10),t._uU(2),t.qZA(),t.BQk()),2&a){const e=n.ngIf,i=t.oxw(2);t.xp6(1),t.Q6J("queryParams",t.WLB(2,ee,i.yamcs.context,e)),t.xp6(1),t.hij(" ",e," ")}}function Uo(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.qZA(),t.BQk()),2&a){const e=n.$implicit;t.xp6(2),t.Oqu(e.namespace),t.xp6(2),t.Oqu(e.name)}}function No(a,n){if(1&a&&(t.TgZ(0,"span",11),t._uU(1),t.qZA()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",e," ")}}function qo(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Description"),t.qZA(),t.TgZ(3,"dd"),t._UZ(4,"app-markdown",12),t.qZA(),t.BQk()),2&a){const e=t.oxw().ngIf;t.xp6(4),t.Q6J("text",e.longDescription)}}function ko(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Description"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.qZA(),t.BQk()),2&a){const e=t.oxw().ngIf;t.xp6(4),t.hij(" ",e.shortDescription||"-"," ")}}function Io(a,n){if(1&a&&(t.ynx(0),t.YNc(1,qo,5,1,"ng-container",2),t.YNc(2,ko,5,1,"ng-container",2),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.Q6J("ngIf",e.longDescription),t.xp6(1),t.Q6J("ngIf",!e.longDescription)}}function Yo(a,n){if(1&a&&(t.TgZ(0,"dl",8),t.TgZ(1,"dt"),t._uU(2,"Entry"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.ALo(5,"shortName"),t.qZA(),t.TgZ(6,"dt"),t._uU(7,"Space System"),t.qZA(),t.TgZ(8,"dd"),t.YNc(9,Do,3,5,"ng-container",2),t.ALo(10,"spaceSystemName"),t.qZA(),t.YNc(11,Uo,5,2,"ng-container",3),t.ALo(12,"async"),t.TgZ(13,"dt"),t._uU(14,"Type"),t.qZA(),t.TgZ(15,"dd"),t.YNc(16,No,2,1,"span",4),t.ALo(17,"async"),t.qZA(),t.TgZ(18,"dt"),t._uU(19,"Source"),t.qZA(),t.TgZ(20,"dd"),t._uU(21),t.ALo(22,"titlecase"),t.qZA(),t.YNc(23,Io,3,2,"ng-container",9),t.ALo(24,"async"),t.qZA()),2&a){const e=t.oxw(),i=t.MAs(22);let r;t.xp6(4),t.AsE(" ",t.lcZ(5,9,e.parameter.qualifiedName),"",e.offset," "),t.xp6(5),t.Q6J("ngIf",t.lcZ(10,11,e.parameter.qualifiedName)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(12,13,e.entry$).alias),t.xp6(5),t.Q6J("ngIf",null==(r=t.lcZ(17,15,e.ptype$))?null:r.engType)("ngIfElse",i),t.xp6(5),t.Oqu(t.lcZ(22,17,e.parameter.dataSource)||"-"),t.xp6(2),t.Q6J("ngIf",t.lcZ(24,19,e.entry$))("ngIfElse",i)}}const mt=function(a){return["/telemetry/parameters",a]},tt=function(a){return{c:a}};function Mo(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Host Parameter"),t.qZA(),t.TgZ(3,"dd"),t.TgZ(4,"a",13),t._uU(5),t.ALo(6,"shortName"),t.qZA(),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("routerLink",t.VKq(5,mt,e.parameter.qualifiedName))("queryParams",t.VKq(7,tt,e.yamcs.context)),t.xp6(1),t.hij(" ",t.lcZ(6,3,e.parameter.qualifiedName)," ")}}function Qo(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Parameter"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.ALo(5,"shortName"),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,1,e.parameter.qualifiedName))}}function Jo(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",10),t._uU(2),t.qZA(),t.BQk()),2&a){const e=n.ngIf,i=t.oxw(2);t.xp6(1),t.Q6J("queryParams",t.WLB(2,ee,i.yamcs.context,e)),t.xp6(1),t.hij(" ",e," ")}}function Oo(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Space System"),t.qZA(),t.TgZ(3,"dd"),t.YNc(4,Jo,3,5,"ng-container",2),t.ALo(5,"spaceSystemName"),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",t.lcZ(5,1,e.parameter.qualifiedName))}}function Lo(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.qZA(),t.BQk()),2&a){const e=n.$implicit;t.xp6(2),t.Oqu(e.namespace),t.xp6(2),t.Oqu(e.name)}}function Ro(a,n){if(1&a&&(t.TgZ(0,"span",11),t._uU(1),t.qZA()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",e," ")}}function Vo(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Source"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.ALo(5,"titlecase"),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,1,e.parameter.dataSource)||"-")}}function Fo(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Description"),t.qZA(),t.TgZ(3,"dd"),t._UZ(4,"app-markdown",12),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("text",e.parameter.longDescription)}}function $o(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Description"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.hij(" ",e.parameter.shortDescription||"-"," ")}}function Eo(a,n){if(1&a&&(t.TgZ(0,"span",11),t._uU(1),t.qZA()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",e," ")}}function Ho(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"td"),t.TgZ(2,"a",20),t._uU(3),t.qZA(),t.qZA(),t.TgZ(4,"td"),t.YNc(5,Eo,2,1,"span",4),t.ALo(6,"entryForOffset"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"entryForOffset"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"value"),t.qZA(),t.BQk()),2&a){const e=n.ngIf,i=t.oxw(),r=i.$implicit,s=i.index,o=t.oxw(2).ngIf,c=t.oxw(),m=t.MAs(22);let x,d;t.xp6(2),t.Q6J("routerLink",t.VKq(15,mt,c.parameter.qualifiedName+e))("queryParams",t.VKq(17,tt,c.yamcs.context)),t.xp6(1),t.Oqu(r),t.xp6(2),t.Q6J("ngIf",null==(x=t.xi3(6,7,c.parameter,e))||null==x.type?null:x.type.engType)("ngIfElse",m),t.xp6(3),t.Oqu((null==(d=t.xi3(9,10,c.parameter,e))?null:d.shortDescription)||"-"),t.xp6(3),t.Oqu(t.lcZ(12,13,o.aggregateValue.value[s]))}}function Bo(a,n){if(1&a&&(t.TgZ(0,"tr"),t.YNc(1,Ho,13,19,"ng-container",2),t.qZA()),2&a){const e=n.$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(i.offset||"")+"."+e)}}function jo(a,n){if(1&a&&(t.TgZ(0,"table",19),t.TgZ(1,"tr"),t.TgZ(2,"th"),t._uU(3,"Member"),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Type"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"Description"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Value"),t.qZA(),t.qZA(),t.YNc(10,Bo,2,1,"tr",3),t.qZA()),2&a){const e=t.oxw().ngIf;t.xp6(10),t.Q6J("ngForOf",e.aggregateValue.name)}}function zo(a,n){if(1&a&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t.TgZ(2,"a",20),t._uU(3),t.qZA(),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"value"),t.qZA(),t.qZA()),2&a){const e=n.$implicit,i=n.index,r=t.oxw(3);t.xp6(2),t.Q6J("routerLink",t.VKq(6,mt,r.parameter.qualifiedName+(r.offset||"")+"["+i+"]"))("queryParams",t.VKq(8,tt,r.yamcs.context)),t.xp6(1),t.Oqu(i),t.xp6(2),t.Oqu(t.lcZ(6,4,e))}}function Go(a,n){if(1&a&&(t.TgZ(0,"table",19),t.TgZ(1,"tr"),t.TgZ(2,"th"),t._uU(3,"Index"),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Value"),t.qZA(),t.qZA(),t.YNc(6,zo,7,10,"tr",3),t.qZA()),2&a){const e=t.oxw().ngIf;t.xp6(6),t.Q6J("ngForOf",e.arrayValue)}}function Wo(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"app-alarm-level",23),t._uU(2,"\xa0 "),t.BQk()),2&a){const e=t.oxw(3);t.xp6(1),t.Q6J("level",e.pval.monitoringResult)}}function Xo(a,n){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"units"),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.Oqu(t.lcZ(2,1,null==e.parameter.type?null:e.parameter.type.unitSet))}}function Ko(a,n){if(1&a&&(t.TgZ(0,"span",21),t.TgZ(1,"app-expirable",22),t.YNc(2,Wo,3,1,"ng-container",2),t._uU(3),t.ALo(4,"value"),t.YNc(5,Xo,3,3,"span",2),t.qZA(),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.xp6(1),t.Q6J("pval",i.pval),t.xp6(1),t.Q6J("ngIf",i.pval.monitoringResult),t.xp6(1),t.hij(" ",t.lcZ(4,4,e)," "),t.xp6(2),t.Q6J("ngIf",null==i.parameter.type?null:i.parameter.type.unitSet)}}function tl(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"app-severity-meter",24),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("pval",e.pval)}}function el(a,n){if(1&a&&(t.ynx(0),t.ynx(1,14),t.YNc(2,jo,11,1,"table",15),t.YNc(3,Go,7,1,"table",15),t.YNc(4,Ko,6,6,"span",16),t._UZ(5,"br"),t.TgZ(6,"div",17),t.YNc(7,tl,2,1,"ng-container",2),t._UZ(8,"br"),t.TgZ(9,"span",18),t._uU(10),t.ALo(11,"datetime"),t._UZ(12,"br"),t._uU(13),t.ALo(14,"value"),t._UZ(15,"br"),t.qZA(),t.qZA(),t.BQk(),t.BQk()),2&a){const e=n.ngIf,i=t.oxw();t.xp6(1),t.Q6J("ngSwitch",e.type),t.xp6(1),t.Q6J("ngSwitchCase","AGGREGATE"),t.xp6(1),t.Q6J("ngSwitchCase","ARRAY"),t.xp6(4),t.Q6J("ngIf",i.pval.alarmRange),t.xp6(3),t.hij(" Generation time: ",t.lcZ(11,6,i.pval.generationTime),""),t.xp6(3),t.hij(" Raw value: ",t.lcZ(14,8,i.pval.rawValue)||"-","")}}function al(a,n){1&a&&(t.TgZ(0,"span",25),t._uU(1,"---"),t.qZA())}function il(a,n){1&a&&(t.ynx(0),t._uU(1,", "),t.BQk())}const nl=function(a){return["/mdb/parameters/",a]};function rl(a,n){if(1&a&&(t.ynx(0),t.YNc(1,il,2,0,"ng-container",2),t.TgZ(2,"a",29),t._uU(3),t.qZA(),t._uU(4),t.ALo(5,"operator"),t.BQk()),2&a){const e=n.$implicit,i=n.first,r=t.oxw(4);t.xp6(1),t.Q6J("ngIf",!i),t.xp6(1),t.Q6J("routerLink",t.VKq(8,nl,e.parameter.qualifiedName))("queryParams",t.VKq(10,tt,r.yamcs.context)),t.xp6(1),t.hij(" ",e.parameter.name," "),t.xp6(1),t.AsE(" ",t.lcZ(5,6,e.operator)," ",e.value," ")}}function sl(a,n){if(1&a&&(t.TgZ(0,"th"),t.YNc(1,rl,6,12,"ng-container",3),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngForOf",e.comparison)}}function ol(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"app-alarm-level",30),t._uU(2),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.Q6J("level",e)("grayscale",!0),t.xp6(1),t.hij(" ",e," ")}}function ll(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function cl(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"app-alarm-level",30),t._uU(2),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.Q6J("level",e)("grayscale",!0),t.xp6(1),t.hij(" ",e," ")}}function pl(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function ml(a,n){if(1&a&&(t.TgZ(0,"td"),t.YNc(1,cl,3,3,"ng-container",2),t.YNc(2,pl,2,0,"span",2),t.qZA()),2&a){const e=n.$implicit,i=t.oxw().$implicit,r=t.oxw(3);t.xp6(1),t.Q6J("ngIf",r.getEnumerationAlarmLevel(e,i)),t.xp6(1),t.Q6J("ngIf",!r.getEnumerationAlarmLevel(e,i))}}function ul(a,n){if(1&a&&(t.TgZ(0,"tr"),t.TgZ(1,"td",25),t._uU(2),t.qZA(),t.TgZ(3,"td",25),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t.YNc(8,ol,3,3,"ng-container",2),t.YNc(9,ll,2,0,"span",2),t.qZA(),t.YNc(10,ml,3,2,"td",3),t.qZA()),2&a){const e=n.$implicit,i=t.oxw(2).ngIf,r=t.oxw();t.xp6(2),t.Oqu(e.value),t.xp6(2),t.Oqu(e.label),t.xp6(2),t.Oqu(e.description||"-"),t.xp6(2),t.Q6J("ngIf",r.getDefaultAlarmLevel(i.type,e)),t.xp6(1),t.Q6J("ngIf",!r.getDefaultAlarmLevel(i.type,e)),t.xp6(1),t.Q6J("ngForOf",i.type.contextAlarm)}}function _l(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"div",5),t._UZ(2,"mat-divider"),t.qZA(),t.TgZ(3,"h4"),t._uU(4,"Enumeration"),t.qZA(),t.TgZ(5,"table",19),t.TgZ(6,"tr"),t.TgZ(7,"th",26),t._uU(8,"Value"),t.qZA(),t.TgZ(9,"th",27),t._uU(10,"Label"),t.qZA(),t.TgZ(11,"th",28),t._uU(12,"Description"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Alarm Level (default)"),t.qZA(),t.YNc(15,sl,2,1,"th",3),t.qZA(),t.YNc(16,ul,11,6,"tr",3),t.qZA(),t.BQk()),2&a){const e=t.oxw().ngIf;t.xp6(15),t.Q6J("ngForOf",null==e.type?null:e.type.contextAlarm),t.xp6(1),t.Q6J("ngForOf",null==e.type?null:e.type.enumValue)}}function gl(a,n){if(1&a&&(t.ynx(0),t.YNc(1,_l,17,2,"ng-container",2),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.Q6J("ngIf","enumeration"===(null==e.type?null:e.type.engType))}}function dl(a,n){1&a&&t._uU(0,"-")}let hl=(()=>{class a{constructor(e,i,r){this.yamcs=e,this.entryForOffsetPipe=i,this.parameterTypeForPathPipe=r,this.entry$=new T.X(null),this.ptype$=new T.X(null)}ngOnChanges(){if(this.parameter){if(this.offset){const e=this.entryForOffsetPipe.transform(this.parameter,this.offset);this.entry$.next(e)}else this.entry$.next(this.parameter);this.ptype$.next(this.parameterTypeForPathPipe.transform(this.parameter)||null)}else this.entry$.next(null),this.ptype$.next(null)}getDefaultAlarmLevel(e,i){if(e&&e.defaultAlarm){const r=e.defaultAlarm;if(r.enumerationAlarm)for(const s of r.enumerationAlarm)if(s.label===i.label)return s.level}}getEnumerationAlarmLevel(e,i){const r=e.alarm;for(const s of r.enumerationAlarm)if(s.label===i.label)return s.level}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.C),t.Y36(te.h),t.Y36(Wt.W))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-parameter-detail"]],inputs:{parameter:"parameter",offset:"offset",pval:"pval"},features:[t.TTD],decls:23,vars:17,consts:[["class","dl-horizontal no-lead no-trail",4,"ngIf"],[1,"dl-horizontal","no-trail"],[4,"ngIf"],[4,"ngFor","ngForOf"],["class","mono",4,"ngIf","ngIfElse"],[1,"section-divider"],["style","white-space: nowrap",4,"ngIf"],["dash",""],[1,"dl-horizontal","no-lead","no-trail"],[4,"ngIf","ngIfElse"],["routerLink","/telemetry/parameters",1,"ya-link",3,"queryParams"],[1,"mono"],[3,"text"],[1,"ya-link",3,"routerLink","queryParams"],[3,"ngSwitch"],["yaDataTable","",4,"ngSwitchCase"],["class","pval",4,"ngSwitchDefault"],[1,"meter-size-constrainer"],[1,"subtext"],["yaDataTable",""],[3,"routerLink","queryParams"],[1,"pval"],[2,"white-space","nowrap",3,"pval"],[3,"level"],[3,"pval"],[2,"white-space","nowrap"],[2,"width","50px"],[2,"width","100px"],[2,"width","300px"],[1,"secundary",3,"routerLink","queryParams"],[3,"level","grayscale"]],template:function(e,i){if(1&e&&(t.YNc(0,Yo,25,21,"dl",0),t.TgZ(1,"dl",1),t.YNc(2,Mo,7,9,"ng-container",2),t.YNc(3,Qo,6,3,"ng-container",2),t.YNc(4,Oo,6,3,"ng-container",2),t.YNc(5,Lo,5,2,"ng-container",3),t.TgZ(6,"dt"),t._uU(7,"Type"),t.qZA(),t.TgZ(8,"dd"),t.YNc(9,Ro,2,1,"span",4),t.qZA(),t.YNc(10,Vo,6,3,"ng-container",2),t.YNc(11,Fo,5,1,"ng-container",2),t.YNc(12,$o,5,1,"ng-container",2),t.qZA(),t.TgZ(13,"div",5),t._UZ(14,"mat-divider"),t.qZA(),t.TgZ(15,"h4"),t._uU(16,"Current value"),t.qZA(),t.YNc(17,el,16,10,"ng-container",2),t.YNc(18,al,2,0,"span",6),t.YNc(19,gl,2,1,"ng-container",2),t.ALo(20,"async"),t.YNc(21,dl,1,0,"ng-template",null,7,t.W1O)),2&e){const r=t.MAs(22);t.Q6J("ngIf",i.offset),t.xp6(1),t.ekj("no-lead",!i.offset),t.xp6(1),t.Q6J("ngIf",i.offset),t.xp6(1),t.Q6J("ngIf",!i.offset),t.xp6(1),t.Q6J("ngIf",!i.offset),t.xp6(1),t.Q6J("ngForOf",i.parameter.alias),t.xp6(4),t.Q6J("ngIf",null==i.parameter.type?null:i.parameter.type.engType)("ngIfElse",r),t.xp6(1),t.Q6J("ngIf",!i.offset),t.xp6(1),t.Q6J("ngIf",i.parameter.longDescription),t.xp6(1),t.Q6J("ngIf",!i.parameter.longDescription),t.xp6(5),t.Q6J("ngIf",null==i.pval?null:i.pval.engValue),t.xp6(1),t.Q6J("ngIf",!(null!=i.pval&&i.pval.engValue)),t.xp6(1),t.Q6J("ngIf",t.lcZ(20,15,i.entry$))}},directives:[_.O5,y.yS,_.sg,Ao.U,j.d,_.RF,_.n9,wo.O,_.ED,B.Y,H.i,So],pipes:[Bt.y,Ht.B,_.Ov,_.rS,te.h,I.V,K.H,P.i,Co.N],styles:[".meter-size-constrainer[_ngcontent-%COMP%]{display:inline-block;width:160px;position:relative}.dl-horizontal[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{text-align:left}span.pval[_ngcontent-%COMP%]{font-size:16px;line-height:20px;margin:-8px 0 16px;bottom:-5px;color:#000000fc;font-weight:400}.subtext[_ngcontent-%COMP%]{font-size:smaller;white-space:nowrap}.pval-frame[_ngcontent-%COMP%]{display:inline-block;min-width:412px;border:1px solid #e7e7e7;border-radius:2px;box-shadow:0 1px 3px #0000001f}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;height:64px;line-height:64px;padding-left:24px;position:relative}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.pval-frame[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{padding:24px}.mat-icon.unchecked[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),a})();function fl(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"app-parameter-detail",2),t.ALo(2,"async"),t.ALo(3,"async"),t.BQk()),2&a){const e=n.ngIf,i=t.oxw();t.xp6(1),t.Q6J("parameter",e)("offset",t.lcZ(2,3,i.offset$))("pval",t.lcZ(3,5,i.pval$))}}const xl=[{path:"",canActivate:[Pt.a,wa.z],canActivateChild:[Pt.a],runGuardsAndResolvers:"always",component:Pa.K,children:[{path:"",pathMatch:"full",redirectTo:"home"},{path:"displays",pathMatch:"full",redirectTo:"displays/browse"},{path:"displays/browse",component:Yt,children:[{path:"**",component:kt}]},{path:"displays/files",component:It,children:[{path:"**",component:Ct,canDeactivate:[Ut]}]},{path:"packets",component:Mt},{path:"parameters",pathMatch:"full",component:Kt},{path:"parameters/:qualifiedName",component:jt,children:[{path:"",pathMatch:"full",redirectTo:"summary"},{path:"summary",component:(()=>{class a{constructor(e,i,r){this.yamcs=i,this.synchronizer=r,this.parameter$=new T.X(null),this.offset$=new T.X(null),this.parameterValue$=new T.X(null),this.dirty=!1,this.pval$=new T.X(null),e.parent.paramMap.subscribe(s=>{const o=s.get("qualifiedName");this.changeParameter(o)}),this.syncSubscription=this.synchronizer.syncFast(()=>{this.dirty&&(this.pval$.next(this.parameterValue$.value),this.dirty=!1)})}changeParameter(e){this.yamcs.yamcsClient.getParameter(this.yamcs.instance,e).then(i=>{this.parameter$.next(i),this.offset$.next(e!==i.qualifiedName?e.substring(i.qualifiedName.length):null),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValue$.next(null),this.pval$.next(null),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:e}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},r=>{this.parameterValue$.next(r.values?r.values[0]:null),null==this.pval$.value?this.pval$.next(this.parameterValue$.value):this.dirty=!0})})}ngOnDestroy(){this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.syncSubscription&&this.syncSubscription.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.gz),t.Y36(Z.C),t.Y36(q.j))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:3,vars:3,consts:[[1,"panel-content"],[4,"ngIf"],[3,"parameter","offset","pval"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.YNc(1,fl,4,7,"ng-container",1),t.ALo(2,"async"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,i.parameter$)))},directives:[_.O5,hl],pipes:[_.Ov],encapsulation:2,changeDetection:0}),a})()},{path:"chart",component:Vt},{path:"data",component:Ft},{path:"alarms",component:Qt}]}]}];let Tl=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({providers:[Ut],imports:[[y.Bz.forChild(xl)],y.Bz]}),a})(),bl=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[ne.m,Tl]]}),a})()}}]);