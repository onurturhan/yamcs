"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[293],{293:(an,L,o)=>{o.r(L),o.d(L,{AlarmsModule:()=>en});var E=o(7573),h=o(1083),j=o(7309),O=o(4375),R=o(9326),s=o(3075),m=o(8279),x=o(381),d=o(2134),t=o(5e3),U=o(4454),S=o(8928),I=o(9140),M=o(3251);const G=function(){return{matrixParams:"exact",paths:"exact",queryParams:"ignored"}},N=function(a){return{c:a}};let k=(()=>{class a{constructor(e){this.yamcs=e}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(x.C))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-alarms-page-tabs"]],decls:10,vars:14,consts:[["mat-tab-nav-bar",""],["mat-tab-link","","routerLink","/alarms","routerLinkActive","",3,"routerLinkActiveOptions","active","queryParams"],["rla","routerLinkActive"],["mat-tab-link","","routerLink","/alarms/history","routerLinkActive","",3,"active","queryParams"],["rlb","routerLinkActive"],["mat-tab-link","","routerLink","/alarms/log","routerLinkActive","",3,"active","queryParams"],["rlc","routerLinkActive"]],template:function(e,i){if(1&e&&(t.TgZ(0,"nav",0),t.TgZ(1,"a",1,2),t._uU(3," ACTIVE "),t.qZA(),t.TgZ(4,"a",3,4),t._uU(6," HISTORY "),t.qZA(),t.TgZ(7,"a",5,6),t._uU(9," ACTION LOG "),t.qZA(),t.qZA()),2&e){const l=t.MAs(2),r=t.MAs(5),c=t.MAs(8);t.xp6(1),t.Q6J("routerLinkActiveOptions",t.DdM(7,G))("active",l.isActive)("queryParams",t.VKq(8,N,i.yamcs.context)),t.xp6(3),t.Q6J("active",r.isActive)("queryParams",t.VKq(10,N,i.yamcs.context)),t.xp6(3),t.Q6J("active",c.isActive)("queryParams",t.VKq(12,N,i.yamcs.context))}},directives:[M.BU,h.yS,M.Nj,h.Od],styles:[".mat-tab-link[_ngcontent-%COMP%]{height:36px;min-width:0;font-size:13px}"],changeDetection:0}),a})();var b=o(141),f=o(9808),$=o(4071),w=o(119),K=o(5869);const z=["intervalSelect"];function W(a,n){if(1&a){const e=t.EpF();t.ynx(0),t._UZ(1,"app-date-time-input",16),t._UZ(2,"app-date-time-input",17),t.TgZ(3,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().applyCustomDates()}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.filterForm.invalid)}}function X(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().jumpToNow()}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function tt(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Time"),t.qZA())}function et(a,n){if(1&a&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.time))}}function at(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"User"),t.qZA())}function nt(a,n){if(1&a&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(e.user||"-")}}function it(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Action"),t.qZA())}function lt(a,n){if(1&a&&(t.TgZ(0,"td",21),t._UZ(1,"span",22),t.ALo(2,"actionLogFormat"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,e.summary)||"-",t.oJD)}}function rt(a,n){1&a&&t._UZ(0,"th",23)}function ot(a,n){1&a&&t._UZ(0,"td",21)}function ct(a,n){1&a&&t._UZ(0,"tr",24)}function st(a,n){1&a&&t._UZ(0,"tr",25)}let B=(()=>{class a{constructor(e,i,l,r){this.yamcs=e,this.messageService=i,this.router=l,this.route=r,this.filterForm=new s.cw({filter:new s.NI,interval:new s.NI("NO_LIMIT"),customStart:new s.NI(null),customStop:new s.NI(null)}),this.displayedColumns=["time","user","summary","actions"],this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.dataSource=new m.by,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(c=>{if("CUSTOM"===c){const _=new Date,g=this.validStart||_,u=this.validStop||_;this.filterForm.get("customStart").setValue(d.Y6(g)),this.filterForm.get("customStop").setValue(d.Y6(u))}else"NO_LIMIT"===c?(this.validStart=null,this.validStop=null,this.appliedInterval=c,this.loadData()):(this.validStop=new Date,this.validStart=(0,d.rV)(this.validStop,c),this.appliedInterval=c,this.loadData())})}initializeOptions(){const e=this.route.snapshot.queryParamMap;if(e.has("filter")&&(this.filter=e.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),e.has("interval"))if(this.appliedInterval=e.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const i=e.get("customStart");this.filterForm.get("customStart").setValue(i),this.validStart=d.ZU(i);const l=e.get("customStop");this.filterForm.get("customStop").setValue(l),this.validStop=d.ZU(l)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=(0,d.rV)(this.validStop,this.appliedInterval));else this.appliedInterval="NO_LIMIT",this.validStop=null,this.validStart=null}jumpToNow(){this.filterForm.get("interval").setValue("NO_LIMIT")}applyCustomDates(){this.validStart=d.ZU(this.filterForm.value.customStart),this.validStop=d.ZU(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const e={service:"AlarmsApi"};this.validStart&&(e.start=this.validStart.toISOString()),this.validStop&&(e.stop=this.validStop.toISOString()),this.filter&&(e.q=this.filter),this.yamcs.yamcsClient.getAuditRecords(this.yamcs.instance,e).then(i=>this.dataSource.data=i.records||[]).catch(i=>this.messageService.showError(i))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filter||null,interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(x.C),t.Y36(U.e),t.Y36(h.F0),t.Y36(h.gz))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(e,i){if(1&e&&t.Gf(z,5),2&e){let l;t.iGM(l=t.CRH())&&(i.intervalSelect=l.first)}},decls:26,vars:7,consts:[[1,"panel-content"],[2,"margin-top","16px",3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],[4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","summary"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],["mat-header-cell",""],["mat-cell",""],[3,"innerHTML"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,i){1&e&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar"),t._uU(2," Alarms "),t.qZA(),t.TgZ(3,"div",0),t._UZ(4,"app-alarms-page-tabs"),t.TgZ(5,"form",1),t.TgZ(6,"div",2),t._UZ(7,"app-select",3,4),t.YNc(9,W,5,1,"ng-container",5),t.YNc(10,X,3,0,"ng-container",5),t.qZA(),t.qZA(),t.TgZ(11,"table",6),t.ynx(12,7),t.YNc(13,tt,2,0,"th",8),t.YNc(14,et,3,3,"td",9),t.BQk(),t.ynx(15,10),t.YNc(16,at,2,0,"th",8),t.YNc(17,nt,2,1,"td",9),t.BQk(),t.ynx(18,11),t.YNc(19,it,2,0,"th",8),t.YNc(20,lt,3,3,"td",9),t.BQk(),t.ynx(21,12),t.YNc(22,rt,1,0,"th",13),t.YNc(23,ot,1,0,"td",9),t.BQk(),t.YNc(24,ct,1,0,"tr",14),t.YNc(25,st,1,0,"tr",15),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(5),t.Q6J("formGroup",i.filterForm),t.xp6(2),t.Q6J("options",i.intervalOptions),t.xp6(2),t.Q6J("ngIf","CUSTOM"===i.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==i.filterForm.value.interval),t.xp6(1),t.Q6J("dataSource",i.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns))},directives:[S.a,I.k,k,s._Y,s.JL,s.sg,b.P,s.JJ,s.u,f.O5,$.Y,m.BZ,m.w1,m.fO,m.ge,m.Dz,m.ev,m.as,m.XQ,m.nj,m.Gk],pipes:[w.i,K.N],encapsulation:2,changeDetection:0}),a})();var v=o(1764),q=o(7932),y=o(3874),Q=o(7238),mt=o(1711),_t=o(4594),C=o(496),ut=o(4953);const pt=["intervalSelect"];function dt(a,n){if(1&a){const e=t.EpF();t.ynx(0),t._UZ(1,"app-date-time-input",11),t._UZ(2,"app-date-time-input",12),t.TgZ(3,"button",13),t.NdJ("click",function(){return t.CHM(e),t.oxw().applyCustomDates()}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.filterForm.invalid)}}function gt(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",14),t.NdJ("click",function(){return t.CHM(e),t.oxw().jumpToNow()}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function ft(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Severity"),t.qZA())}function ht(a,n){if(1&a&&(t.TgZ(0,"td",34),t._UZ(1,"app-alarm-level",35),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("level",e.severity)}}function At(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Alarm type"),t.qZA())}function Tt(a,n){1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",36),t._uU(2,"event_note"),t.qZA(),t.BQk())}function xt(a,n){1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",36),t._uU(2,"toll"),t.qZA(),t.BQk())}function vt(a,n){if(1&a&&(t.TgZ(0,"td",34),t.YNc(1,Tt,3,0,"ng-container",6),t.YNc(2,xt,3,0,"ng-container",6),t._uU(3),t.ALo(4,"titlecase"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf","EVENT"===e.type),t.xp6(1),t.Q6J("ngIf","PARAMETER"===e.type),t.xp6(1),t.hij(" ",t.lcZ(4,3,e.type||"-")," ")}}function Zt(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Start"),t.qZA())}function yt(a,n){if(1&a&&(t.TgZ(0,"td",34),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.triggerTime)||"-")}}function bt(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Stop"),t.qZA())}function wt(a,n){if(1&a&&(t.TgZ(0,"td",34),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.updateTime)||"-"," ")}}function Ut(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Trip value"),t.qZA())}function St(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function It(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function Nt(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"value"),t.YNc(3,St,2,0,"span",6),t.YNc(4,It,2,0,"span",6),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,3,e.triggerValue.engValue)," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.triggerValue.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.triggerValue.rangeCondition)}}function kt(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",e.triggerEvent.message||"-"," ")}}function qt(a,n){if(1&a&&(t.TgZ(0,"td",37),t.YNc(1,Nt,5,5,"ng-container",6),t.YNc(2,kt,2,1,"ng-container",6),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",e.eventDetail)}}function Qt(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Alarm name"),t.qZA())}const D=function(a){return["/telemetry/parameters",a]},J=function(a){return{c:a}};function Ct(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",38),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2).$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("routerLink",t.VKq(4,D,e.id.namespace+"/"+e.id.name))("queryParams",t.VKq(6,J,i.yamcs.context)),t.xp6(1),t.AsE(" ",e.id.namespace,"/",e.id.name," ")}}function Dt(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.AsE(" ",e.id.namespace,"/",e.id.name," ")}}function Jt(a,n){if(1&a&&(t.ynx(0),t.YNc(1,Ct,3,8,"ng-container",6),t.YNc(2,Dt,2,2,"ng-container",6),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",!e.parameterDetail)}}function Yt(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",38),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2).$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("routerLink",t.VKq(3,D,e.id.namespace))("queryParams",t.VKq(5,J,i.yamcs.context)),t.xp6(1),t.hij(" ",e.id.namespace," ")}}function Pt(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.id.namespace," ")}}function Ht(a,n){if(1&a&&(t.ynx(0),t.YNc(1,Yt,3,7,"ng-container",6),t.YNc(2,Pt,2,1,"ng-container",6),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",!e.parameterDetail)}}function Lt(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",38),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2).$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("routerLink",t.VKq(3,D,e.id.name))("queryParams",t.VKq(5,J,i.yamcs.context)),t.xp6(1),t.hij(" ",e.id.name," ")}}function Ot(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.id.name," ")}}function Mt(a,n){if(1&a&&(t.ynx(0),t.YNc(1,Lt,3,7,"ng-container",6),t.YNc(2,Ot,2,1,"ng-container",6),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",!e.parameterDetail)}}function $t(a,n){if(1&a&&(t.TgZ(0,"td",34),t.YNc(1,Jt,3,2,"ng-container",6),t.YNc(2,Ht,3,2,"ng-container",6),t.YNc(3,Mt,3,2,"ng-container",6),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.id.namespace&&e.id.name),t.xp6(1),t.Q6J("ngIf",e.id.namespace&&!e.id.name),t.xp6(1),t.Q6J("ngIf",!e.id.namespace&&e.id.name)}}function Bt(a,n){1&a&&(t.TgZ(0,"th",33),t._uU(1,"Duration"),t.qZA())}function Ft(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"duration"),t.BQk()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,i.durationFor(e))||"-"," ")}}function Vt(a,n){if(1&a&&(t.TgZ(0,"mat-icon",40),t._uU(1,"comment"),t.qZA()),2&a){const e=t.oxw(2).$implicit;t.Q6J("matTooltip",null==e.clearInfo?null:e.clearInfo.clearMessage)}}function Et(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.YNc(2,Vt,2,1,"mat-icon",39),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" (cleared by ",null==e.clearInfo?null:e.clearInfo.clearedBy,") "),t.xp6(1),t.Q6J("ngIf",null==e.clearInfo?null:e.clearInfo.clearMessage)}}function jt(a,n){if(1&a&&(t.TgZ(0,"td",34),t.YNc(1,Ft,3,3,"ng-container",6),t.YNc(2,Et,3,2,"ng-container",6),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.updateTime),t.xp6(1),t.Q6J("ngIf",null==e.clearInfo?null:e.clearInfo.clearedBy)}}function Rt(a,n){1&a&&(t.TgZ(0,"th",41),t._uU(1,"Violations"),t.qZA())}function Gt(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"number"),t.ALo(3,"number"),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,e.violations)," (",t.xi3(3,4,e.violations/e.count*100,"1.2-2"),"%) ")}}function Kt(a,n){if(1&a&&(t.TgZ(0,"td",42),t.YNc(1,Gt,4,7,"ng-container",43),t.qZA()),2&a){const e=n.$implicit;t.oxw(2);const i=t.MAs(19);t.xp6(1),t.Q6J("ngIf",e.violations)("ngIfElse",i)}}function zt(a,n){1&a&&t._UZ(0,"th",44)}function Wt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"app-text-action",47),t.NdJ("click",function(){t.CHM(e);const l=t.oxw().$implicit;return t.oxw(2).showChart(l)}),t._uU(1," SHOW CHART "),t.qZA()}}function Xt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"app-text-action",48),t.NdJ("click",function(){t.CHM(e);const l=t.oxw().$implicit;return t.oxw(2).showData(l)}),t._uU(1," SHOW DATA "),t.qZA()}}function te(a,n){if(1&a&&(t.TgZ(0,"td",34),t.YNc(1,Wt,2,0,"app-text-action",45),t.YNc(2,Xt,2,0,"app-text-action",46),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",e.parameterDetail)}}function ee(a,n){1&a&&t._UZ(0,"tr",49)}function ae(a,n){1&a&&t._UZ(0,"tr",50)}function ne(a,n){if(1&a&&(t.TgZ(0,"table",15),t.ynx(1,16),t.YNc(2,ft,2,0,"th",17),t.YNc(3,ht,2,1,"td",18),t.BQk(),t.ynx(4,19),t.YNc(5,At,2,0,"th",17),t.YNc(6,vt,5,5,"td",18),t.BQk(),t.ynx(7,20),t.YNc(8,Zt,2,0,"th",17),t.YNc(9,yt,3,3,"td",18),t.BQk(),t.ynx(10,21),t.YNc(11,bt,2,0,"th",17),t.YNc(12,wt,3,3,"td",18),t.BQk(),t.ynx(13,22),t.YNc(14,Ut,2,0,"th",17),t.YNc(15,qt,3,2,"td",23),t.BQk(),t.ynx(16,24),t.YNc(17,Qt,2,0,"th",17),t.YNc(18,$t,4,3,"td",18),t.BQk(),t.ynx(19,25),t.YNc(20,Bt,2,0,"th",17),t.YNc(21,jt,3,2,"td",18),t.BQk(),t.ynx(22,26),t.YNc(23,Rt,2,0,"th",27),t.YNc(24,Kt,2,2,"td",28),t.BQk(),t.ynx(25,29),t.YNc(26,zt,1,0,"th",30),t.YNc(27,te,3,2,"td",18),t.BQk(),t.YNc(28,ee,1,0,"tr",31),t.YNc(29,ae,1,0,"tr",32),t.qZA()),2&a){const e=t.oxw();t.Q6J("dataSource",e.dataSource),t.xp6(28),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}function ie(a,n){1&a&&t._uU(0,"-")}let F=(()=>{class a{constructor(e,i,l,r){this.yamcs=e,this.router=i,this.route=l,this.messageService=r,this.filterForm=new s.cw({interval:new s.NI("NO_LIMIT"),customStart:new s.NI(null),customStop:new s.NI(null)}),this.displayedColumns=["severity","start","stop","duration","alarm","type","triggerValue","violations","actions"],this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.dataSource=new m.by,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(c=>{if("CUSTOM"===c){const _=new Date,g=this.validStart||_,u=this.validStop||_;this.filterForm.get("customStart").setValue(d.Y6(g)),this.filterForm.get("customStop").setValue(d.Y6(u))}else"NO_LIMIT"===c?(this.validStart=null,this.validStop=null,this.appliedInterval=c,this.loadData()):(this.validStop=new Date,this.validStart=(0,d.rV)(this.validStop,c),this.appliedInterval=c,this.loadData())})}initializeOptions(){const e=this.route.snapshot.queryParamMap;if(e.has("interval"))if(this.appliedInterval=e.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const i=e.get("customStart");this.filterForm.get("customStart").setValue(i),this.validStart=d.ZU(i);const l=e.get("customStop");this.filterForm.get("customStop").setValue(l),this.validStop=d.ZU(l)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=(0,d.rV)(this.validStop,this.appliedInterval));else this.appliedInterval="NO_LIMIT",this.validStop=null,this.validStart=null}jumpToNow(){this.filterForm.get("interval").setValue("NO_LIMIT")}applyCustomDates(){this.validStart=d.ZU(this.filterForm.value.customStart),this.validStop=d.ZU(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(e){this.updateURL();const i={};this.validStart&&(i.start=this.validStart.toISOString()),this.validStop&&(i.stop=this.validStop.toISOString()),this.yamcs.yamcsClient.getAlarms(this.yamcs.instance,i).then(l=>this.dataSource.data=l).catch(l=>this.messageService.showError(l))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}durationFor(e){if(e.updateTime)return d.ZU(e.updateTime).getTime()-d.ZU(e.triggerTime).getTime()}showChart(e){var i,l;const r=e.triggerTime,c=e.updateTime||(null===(i=e.clearInfo)||void 0===i?void 0:i.clearTime);let _,g;c?(_=v.utc(r),g=v.utc(c)):(_=v.utc(r),g=v.utc(c).add(1,"hour")),this.router.navigate(["/telemetry/parameters",null===(l=e.parameterDetail)||void 0===l?void 0:l.triggerValue.id.name,"chart"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:_.toISOString(),customStop:g.toISOString()}})}showData(e){var i,l;const r=e.triggerTime,c=e.updateTime||(null===(i=e.clearInfo)||void 0===i?void 0:i.clearTime);let _,g;c?(_=v.utc(r),g=v.utc(c)):(_=v.utc(r),g=v.utc(c).add(1,"hour")),this.router.navigate(["/telemetry/parameters",null===(l=e.parameterDetail)||void 0===l?void 0:l.triggerValue.id.name,"data"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:_.toISOString(),customStop:g.toISOString()}})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(x.C),t.Y36(h.F0),t.Y36(h.gz),t.Y36(U.e))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(e,i){if(1&e&&t.Gf(pt,5),2&e){let l;t.iGM(l=t.CRH())&&(i.intervalSelect=l.first)}},decls:20,vars:6,consts:[[1,"table-wrapper"],[1,"panel-content"],[2,"margin-top","16px",3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],[4,"ngIf"],["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf"],[2,"flex","1 1 auto"],[1,"ya-button",3,"disabled"],["dash",""],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","start"],["matColumnDef","stop"],["matColumnDef","triggerValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","alarm"],["matColumnDef","duration"],["matColumnDef","violations"],["mat-header-cell","","style","text-align: right",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level"],[2,"vertical-align","middle"],["mat-cell","",1,"wrap200"],[3,"routerLink","queryParams"],[3,"matTooltip",4,"ngIf"],[3,"matTooltip"],["mat-header-cell","",2,"text-align","right"],["mat-cell","",2,"text-align","right"],[4,"ngIf","ngIfElse"],["mat-header-cell","",1,"expand"],["icon","show_chart",3,"click",4,"ngIf"],["icon","view_headline",3,"click",4,"ngIf"],["icon","show_chart",3,"click"],["icon","view_headline",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,i){1&e&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar"),t._uU(2," Alarms "),t.qZA(),t.TgZ(3,"div",0),t.TgZ(4,"div",1),t._UZ(5,"app-alarms-page-tabs"),t.TgZ(6,"form",2),t.TgZ(7,"div",3),t._UZ(8,"app-select",4,5),t.YNc(10,dt,5,1,"ng-container",6),t.YNc(11,gt,3,0,"ng-container",6),t.qZA(),t.qZA(),t.YNc(12,ne,30,3,"table",7),t.TgZ(13,"mat-toolbar"),t._UZ(14,"span",8),t.TgZ(15,"button",9),t._uU(16,"Load More"),t.qZA(),t._UZ(17,"span",8),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(18,ie,1,0,"ng-template",null,10,t.W1O)),2&e&&(t.xp6(6),t.Q6J("formGroup",i.filterForm),t.xp6(2),t.Q6J("options",i.intervalOptions),t.xp6(2),t.Q6J("ngIf","CUSTOM"===i.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==i.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf",i.dataSource),t.xp6(3),t.Q6J("disabled",!0))},directives:[S.a,I.k,k,s._Y,s.JL,s.sg,b.P,s.JJ,s.u,f.O5,$.Y,m.BZ,m.w1,m.fO,m.ge,m.Dz,m.ev,q.i,y.Hw,h.yS,Q.gM,mt.l,m.as,m.XQ,m.nj,m.Gk,_t.Ye],pipes:[f.rS,w.i,C.V,ut.u,f.JJ],encapsulation:2,changeDetection:0}),a})();var Z=o(1135),le=o(8372),re=o(1731),oe=o(4273),A=o(8966);function se(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.hij("/",e.data.alarms[0].id.name," ")}}function me(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.YNc(2,se,2,1,"ng-container",2),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.data.alarms[0].id.namespace,""),t.xp6(1),t.Q6J("ngIf",e.data.alarms[0].id.name)}}function _e(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.data.alarms.length," selected alarms. ")}}let ue=(()=>{class a{constructor(e,i,l,r){this.dialogRef=e,this.yamcs=l,this.data=r,this.formGroup=i.group({comment:void 0})}acknowledge(){return function(a,n,e,i){return new(e||(e=Promise))(function(r,c){function _(p){try{u(i.next(p))}catch(T){c(T)}}function g(p){try{u(i.throw(p))}catch(T){c(T)}}function u(p){p.done?r(p.value):function l(r){return r instanceof e?r:new e(function(c){c(r)})}(p.value).then(_,g)}u((i=i.apply(a,n||[])).next())})}(this,void 0,void 0,function*(){const e=this.data.alarms,i=this.formGroup.get("comment").value;for(const l of e){const r={};i&&(r.comment=i),this.yamcs.yamcsClient.acknowledgeAlarm(this.yamcs.instance,this.yamcs.processor,l.id.namespace+(l.id.name?"/"+l.id.name:""),l.seqNum,r)}this.dialogRef.close()})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(A.so),t.Y36(s.qu),t.Y36(x.C),t.Y36(A.WI))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-acknowledge-alarm-dialog"]],decls:15,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[4,"ngIf"],[1,"ya-form",3,"formGroup"],["formControlName","comment","rows","5",2,"resize","none"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Acknowledge"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.TgZ(3,"p"),t.YNc(4,me,3,2,"ng-container",2),t.YNc(5,_e,2,1,"ng-container",2),t.qZA(),t.TgZ(6,"form",3),t.TgZ(7,"label"),t._uU(8," Comment "),t._UZ(9,"textarea",4),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"mat-dialog-actions",5),t.TgZ(11,"button",6),t._uU(12,"CANCEL"),t.qZA(),t.TgZ(13,"button",7),t.NdJ("click",function(){return i.acknowledge()}),t._uU(14,"OK"),t.qZA(),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngIf",1===i.data.alarms.length),t.xp6(1),t.Q6J("ngIf",1!==i.data.alarms.length),t.xp6(1),t.Q6J("formGroup",i.formGroup),t.xp6(7),t.Q6J("disabled",!i.formGroup.valid))},directives:[A.uh,A.xY,f.O5,s._Y,s.JL,s.sg,s.Fj,s.JJ,s.u,A.H8,A.ZT],encapsulation:2,changeDetection:0}),a})();var pe=o(449),Y=o(4004);class de extends pe.o2{constructor(n){super(),this.yamcs=n,this.alarms$=new Z.X([]),this.filteredAlarms$=new Z.X([]),this.loading$=new Z.X(!1),this.alarmsByName={},this.filter=null,this.unacknowledgedAlarms$=this.alarms$.pipe((0,Y.U)(e=>e.filter(i=>!i.shelveInfo&&!i.acknowledged))),this.acknowledgedAlarms$=this.alarms$.pipe((0,Y.U)(e=>e.filter(i=>!i.shelveInfo&&i.acknowledged))),this.shelvedAlarms$=this.alarms$.pipe((0,Y.U)(e=>e.filter(i=>!!i.shelveInfo)))}connect(){return this.filteredAlarms$}setFilter(n){this.filter=n||null}loadAlarms(){this.loading$.next(!0),this.yamcs.yamcsClient.getActiveAlarms(this.yamcs.instance,this.yamcs.processor).then(n=>{this.loading$.next(!1);for(const e of n)this.processAlarm(e);this.updateSubject()}),this.alarmSubscription=this.yamcs.yamcsClient.createAlarmSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor},n=>{this.processAlarm(n),this.updateSubject()})}updateSubject(){const e=[...Object.values(this.alarmsByName).sort((i,l)=>{let r=i.acknowledged===l.acknowledged?0:i.acknowledged?1:-1;if(0===r){const c=this.getNumericSeverity(i.severity),_=this.getNumericSeverity(l.severity);r=c===_?0:c<_?1:-1}return 0===r&&(r=(i.id.namespace+"/"+i.id.name).localeCompare(l.id.namespace+"/"+l.id.name)),r})];if(this.alarms$.next(e),this.filter){const i=e.filter(l=>-1!==(l.id.namespace+"/"+l.id.name).toLowerCase().indexOf(this.filter));this.filteredAlarms$.next(i)}else this.filteredAlarms$.next(e)}getNumericSeverity(n){switch(n){case"WATCH":return 0;case"WARNING":return 1;case"DISTRESS":return 2;case"CRITICAL":return 3;case"SEVERE":return 4;default:return 5}}disconnect(){this.alarms$.complete(),this.filteredAlarms$.complete(),this.loading$.complete(),this.alarmSubscription&&this.alarmSubscription.cancel()}isEmpty(){return!this.filteredAlarms$.getValue().length}processAlarm(n){const e=n.id.namespace+"/"+n.id.name;n.processOK&&!n.triggered&&n.acknowledged?delete this.alarmsByName[e]:this.alarmsByName[e]=n}}function fe(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.hij("/",e.data.alarms[0].id.name," ")}}function he(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.YNc(2,fe,2,1,"ng-container",2),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.data.alarms[0].id.namespace,""),t.xp6(1),t.Q6J("ngIf",e.data.alarms[0].id.name)}}function Ae(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.data.alarms.length," selected alarms. ")}}let Te=(()=>{class a{constructor(e,i,l,r){this.dialogRef=e,this.yamcs=l,this.data=r,this.durationOptions=[{id:"PT15M",label:"15 minutes"},{id:"PT30M",label:"30 minutes"},{id:"PT1H",label:"1 hour"},{id:"PT2H",label:"2 hours"},{id:"P1D",label:"1 day"},{id:"UNLIMITED",label:"unlimited"}],this.formGroup=i.group({duration:"PT2H",comment:void 0})}shelve(){return function(a,n,e,i){return new(e||(e=Promise))(function(r,c){function _(p){try{u(i.next(p))}catch(T){c(T)}}function g(p){try{u(i.throw(p))}catch(T){c(T)}}function u(p){p.done?r(p.value):function l(r){return r instanceof e?r:new e(function(c){c(r)})}(p.value).then(_,g)}u((i=i.apply(a,n||[])).next())})}(this,void 0,void 0,function*(){const e=this.data.alarms,i=this.formGroup.get("comment").value;let l=null;if("UNLIMITED"!==this.formGroup.get("duration").value){const r=this.formGroup.get("duration").value;l=d.Uw(r)}for(const r of e){const c={};i&&(c.comment=i),l&&(c.shelveDuration=l),this.yamcs.yamcsClient.shelveAlarm(this.yamcs.instance,this.yamcs.processor,r.id.namespace+(r.id.name?"/"+r.id.name:""),r.seqNum,c)}this.dialogRef.close()})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(A.so),t.Y36(s.qu),t.Y36(x.C),t.Y36(A.WI))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-shelve-alarm-dialog"]],decls:20,vars:5,consts:[["mat-dialog-title",""],[1,"mat-typography"],[4,"ngIf"],[1,"ya-form",3,"formGroup"],["formControlName","duration",3,"options"],["formControlName","comment","rows","5",2,"resize","none"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Shelve"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.TgZ(3,"p"),t.YNc(4,he,3,2,"ng-container",2),t.YNc(5,Ae,2,1,"ng-container",2),t.qZA(),t.TgZ(6,"form",3),t.TgZ(7,"label"),t._uU(8," Duration"),t._UZ(9,"br"),t._UZ(10,"app-select",4),t.qZA(),t._UZ(11,"br"),t.TgZ(12,"label"),t._uU(13," Comment "),t._UZ(14,"textarea",5),t.qZA(),t.qZA(),t.qZA(),t.TgZ(15,"mat-dialog-actions",6),t.TgZ(16,"button",7),t._uU(17,"CANCEL"),t.qZA(),t.TgZ(18,"button",8),t.NdJ("click",function(){return i.shelve()}),t._uU(19,"OK"),t.qZA(),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngIf",1===i.data.alarms.length),t.xp6(1),t.Q6J("ngIf",1!==i.data.alarms.length),t.xp6(1),t.Q6J("formGroup",i.formGroup),t.xp6(4),t.Q6J("options",i.durationOptions),t.xp6(8),t.Q6J("disabled",!i.formGroup.valid))},directives:[A.uh,A.xY,f.O5,s._Y,s.JL,s.sg,b.P,s.JJ,s.u,s.Fj,A.H8,A.ZT],encapsulation:2,changeDetection:0}),a})();var xe=o(2313),ve=o(97),Ze=o(7423),ye=o(3284),be=o(3156),we=o(4834),Ue=o(3847);const Se=function(a){return["/telemetry/parameters/",a]},Ie=function(a){return{c:a}};function Ne(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"div",1),t._uU(2,"Parameter"),t.qZA(),t.TgZ(3,"div",2),t.TgZ(4,"a",5),t._uU(5),t.qZA(),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("routerLink",t.VKq(4,Se,e.alarm.id.namespace+"/"+e.alarm.id.name))("queryParams",t.VKq(6,Ie,e.yamcs.context)),t.xp6(1),t.AsE(" ",e.alarm.id.namespace,"/",e.alarm.id.name," ")}}function ke(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.AsE(" ",e.alarm.id.namespace,"/",e.alarm.id.name," ")}}function qe(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.alarm.id.namespace," ")}}function Qe(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"div",1),t._uU(2,"Event"),t.qZA(),t.TgZ(3,"div",2),t.YNc(4,ke,2,2,"ng-container",0),t.YNc(5,qe,2,1,"ng-container",0),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.alarm.id.name),t.xp6(1),t.Q6J("ngIf",!e.alarm.id.name)}}function Ce(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function De(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function Je(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function Ye(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function Pe(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"br"),t._UZ(2,"mat-divider"),t.TgZ(3,"div",1),t._uU(4,"Trigger value"),t.qZA(),t.TgZ(5,"div",2),t._UZ(6,"app-alarm-level",6),t._uU(7),t.ALo(8,"value"),t.YNc(9,Ce,2,0,"span",0),t.YNc(10,De,2,0,"span",0),t.qZA(),t._UZ(11,"br"),t._UZ(12,"mat-divider"),t.TgZ(13,"div",1),t._uU(14,"Live value"),t.qZA(),t.TgZ(15,"div",2),t.TgZ(16,"app-expirable",7),t._UZ(17,"app-alarm-level",6),t._uU(18),t.ALo(19,"value"),t.YNc(20,Je,2,0,"span",0),t.YNc(21,Ye,2,0,"span",0),t.qZA(),t.qZA(),t.BQk()),2&a){const e=n.ngIf,i=t.oxw();t.xp6(6),t.Q6J("level",i.alarm.severity)("grayscale",!0),t.xp6(1),t.hij(" \xa0",t.lcZ(8,11,e.triggerValue.engValue)," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.triggerValue.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.triggerValue.rangeCondition),t.xp6(6),t.Q6J("pval",e.currentValue),t.xp6(1),t.Q6J("level",e.currentValue.monitoringResult)("grayscale",!0),t.xp6(1),t.hij(" \xa0",t.lcZ(19,13,e.currentValue.engValue)," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.currentValue.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.currentValue.rangeCondition)}}function He(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"br"),t._UZ(2,"mat-divider"),t.TgZ(3,"div",1),t._uU(4,"Trigger event"),t.qZA(),t.TgZ(5,"div",2),t._uU(6),t.qZA(),t.BQk()),2&a){const e=n.ngIf;t.xp6(6),t.hij(" ",e.triggerEvent.message," ")}}function Le(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"blockquote",8),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.alarm.acknowledgeInfo.acknowledgeMessage," ")}}function Oe(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"br"),t._UZ(2,"mat-divider"),t.TgZ(3,"div",1),t._uU(4),t.qZA(),t.TgZ(5,"div",2),t._uU(6),t.ALo(7,"datetime"),t.YNc(8,Le,3,1,"ng-container",0),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.hij("Acknowledged by ",e.alarm.acknowledgeInfo.acknowledgedBy,""),t.xp6(2),t.hij(" On ",t.lcZ(7,3,e.alarm.acknowledgeInfo.acknowledgeTime)," "),t.xp6(2),t.Q6J("ngIf",e.alarm.acknowledgeInfo.acknowledgeMessage)}}function Me(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"blockquote",8),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.alarm.shelveInfo.shelveMessage," ")}}function $e(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"div",1),t._uU(2,"Shelve Expiration"),t.qZA(),t.TgZ(3,"div",2),t._uU(4),t.ALo(5,"datetime"),t.qZA(),t.BQk()),2&a){const e=t.oxw(2);t.xp6(4),t.hij(" ",t.lcZ(5,1,e.alarm.shelveInfo.shelveExpiration)," ")}}function Be(a,n){if(1&a&&(t.ynx(0),t._UZ(1,"br"),t._UZ(2,"mat-divider"),t.TgZ(3,"div",1),t._uU(4),t.qZA(),t.TgZ(5,"div",2),t._uU(6),t.ALo(7,"datetime"),t.YNc(8,Me,3,1,"ng-container",0),t.qZA(),t.YNc(9,$e,6,3,"ng-container",0),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.hij("Shelved by ",e.alarm.shelveInfo.shelvedBy,""),t.xp6(2),t.hij(" On ",t.lcZ(7,4,e.alarm.shelveInfo.shelveTime)," "),t.xp6(2),t.Q6J("ngIf",e.alarm.shelveInfo.shelveMessage),t.xp6(1),t.Q6J("ngIf",e.alarm.shelveInfo.shelveExpiration)}}function Fe(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const l=t.oxw(2);return l.acknowledgeAlarm.emit(l.alarm)}),t.TgZ(1,"mat-icon"),t._uU(2,"notifications_off"),t.qZA(),t._uU(3," ACKNOWLEDGE "),t.qZA()}}function Ve(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const l=t.oxw(2);return l.shelveAlarm.emit(l.alarm)}),t.TgZ(1,"mat-icon"),t._uU(2,"timer"),t.qZA(),t._uU(3," SHELVE "),t.qZA()}}function Ee(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const l=t.oxw(2);return l.unshelveAlarm.emit(l.alarm)}),t.TgZ(1,"mat-icon"),t._uU(2,"timer_off"),t.qZA(),t._uU(3," UNSHELVE "),t.qZA()}}function je(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",9),t.YNc(1,Fe,4,0,"button",10),t.YNc(2,Ve,4,0,"button",10),t.YNc(3,Ee,4,0,"button",10),t.TgZ(4,"button",11),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return l.clearAlarm.emit(l.alarm)}),t.TgZ(5,"mat-icon"),t._uU(6,"clear_all"),t.qZA(),t._uU(7," CLEAR "),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.alarm.shelveInfo&&!e.alarm.acknowledged),t.xp6(1),t.Q6J("ngIf",!e.alarm.shelveInfo),t.xp6(1),t.Q6J("ngIf",e.alarm.shelveInfo)}}let Re=(()=>{class a{constructor(e){this.yamcs=e,this.mayControl=!1,this.acknowledgeAlarm=new t.vpe,this.shelveAlarm=new t.vpe,this.unshelveAlarm=new t.vpe,this.clearAlarm=new t.vpe}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(x.C))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-alarm-detail"]],inputs:{alarm:"alarm",mayControl:"mayControl"},outputs:{acknowledgeAlarm:"acknowledgeAlarm",shelveAlarm:"shelveAlarm",unshelveAlarm:"unshelveAlarm",clearAlarm:"clearAlarm"},decls:17,vars:12,consts:[[4,"ngIf"],[1,"block-title"],[1,"block"],[3,"level"],["class","action-bar",4,"ngIf"],[1,"ya-link",3,"routerLink","queryParams"],[3,"level","grayscale"],[3,"pval"],[2,"border-left","4px solid #eee","padding-left","1em","font-style","italic"],[1,"action-bar"],["class","ya-button",3,"click",4,"ngIf"],[1,"ya-button",3,"click"]],template:function(e,i){1&e&&(t.YNc(0,Ne,6,8,"ng-container",0),t.YNc(1,Qe,6,2,"ng-container",0),t.TgZ(2,"div",1),t._uU(3,"Severity"),t.qZA(),t.TgZ(4,"div",2),t._UZ(5,"app-alarm-level",3),t._uU(6),t.qZA(),t.TgZ(7,"div",1),t._uU(8,"Violations"),t.qZA(),t.TgZ(9,"div",2),t._uU(10),t.ALo(11,"number"),t.qZA(),t.YNc(12,Pe,22,15,"ng-container",0),t.YNc(13,He,7,1,"ng-container",0),t.YNc(14,Oe,9,5,"ng-container",0),t.YNc(15,Be,10,6,"ng-container",0),t.YNc(16,je,8,3,"div",4)),2&e&&(t.Q6J("ngIf","PARAMETER"===i.alarm.type),t.xp6(1),t.Q6J("ngIf","EVENT"===i.alarm.type),t.xp6(4),t.Q6J("level",i.alarm.severity),t.xp6(1),t.hij(" ",i.alarm.severity,"\n"),t.xp6(4),t.hij(" ",t.lcZ(11,10,i.alarm.violations),"\n"),t.xp6(2),t.Q6J("ngIf",i.alarm.parameterDetail),t.xp6(1),t.Q6J("ngIf",i.alarm.eventDetail),t.xp6(1),t.Q6J("ngIf",i.alarm.acknowledgeInfo),t.xp6(1),t.Q6J("ngIf",i.alarm.shelveInfo),t.xp6(1),t.Q6J("ngIf",i.mayControl))},directives:[f.O5,h.yS,q.i,we.d,Ue.Y,y.Hw],pipes:[f.JJ,C.V,w.i],styles:[".mat-raised-button[_ngcontent-%COMP%]{margin-right:10px}"],changeDetection:0}),a})();var Ge=o(9971),Ke=o(5328);function ze(a,n){1&a&&(t.TgZ(0,"mat-icon",5),t._uU(1,"timer"),t.qZA())}function We(a,n){1&a&&(t.TgZ(0,"mat-icon",6),t._uU(1,"check_circle"),t.qZA())}function Xe(a,n){if(1&a&&(t.TgZ(0,"mat-icon",7),t.ALo(1,"async"),t._uU(2,"notifications"),t.qZA()),2&a){const e=t.oxw();t.Udp("visibility",t.lcZ(1,2,e.visibility$)?"visible":"hidden")}}function ta(a,n){1&a&&(t.TgZ(0,"mat-icon",8),t._uU(1,"check_circle_outline"),t.qZA())}function ea(a,n){if(1&a&&(t.TgZ(0,"mat-icon",9),t.ALo(1,"async"),t._uU(2,"notifications_none"),t.qZA()),2&a){const e=t.oxw();t.Udp("visibility",t.lcZ(1,2,e.visibility$)?"visible":"hidden")}}let aa=(()=>{class a{constructor(e){this.visibility$=new Z.X(!0),this.syncSubscription=e.syncFast(()=>{this.visibility$.next(!this.visibility$.value)})}ngOnDestroy(){this.syncSubscription&&this.syncSubscription.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Ke.j))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-alarm-state-icon"]],inputs:{alarm:"alarm"},decls:5,vars:5,consts:[["matTooltip","Shelved",4,"ngIf"],["matTooltip","Active, acknowledged",4,"ngIf"],["matTooltip","Active, unacknowledged",3,"visibility",4,"ngIf"],["matTooltip","RTN, acknowledged",4,"ngIf"],["matTooltip","RTN, unacknowledged",3,"visibility",4,"ngIf"],["matTooltip","Shelved"],["matTooltip","Active, acknowledged"],["matTooltip","Active, unacknowledged"],["matTooltip","RTN, acknowledged"],["matTooltip","RTN, unacknowledged"]],template:function(e,i){1&e&&(t.YNc(0,ze,2,0,"mat-icon",0),t.YNc(1,We,2,0,"mat-icon",1),t.YNc(2,Xe,3,4,"mat-icon",2),t.YNc(3,ta,2,0,"mat-icon",3),t.YNc(4,ea,3,4,"mat-icon",4)),2&e&&(t.Q6J("ngIf",i.alarm.shelveInfo),t.xp6(1),t.Q6J("ngIf",!i.alarm.shelveInfo&&!i.alarm.processOK&&i.alarm.acknowledged),t.xp6(1),t.Q6J("ngIf",!i.alarm.shelveInfo&&!i.alarm.processOK&&!i.alarm.acknowledged),t.xp6(1),t.Q6J("ngIf",!i.alarm.shelveInfo&&i.alarm.processOK&&i.alarm.acknowledged),t.xp6(1),t.Q6J("ngIf",!i.alarm.shelveInfo&&i.alarm.processOK&&!i.alarm.acknowledged))},directives:[f.O5,y.Hw,Q.gM],pipes:[f.Ov],encapsulation:2}),a})();var na=o(160),ia=o(8493),la=o(2181);function ra(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Alarm type"),t.qZA())}function oa(a,n){1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",23),t._uU(2,"event_note"),t.qZA(),t.BQk())}function ca(a,n){1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",23),t._uU(2,"toll"),t.qZA(),t.BQk())}function sa(a,n){if(1&a&&(t.TgZ(0,"td",21),t.YNc(1,oa,3,0,"ng-container",22),t.YNc(2,ca,3,0,"ng-container",22),t._uU(3),t.ALo(4,"titlecase"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf","EVENT"===e.type),t.xp6(1),t.Q6J("ngIf","PARAMETER"===e.type),t.xp6(1),t.hij(" ",t.lcZ(4,3,e.type||"-")," ")}}function ma(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Alarm name"),t.qZA())}const P=function(a){return["/telemetry/parameters",a]},H=function(a){return{c:a}};function _a(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",24),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2).$implicit,i=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(4,P,e.id.namespace+"/"+e.id.name))("queryParams",t.VKq(6,H,i.yamcs.context)),t.xp6(1),t.AsE(" ",e.id.namespace,"/",e.id.name," ")}}function ua(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.AsE(" ",e.id.namespace,"/",e.id.name," ")}}function pa(a,n){if(1&a&&(t.ynx(0),t.YNc(1,_a,3,8,"ng-container",22),t.YNc(2,ua,2,2,"ng-container",22),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",!e.parameterDetail)}}function da(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",24),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2).$implicit,i=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(3,P,e.id.namespace))("queryParams",t.VKq(5,H,i.yamcs.context)),t.xp6(1),t.hij(" ",e.id.namespace," ")}}function ga(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.id.namespace," ")}}function fa(a,n){if(1&a&&(t.ynx(0),t.YNc(1,da,3,7,"ng-container",22),t.YNc(2,ga,2,1,"ng-container",22),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",!e.parameterDetail)}}function ha(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"a",24),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2).$implicit,i=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(3,P,e.id.name))("queryParams",t.VKq(5,H,i.yamcs.context)),t.xp6(1),t.hij(" ",e.id.name," ")}}function Aa(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.id.name," ")}}function Ta(a,n){if(1&a&&(t.ynx(0),t.YNc(1,ha,3,7,"ng-container",22),t.YNc(2,Aa,2,1,"ng-container",22),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",!e.parameterDetail)}}function xa(a,n){if(1&a&&(t.TgZ(0,"td",21),t.YNc(1,pa,3,2,"ng-container",22),t.YNc(2,fa,3,2,"ng-container",22),t.YNc(3,Ta,3,2,"ng-container",22),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.id.namespace&&e.id.name),t.xp6(1),t.Q6J("ngIf",e.id.namespace&&!e.id.name),t.xp6(1),t.Q6J("ngIf",!e.id.namespace&&e.id.name)}}function va(a,n){1&a&&(t.TgZ(0,"th",25),t._uU(1,"State"),t.qZA())}function Za(a,n){if(1&a&&(t.TgZ(0,"td",26),t._UZ(1,"app-alarm-state-icon",27),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("alarm",e)}}function ya(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Alarm time"),t.qZA())}function ba(a,n){if(1&a&&(t.TgZ(0,"td",21),t.TgZ(1,"span",28),t.ALo(2,"datetime"),t._UZ(3,"app-ago",29),t.qZA(),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("matTooltip",t.lcZ(2,2,e.triggerTime)),t.xp6(2),t.Q6J("time",e.triggerTime)}}function wa(a,n){1&a&&(t.TgZ(0,"th",25),t._uU(1,"Severity"),t.qZA())}function Ua(a,n){if(1&a&&(t.TgZ(0,"td",26),t._UZ(1,"app-alarm-level",30),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("level",e.severity)}}function Sa(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Trip value"),t.qZA())}function Ia(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function Na(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function ka(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"value"),t.YNc(3,Ia,2,0,"span",22),t.YNc(4,Na,2,0,"span",22),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,3,e.triggerValue.engValue)," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.triggerValue.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.triggerValue.rangeCondition)}}function qa(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",e.triggerEvent.message||"-"," ")}}function Qa(a,n){if(1&a&&(t.TgZ(0,"td",31),t.YNc(1,ka,5,5,"ng-container",22),t.YNc(2,qa,2,1,"ng-container",22),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",e.eventDetail)}}function Ca(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Live value"),t.qZA())}function Da(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function Ja(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function Ya(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"value"),t.YNc(3,Da,2,0,"span",22),t.YNc(4,Ja,2,0,"span",22),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,3,e.currentValue.engValue)," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.currentValue.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.currentValue.rangeCondition)}}function Pa(a,n){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=n.ngIf;t.xp6(1),t.hij(" ",e.triggerEvent.message||"-"," ")}}function Ha(a,n){if(1&a&&(t.TgZ(0,"td",31),t.YNc(1,Ya,5,5,"ng-container",22),t.YNc(2,Pa,2,1,"ng-container",22),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail),t.xp6(1),t.Q6J("ngIf",e.eventDetail)}}function La(a,n){1&a&&(t.TgZ(0,"th",20),t._uU(1,"Violations"),t.qZA())}function Oa(a,n){if(1&a&&(t.TgZ(0,"td",32),t._uU(1),t.ALo(2,"number"),t.ALo(3,"number"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,e.violations)," (",t.xi3(3,4,e.violations/e.count*100,"1.2-2"),"%) ")}}function Ma(a,n){1&a&&t._UZ(0,"th",33)}function $a(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"app-more"),t.TgZ(1,"button",34),t.NdJ("click",function(){t.CHM(e);const l=t.oxw().$implicit;return t.oxw().acknowledgeAlarm.emit(l)}),t._uU(2," Acknowledge... "),t.qZA(),t.TgZ(3,"button",34),t.NdJ("click",function(){t.CHM(e);const l=t.oxw().$implicit;return t.oxw().shelveAlarm.emit(l)}),t._uU(4," Shelve... "),t.qZA(),t.TgZ(5,"button",34),t.NdJ("click",function(){t.CHM(e);const l=t.oxw().$implicit;return t.oxw().unshelveAlarm.emit(l)}),t._uU(6," Unshelve "),t.qZA(),t.qZA()}if(2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("disabled",e.shelveInfo||e.acknowledged),t.xp6(2),t.Q6J("disabled",e.shelveInfo),t.xp6(2),t.Q6J("disabled",!e.shelveInfo)}}function Ba(a,n){if(1&a&&(t.TgZ(0,"td",21),t.YNc(1,$a,7,3,"app-more",22),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.mayControl)}}function Fa(a,n){1&a&&t._UZ(0,"tr",35)}function Va(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"tr",36),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw().toggleOne(r)}),t.qZA()}if(2&a){const e=n.$implicit,i=t.oxw();t.ekj("selected",i.selection.isSelected(e))("hide",i.hideAlarm(e))}}function Ea(a,n){1&a&&t._uU(0,"-")}let ja=(()=>{class a{constructor(e){this.yamcs=e,this.displayedColumns=["state","severity","time","alarm","type","trip_value","live_value","actions"],this.view="standard",this.mayControl=!1,this.acknowledgeAlarm=new t.vpe,this.shelveAlarm=new t.vpe,this.unshelveAlarm=new t.vpe,this.tableTrackerFn=(i,l)=>`${l.triggerTime}__${l.id.namespace}__${l.id.name}__${l.seqNum}`}toggleOne(e){(!this.selection.isSelected(e)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(e)}hideAlarm(e){return"standard"===this.view?!!e.shelveInfo:"all"!==this.view&&("unacknowledged"===this.view?!!e.shelveInfo||e.acknowledged:"acknowledged"===this.view?!!e.shelveInfo||!e.acknowledged:"shelved"===this.view?!e.shelveInfo:void 0)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(x.C))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-alarms-table"]],inputs:{dataSource:"dataSource",selection:"selection",view:"view",mayControl:"mayControl"},outputs:{acknowledgeAlarm:"acknowledgeAlarm",shelveAlarm:"shelveAlarm",unshelveAlarm:"unshelveAlarm"},decls:32,vars:6,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource","trackBy"],["matColumnDef","type"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","alarm"],["matColumnDef","state"],["mat-header-cell","","class","status",4,"matHeaderCellDef"],["mat-cell","","class","status",4,"matCellDef"],["matColumnDef","time"],["matColumnDef","severity"],["matColumnDef","trip_value"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","live_value"],["matColumnDef","violations"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","style","width: 100%",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","hide","click",4,"matRowDef","matRowDefColumns"],["dash",""],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],[2,"vertical-align","middle"],[3,"routerLink","queryParams"],["mat-header-cell","",1,"status"],["mat-cell","",1,"status"],[3,"alarm"],[3,"matTooltip"],[3,"time"],[3,"level"],["mat-cell","",1,"wrap200"],["mat-cell","",2,"text-align","right"],["mat-header-cell","",2,"width","100%"],["mat-menu-item","",3,"disabled","click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"table",0),t.ynx(1,1),t.YNc(2,ra,2,0,"th",2),t.YNc(3,sa,5,5,"td",3),t.BQk(),t.ynx(4,4),t.YNc(5,ma,2,0,"th",2),t.YNc(6,xa,4,3,"td",3),t.BQk(),t.ynx(7,5),t.YNc(8,va,2,0,"th",6),t.YNc(9,Za,2,1,"td",7),t.BQk(),t.ynx(10,8),t.YNc(11,ya,2,0,"th",2),t.YNc(12,ba,4,4,"td",3),t.BQk(),t.ynx(13,9),t.YNc(14,wa,2,0,"th",6),t.YNc(15,Ua,2,1,"td",7),t.BQk(),t.ynx(16,10),t.YNc(17,Sa,2,0,"th",2),t.YNc(18,Qa,3,2,"td",11),t.BQk(),t.ynx(19,12),t.YNc(20,Ca,2,0,"th",2),t.YNc(21,Ha,3,2,"td",11),t.BQk(),t.ynx(22,13),t.YNc(23,La,2,0,"th",2),t.YNc(24,Oa,4,7,"td",14),t.BQk(),t.ynx(25,15),t.YNc(26,Ma,1,0,"th",16),t.YNc(27,Ba,2,1,"td",3),t.BQk(),t.YNc(28,Fa,1,0,"tr",17),t.YNc(29,Va,1,4,"tr",18),t.qZA(),t.YNc(30,Ea,1,0,"ng-template",null,19,t.W1O)),2&e&&(t.ekj("hide",i.dataSource.isEmpty()),t.Q6J("dataSource",i.dataSource)("trackBy",i.tableTrackerFn),t.xp6(28),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns))},directives:[m.BZ,m.w1,m.fO,m.ge,m.Dz,m.ev,f.O5,y.Hw,h.yS,aa,Q.gM,na.E,q.i,ia.T,la.OP,m.as,m.XQ,m.nj,m.Gk],pipes:[f.rS,w.i,C.V,f.JJ],styles:[".hide[_ngcontent-%COMP%]{display:none}"]}),a})();function Ra(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return l.acknowledgeAlarms(l.selection.selected)}),t.TgZ(1,"mat-icon"),t._uU(2,"notifications_off"),t.qZA(),t._uU(3," ACKNOWLEDGE "),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("disabled",!e.selection.hasValue())}}function Ga(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return l.shelveAlarms(l.selection.selected)}),t.TgZ(1,"mat-icon"),t._uU(2,"timer"),t.qZA(),t._uU(3," SHELVE "),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("disabled",!e.selection.hasValue())}}function Ka(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-detail-toolbar"),t._uU(2," Alarm Detail "),t.qZA(),t.TgZ(3,"div",10),t.TgZ(4,"app-alarm-detail",11),t.NdJ("acknowledgeAlarm",function(l){return t.CHM(e),t.oxw().acknowledgeAlarms([l])})("shelveAlarm",function(l){return t.CHM(e),t.oxw().shelveAlarms([l])})("unshelveAlarm",function(l){return t.CHM(e),t.oxw().unshelveAlarms([l])})("clearAlarm",function(l){return t.CHM(e),t.oxw().clearAlarms([l])}),t.qZA(),t.qZA(),t.BQk()}if(2&a){const e=n.ngIf,i=t.oxw();t.xp6(4),t.Q6J("alarm",e)("mayControl",i.mayControlAlarms())}}function za(a,n){1&a&&(t.TgZ(0,"app-detail-toolbar"),t._uU(1," Select an alarm "),t.qZA())}function Wa(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",12),t._UZ(1,"app-alarms-page-tabs"),t.TgZ(2,"dl",13),t.TgZ(3,"dt"),t._uU(4,"Unacknowledged alarms:"),t.qZA(),t.TgZ(5,"dd"),t.TgZ(6,"strong"),t._uU(7),t.ALo(8,"async"),t.qZA(),t.qZA(),t.TgZ(9,"dt"),t._uU(10,"Acknowledged alarms:"),t.qZA(),t.TgZ(11,"dd"),t.TgZ(12,"strong"),t._uU(13),t.ALo(14,"async"),t.qZA(),t.qZA(),t.TgZ(15,"dt"),t._uU(16,"Shelved alarms:"),t.qZA(),t.TgZ(17,"dd"),t.TgZ(18,"strong"),t._uU(19),t.ALo(20,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(21,"form",14),t.TgZ(22,"div",15),t._UZ(23,"app-search-filter",16),t._UZ(24,"app-select",17),t.qZA(),t.qZA(),t.TgZ(25,"app-alarms-table",18),t.NdJ("acknowledgeAlarm",function(l){return t.CHM(e),t.oxw().acknowledgeAlarms([l])})("shelveAlarm",function(l){return t.CHM(e),t.oxw().shelveAlarms([l])})("unshelveAlarm",function(l){return t.CHM(e),t.oxw().unshelveAlarms([l])})("clearAlarm",function(l){return t.CHM(e),t.oxw().clearAlarms([l])}),t.ALo(26,"async"),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();let i,l,r;t.xp6(7),t.Oqu(null==(i=t.lcZ(8,9,e.dataSource.unacknowledgedAlarms$))?null:i.length),t.xp6(6),t.Oqu(null==(l=t.lcZ(14,11,e.dataSource.acknowledgedAlarms$))?null:l.length),t.xp6(6),t.Oqu(null==(r=t.lcZ(20,13,e.dataSource.shelvedAlarms$))?null:r.length),t.xp6(2),t.Q6J("formGroup",e.filterForm),t.xp6(3),t.Q6J("options",e.viewOptions),t.xp6(1),t.Q6J("dataSource",e.dataSource)("selection",e.selection)("view",t.lcZ(26,15,e.view$))("mayControl",e.mayControlAlarms())}}const Xa=[{path:"",canActivate:[O.a,j.z],canActivateChild:[O.a],runGuardsAndResolvers:"always",component:R.K,children:[{path:"",pathMatch:"full",component:(()=>{class a{constructor(e,i,l,r,c,_,g){this.yamcs=e,this.route=i,this.router=l,this.dialog=c,this.authService=_,this.messageService=g,this.filterForm=new s.cw({filter:new s.NI,view:new s.NI("standard")}),this.detailAlarm$=new Z.X(null),this.selection=new oe.O((u,p)=>`${p.triggerTime}__${p.id.namespace}__${p.id.name}__${p.seqNum}`,!1,[]),this.viewOptions=[{id:"standard",label:"Standard view (ack & unack)"},{id:"unacknowledged",label:"Unacknowledged alarms"},{id:"acknowledged",label:"Acknowledged alarms"},{id:"shelved",label:"Shelved alarms"},{id:"all",label:"All alarms"}],this.view$=new Z.X("standard"),r.setTitle("Alarms"),this.selectionSubscription=this.selection.changed.subscribe(()=>{const u=this.selection.selected;this.detailAlarm$.next(1===u.length?u[0]:null)}),this.dataSource=new de(this.yamcs),this.dataSource.loadAlarms(),this.alarmsSubscription=this.dataSource.alarms$.subscribe(u=>{this.selection.matchNewValues(u);const p=this.detailAlarm$.value;if(p)for(const T of u)if(this.isSameAlarm(T,p)){this.detailAlarm$.next(T);break}}),this.initializeOptions(),this.filterForm.get("filter").valueChanges.pipe((0,le.b)(400)).forEach(u=>{this.filter=u,this.updateURL(),this.dataSource.setFilter(u)}),this.filterForm.get("view").valueChanges.forEach(u=>{this.view$.next(u),this.updateURL(),this.selection.clear()})}initializeOptions(){const e=this.route.snapshot.queryParamMap;if(e.has("filter")&&(this.filter=e.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),e.has("view")){const i=e.get("view");this.view$.next(i),this.filterForm.get("view").setValue(i)}}isSameAlarm(e,i){return e.seqNum===i.seqNum&&e.id.namespace===i.id.namespace&&e.id.name===i.id.name&&e.triggerTime===i.triggerTime}acknowledgeAlarms(e){this.dialog.open(ue,{width:"400px",data:{alarms:e}}).afterClosed().subscribe(()=>this.selection.clear())}shelveAlarms(e){this.dialog.open(Te,{width:"400px",data:{alarms:e}}).afterClosed().subscribe(()=>this.selection.clear())}unshelveAlarms(e){for(const i of e)this.yamcs.yamcsClient.unshelveAlarm(this.yamcs.instance,this.yamcs.processor,i.id.namespace+(i.id.name?"/"+i.id.name:""),i.seqNum).then(()=>this.selection.clear()).catch(r=>this.messageService.showError(r))}clearAlarms(e){for(const i of e)this.yamcs.yamcsClient.clearAlarm(this.yamcs.instance,this.yamcs.processor,i.id.namespace+(i.id.name?"/"+i.id.name:""),i.seqNum,{})}mayControlAlarms(){return this.authService.getUser().hasSystemPrivilege("ControlAlarms")}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filter||null,view:this.view$.value||null},queryParamsHandling:"merge"})}ngOnDestroy(){this.selectionSubscription&&this.selectionSubscription.unsubscribe(),this.alarmsSubscription&&this.alarmsSubscription.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(x.C),t.Y36(h.gz),t.Y36(h.F0),t.Y36(xe.Dx),t.Y36(A.uw),t.Y36(re.e),t.Y36(U.e))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:46,vars:8,consts:[[3,"hasDetailPane"],[1,"ya-data-table"],["width","1"],[1,"icon16",2,"vertical-align","middle"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],[4,"ngIf","ngIfElse"],["noDetail",""],[1,"table-wrapper"],["class","panel-content",4,"ngIf"],["mat-button","","color","primary",3,"disabled","click"],[2,"padding","0 16px"],[3,"alarm","mayControl","acknowledgeAlarm","shelveAlarm","unshelveAlarm","clearAlarm"],[1,"panel-content"],[1,"dl-horizontal"],[3,"formGroup"],[1,"filter-bar"],["formControlName","filter","placeholder","Filter by text search"],["formControlName","view",3,"options"],[3,"dataSource","selection","view","mayControl","acknowledgeAlarm","shelveAlarm","unshelveAlarm","clearAlarm"]],template:function(e,i){if(1&e&&(t.TgZ(0,"app-instance-page"),t.TgZ(1,"app-instance-toolbar",0),t._uU(2," Alarms "),t.TgZ(3,"app-help"),t._uU(4," An alarm can be in these states: "),t.TgZ(5,"table",1),t.TgZ(6,"tr"),t.TgZ(7,"td",2),t.TgZ(8,"mat-icon",3),t._uU(9,"notifications"),t.qZA(),t.qZA(),t.TgZ(10,"td"),t._uU(11," The alarm is unacknowledged and the cause of the alarm still exists. "),t.qZA(),t.qZA(),t.TgZ(12,"tr"),t.TgZ(13,"td"),t.TgZ(14,"mat-icon",3),t._uU(15,"notifications_none"),t.qZA(),t.qZA(),t.TgZ(16,"td"),t._uU(17," The alarm is unacknowledged and the cause that generated the alarm no longer exists. "),t.qZA(),t.qZA(),t.TgZ(18,"tr"),t.TgZ(19,"td"),t.TgZ(20,"mat-icon",3),t._uU(21,"check_circle"),t.qZA(),t.qZA(),t.TgZ(22,"td"),t._uU(23," The alarm is acknowledged and the cause of the alarm still exists. "),t.qZA(),t.qZA(),t.TgZ(24,"tr"),t.TgZ(25,"td"),t.TgZ(26,"mat-icon",3),t._uU(27,"check_circle_outline"),t.qZA(),t.qZA(),t.TgZ(28,"td"),t._uU(29," The alarm is acknowledged and the cause that generated the alarm no longer exists. "),t.qZA(),t.qZA(),t.TgZ(30,"tr"),t.TgZ(31,"td"),t.TgZ(32,"mat-icon",3),t._uU(33,"timer"),t.qZA(),t.qZA(),t.TgZ(34,"td"),t._uU(35," The alarm was shelved. "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t._uU(36," \xa0\xa0\xa0 "),t.YNc(37,Ra,4,1,"button",4),t.YNc(38,Ga,4,1,"button",4),t.qZA(),t.TgZ(39,"app-detail-pane"),t.YNc(40,Ka,5,2,"ng-container",5),t.ALo(41,"async"),t.YNc(42,za,2,0,"ng-template",null,6,t.W1O),t.qZA(),t.TgZ(44,"div",7),t.YNc(45,Wa,27,17,"div",8),t.qZA(),t.qZA()),2&e){const l=t.MAs(43);t.xp6(1),t.Q6J("hasDetailPane",!0),t.xp6(36),t.Q6J("ngIf",i.mayControlAlarms()),t.xp6(1),t.Q6J("ngIf",i.mayControlAlarms()),t.xp6(2),t.Q6J("ngIf",t.lcZ(41,6,i.detailAlarm$))("ngIfElse",l),t.xp6(5),t.Q6J("ngIf",i.dataSource)}},directives:[S.a,I.k,ve.W,y.Hw,f.O5,Ze.lW,ye.Z,be.j,Re,k,s._Y,s.JL,s.sg,Ge.a,s.JJ,s.u,b.P,ja],pipes:[f.Ov],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}mat-row[_ngcontent-%COMP%]{cursor:pointer}mat-row[_ngcontent-%COMP%]:hover{background:#fafafa}"],changeDetection:0}),a})()},{path:"history",component:F},{path:"log",component:B}]}];let tn=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[h.Bz.forChild(Xa)],h.Bz]}),a})(),en=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[E.m,tn]]}),a})()}}]);